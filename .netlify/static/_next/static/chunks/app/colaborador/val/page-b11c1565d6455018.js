(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6117],{15719:function(e,a,r){Promise.resolve().then(r.bind(r,28174))},28174:function(e,a,r){"use strict";r.r(a),r.d(a,{default:function(){return h}});var t=r(57437),s=r(2265),o=r(5526),i=r(26892),l=r(57586),n=r(96215),c=r(58896),d=r(70525),m=r(82023),u=r(76980),p=r(53315),x=r(15001),y=r(44743),v=r(93448);function h(){let[e,a]=(0,s.useState)(""),[r,h]=(0,s.useState)(""),[f,g]=(0,s.useState)(""),[b,j]=(0,s.useState)([]),[N,w]=(0,s.useState)(!1),[C,k]=(0,s.useState)(!1),[E,S]=(0,s.useState)(-1),[I,D]=(0,s.useState)(!1),[_,A]=(0,s.useState)({x:0,y:0}),O=(0,s.useRef)(null);(0,s.useEffect)(()=>{M()},[]),(0,s.useEffect)(()=>{if(f.startsWith("/")&&!f.includes(" ")){k(!0);let e=Z.findIndex(e=>e.prefix.startsWith(f));S(e>=0?e:-1)}else k(!1)},[f]),(0,s.useEffect)(()=>{let e=e=>{A({x:e.clientX,y:e.clientY})};return window.addEventListener("mousemove",e),()=>window.removeEventListener("mousemove",e)},[]);let M=async()=>{try{var e;let{data:{user:r}}=await o.supabase.auth.getUser();if(!r)return;let{data:t}=await o.supabase.from("user_profiles").select("full_name").eq("user_id",r.id).single(),{data:s}=await o.supabase.from("employees").select("area_of_expertise").eq("user_id",r.id).single(),i=(null==s?void 0:s.area_of_expertise)||"Marketing";a((null==t?void 0:null===(e=t.full_name)||void 0===e?void 0:e.split(" ")[0])||"Colaborador"),h(i)}catch(e){console.error("Erro ao carregar usu\xe1rio:",e),a("Colaborador"),h("Marketing")}},Z=[{icon:(0,t.jsx)(n.Z,{className:"w-4 h-4"}),label:"Analisar Performance",description:"An\xe1lise detalhada do seu desempenho",prefix:"/performance"},{icon:(0,t.jsx)(c.Z,{className:"w-4 h-4"}),label:"Minhas Metas",description:"Ver progresso e criar novas metas",prefix:"/metas"},{icon:(0,t.jsx)(d.Z,{className:"w-4 h-4"}),label:"Sugest\xf5es de Melhoria",description:"Dicas personalizadas para voc\xea",prefix:"/sugestoes"},{icon:(0,t.jsx)(m.Z,{className:"w-4 h-4"}),label:"Inspira\xe7\xe3o",description:"Ideias criativas para seus projetos",prefix:"/inspiracao"}],R={Comercial:["Como est\xe3o meus leads este m\xeas?","Me ajude a vencer uma obje\xe7\xe3o","Qual o melhor hor\xe1rio para prospectar?","Sugest\xf5es de upsell para meus clientes"],"Tr\xe1fego Pago":["Como melhorar meu ROAS?","Sugest\xf5es de ajustes nas campanhas","An\xe1lise de p\xfablicos potenciais","Tend\xeancias de ads para este m\xeas"],"Designer Gr\xe1fico":["Tend\xeancias de design atual","Feedback sobre meu \xfaltimo trabalho","Sugest\xf5es de paletas de cores","Inspira\xe7\xe3o para novo projeto"],"Web Designer":["Melhores pr\xe1ticas de UX","Tend\xeancias de UI 2024","Como melhorar convers\xe3o","Inspira\xe7\xe3o para landing pages"],"Head de Marketing":["An\xe1lise de campanhas atuais","ROI por canal de marketing","An\xe1lise de concorrentes","Estrat\xe9gias para Q4"],RH:["An\xe1lise de engajamento da equipe","Sugest\xf5es de interven\xe7\xf5es","Previs\xe3o de churn de colaboradores","Estrat\xe9gias de reten\xe7\xe3o"],Financeiro:["An\xe1lise de receita mensal","Clientes em atraso","Previs\xe3o de faturamento","Oportunidades de redu\xe7\xe3o de custos"],default:["Como est\xe1 meu desempenho?","O que preciso melhorar?","Sugest\xf5es para minhas metas","Como posso ser mais produtivo?"]},T=R[r]||R.default,B=e=>{g(Z[e].prefix+" "),k(!1)},P=async()=>{if(!f.trim())return;let e={id:Date.now().toString(),role:"user",content:f,timestamp:new Date};j(a=>[...a,e]),g(""),w(!0);try{var a,t,s,o;let i=[...b,e].slice(-10).map(e=>({role:e.role,content:e.content})),l=await fetch("/api/ai/val",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e.content,context:{userArea:r},history:i})}),n=await l.json().catch(()=>null);if(!l.ok)throw Error((null==n?void 0:n.error)||"Erro ao conversar com a Val");let c=String((null==n?void 0:null===(a=n.response)||void 0===a?void 0:a.message)||(null==n?void 0:n.message)||(null==n?void 0:null===(t=n.data)||void 0===t?void 0:t.message)||"").trim(),d=(o=(null==n?void 0:null===(s=n.response)||void 0===s?void 0:s.sources)||(null==n?void 0:n.sources))?Array.isArray(o)?o.map(e=>String(e)).filter(Boolean):[String(o)].filter(Boolean):[],m=(c||"N\xe3o consegui responder agora. Pode tentar novamente?")+(d.length?"\n\nFontes:\n".concat(d.slice(0,8).map(e=>"- ".concat(e)).join("\n")):""),u={id:(Date.now()+1).toString(),role:"assistant",content:m,timestamp:new Date};j(e=>[...e,u])}catch(a){let e={id:(Date.now()+1).toString(),role:"assistant",content:(null==a?void 0:a.message)||"Erro ao conversar com a Val",timestamp:new Date};j(a=>[...a,e])}finally{w(!1)}},U=e=>{g(e)},V=()=>{let e=O.current;if(!e)return;e.style.height="60px";let a=Math.max(60,Math.min(e.scrollHeight,200));e.style.height="".concat(a,"px")};return(0,t.jsxs)("div",{className:"h-[calc(100vh-73px)] flex flex-col items-center justify-center p-6 relative overflow-hidden",children:[(0,t.jsxs)("div",{className:"absolute inset-0 w-full h-full overflow-hidden pointer-events-none",children:[(0,t.jsx)("div",{className:"absolute top-0 left-1/4 w-96 h-96 rounded-full mix-blend-normal filter blur-[128px] animate-pulse",style:{backgroundColor:"var(--primary-500)",opacity:.1}}),(0,t.jsx)("div",{className:"absolute bottom-0 right-1/4 w-96 h-96 rounded-full mix-blend-normal filter blur-[128px] animate-pulse",style:{backgroundColor:"var(--primary-500)",opacity:.1,animationDelay:"700ms"}}),(0,t.jsx)("div",{className:"absolute top-1/4 right-1/3 w-64 h-64 rounded-full mix-blend-normal filter blur-[96px] animate-pulse",style:{backgroundColor:"var(--primary-400)",opacity:.08,animationDelay:"1000ms"}})]}),(0,t.jsx)("div",{className:"w-full max-w-3xl mx-auto relative z-10",children:(0,t.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"space-y-8",children:[0===b.length&&(0,t.jsx)("div",{className:"text-center space-y-3",children:(0,t.jsxs)(i.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},children:[(0,t.jsx)("div",{className:"flex items-center justify-center gap-3 mb-4",children:(0,t.jsx)("div",{className:"p-4 rounded-2xl",style:{backgroundColor:"var(--primary-50)"},children:(0,t.jsx)(m.Z,{className:"w-8 h-8",style:{color:"var(--primary-500)"}})})}),(0,t.jsxs)("h1",{className:"text-3xl font-semibold",style:{color:"var(--text-primary)"},children:["Ol\xe1, ",e,"! Seja bem-vindo \uD83D\uDC4B"]}),(0,t.jsx)("h2",{className:"text-xl font-medium mt-2",style:{color:"var(--primary-600)"},children:"Eu sou a Val!"}),(0,t.jsx)("p",{style:{color:"var(--text-secondary)"},children:"Como posso te ajudar hoje?"})]})}),b.length>0&&(0,t.jsxs)("div",{className:"space-y-4 max-h-[50vh] overflow-y-auto px-2",children:[b.map(e=>(0,t.jsx)(i.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:(0,v.cn)("flex","user"===e.role?"justify-end":"justify-start"),children:(0,t.jsxs)("div",{className:(0,v.cn)("max-w-[80%] px-4 py-3 rounded-2xl","user"===e.role?"text-white":"border-l-4"),style:"user"===e.role?{backgroundImage:"var(--gradient-primary)"}:{backgroundColor:"var(--bg-primary)",borderColor:"var(--primary-500)",color:"var(--text-primary)"},children:["assistant"===e.role&&(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)(m.Z,{className:"w-4 h-4",style:{color:"var(--primary-500)"}}),(0,t.jsx)("span",{className:"text-xs font-semibold",style:{color:"var(--primary-700)"},children:"Val"})]}),(0,t.jsx)("p",{className:"text-sm",children:e.content}),(0,t.jsx)("span",{className:(0,v.cn)("text-xs mt-1 block","user"===e.role?"text-white/70":""),style:"assistant"===e.role?{color:"var(--text-tertiary)"}:{},children:e.timestamp.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})})]})},e.id)),N&&(0,t.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},className:"flex justify-start",children:(0,t.jsx)("div",{className:"px-4 py-3 rounded-2xl border-l-4",style:{backgroundColor:"var(--bg-primary)",borderColor:"var(--primary-500)"},children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(m.Z,{className:"w-4 h-4 animate-pulse",style:{color:"var(--primary-500)"}}),(0,t.jsx)("span",{className:"text-sm",style:{color:"var(--text-secondary)"},children:"Val est\xe1 digitando..."})]})})})]}),(0,t.jsxs)(i.E.div,{initial:{scale:.98},animate:{scale:1},className:"relative backdrop-blur-xl rounded-2xl border shadow-2xl",style:{backgroundColor:"var(--bg-primary)",borderColor:"var(--border-light)"},children:[(0,t.jsx)(l.M,{children:C&&(0,t.jsx)(i.E.div,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},exit:{opacity:0,y:5},className:"absolute left-0 right-0 bottom-full mb-2 rounded-xl border shadow-lg overflow-hidden",style:{backgroundColor:"var(--bg-primary)",borderColor:"var(--border-medium)"},children:Z.map((e,a)=>(0,t.jsxs)(i.E.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.03*a},className:(0,v.cn)("flex items-center gap-3 px-4 py-3 cursor-pointer transition-colors",""),style:{backgroundColor:E===a?"var(--primary-50)":"transparent",color:E===a?"var(--primary-700)":"var(--text-secondary)"},onClick:()=>B(a),children:[(0,t.jsx)("div",{className:"w-8 h-8 flex items-center justify-center rounded-lg",style:{backgroundColor:"var(--primary-100)"},children:e.icon}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"font-medium text-sm",children:e.label}),(0,t.jsx)("div",{className:"text-xs",style:{color:"var(--text-tertiary)"},children:e.description})]}),(0,t.jsx)("div",{className:"text-xs font-mono px-2 py-1 rounded",style:{backgroundColor:"var(--bg-secondary)",color:"var(--text-tertiary)"},children:e.prefix})]},e.prefix))})}),(0,t.jsx)("div",{className:"p-4",children:(0,t.jsx)("textarea",{ref:O,value:f,onChange:e=>{g(e.target.value),V()},onKeyDown:e=>{C?"ArrowDown"===e.key?(e.preventDefault(),S(e=>e<Z.length-1?e+1:0)):"ArrowUp"===e.key?(e.preventDefault(),S(e=>e>0?e-1:Z.length-1)):"Tab"===e.key||"Enter"===e.key?(e.preventDefault(),E>=0&&B(E)):"Escape"===e.key&&(e.preventDefault(),k(!1)):"Enter"===e.key&&!e.shiftKey&&(e.preventDefault(),f.trim()&&P())},onFocus:()=>D(!0),onBlur:()=>D(!1),placeholder:"Pergunte algo para a Val...",className:"w-full px-4 py-3 resize-none bg-transparent border-none focus:outline-none text-sm",style:{color:"var(--text-primary)",minHeight:"60px",maxHeight:"200px"}})}),(0,t.jsxs)("div",{className:"px-4 pb-4 pt-2 border-t flex items-center justify-between",style:{borderColor:"var(--border-light)"},children:[(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{className:"p-2 rounded-lg hover:scale-110 transition-all",style:{backgroundColor:"var(--bg-secondary)"},children:(0,t.jsx)(u.Z,{className:"w-4 h-4",style:{color:"var(--text-secondary)"}})}),(0,t.jsx)("button",{onClick:()=>k(!C),className:"p-2 rounded-lg hover:scale-110 transition-all",style:{backgroundColor:C?"var(--primary-50)":"var(--bg-secondary)",color:C?"var(--primary-500)":"var(--text-secondary)"},children:(0,t.jsx)(p.Z,{className:"w-4 h-4"})})]}),(0,t.jsxs)("button",{onClick:P,disabled:!f.trim()||N,className:(0,v.cn)("px-4 py-2 rounded-lg flex items-center gap-2 text-sm font-medium transition-all",f.trim()?"hover:scale-105":"opacity-50 cursor-not-allowed"),style:{backgroundColor:f.trim()?"var(--primary-500)":"var(--bg-tertiary)",color:f.trim()?"white":"var(--text-disabled)"},children:[N?(0,t.jsx)(x.Z,{className:"w-4 h-4 animate-spin"}):(0,t.jsx)(y.Z,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"Enviar"})]})]})]}),0===b.length&&(0,t.jsx)("div",{className:"flex flex-wrap justify-center gap-3",children:T.map((e,a)=>(0,t.jsx)(i.E.button,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3+.1*a},onClick:()=>U(e),className:"px-4 py-2 rounded-xl text-sm font-medium transition-all hover:scale-105 border",style:{backgroundColor:"var(--bg-primary)",borderColor:"var(--border-light)",color:"var(--text-secondary)"},children:e},a))})]})}),I&&(0,t.jsx)(i.E.div,{className:"fixed w-[50rem] h-[50rem] rounded-full pointer-events-none z-0 opacity-[0.02] blur-[96px]",animate:{x:_.x-400,y:_.y-400},transition:{type:"spring",damping:25,stiffness:150,mass:.5},style:{background:"linear-gradient(to right, var(--primary-500), var(--primary-500))"}})]})}},5526:function(e,a,r){"use strict";r.r(a),r.d(a,{supabase:function(){return i}});var t=r(62724);let s="https://ikjgsqtykkhqimypacro.supabase.co",o="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlramdzcXR5a2tocWlteXBhY3JvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMyMTE4OTksImV4cCI6MjA3ODc4Nzg5OX0.vgVCpFIt-5ajFhcXg65dqrEw915pqW8fGZ8xgJxrnxI";s&&o||console.error("‚ùå ERRO CR\xcdTICO: Vari\xe1veis de ambiente NEXT_PUBLIC_SUPABASE_URL ou NEXT_PUBLIC_SUPABASE_ANON_KEY n\xe3o encontradas!");let i=(0,t.eI)(s||"https://setup-missing.supabase.co",o||"setup-missing",{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}})},93448:function(e,a,r){"use strict";r.d(a,{cn:function(){return o},x:function(){return i}});var t=r(61994),s=r(53335);function o(){for(var e=arguments.length,a=Array(e),r=0;r<e;r++)a[r]=arguments[r];return(0,s.m6)((0,t.W)(a))}function i(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}}},function(e){e.O(0,[2882,6137,4609,2724,9903,2971,2117,1744],function(){return e(e.s=15719)}),_N_E=e.O()}]);