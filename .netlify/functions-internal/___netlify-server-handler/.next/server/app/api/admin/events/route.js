"use strict";(()=>{var e={};e.id=4030,e.ids=[4030],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},52837:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>g,patchFetch:()=>h,requestAsyncStorage:()=>m,routeModule:()=>l,serverHooks:()=>v,staticGenerationAsyncStorage:()=>x});var n={};r.r(n),r.d(n,{GET:()=>c,dynamic:()=>p});var a=r(49303),s=r(88716),o=r(60670),i=r(87070),u=r(20344),d=r(71615);let p="force-dynamic";async function c(e){let t=(0,d.cookies)(),r=(0,u.createRouteHandlerClient)({cookies:()=>t}),{data:n}=await r.auth.getUser();if(!n.user?.id)return i.NextResponse.json({error:"N\xe3o autorizado"},{status:401});let{data:a,error:s}=await r.rpc("is_admin");if(s||!a)return i.NextResponse.json({error:"Acesso negado (admin)"},{status:403});try{let{searchParams:t}=new URL(e.url),n=t.get("status")||void 0,a=t.get("event_type")||void 0,s=Math.max(1,Math.min(500,Number(t.get("limit")||100))),o=r.from("event_log").select("*").order("created_at",{ascending:!1}).limit(s);n&&(o=o.eq("status",n)),a&&(o=o.eq("event_type",a));let{data:u,error:d}=await o;if(d)throw d;return i.NextResponse.json({events:u||[]})}catch(e){return i.NextResponse.json({error:e?.message||"Erro interno"},{status:500})}}let l=new a.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/admin/events/route",pathname:"/api/admin/events",filename:"route",bundlePath:"app/api/admin/events/route"},resolvedPagePath:"C:\\Users\\User\\Downloads\\valle-360-main\\valle-360-main\\src\\app\\api\\admin\\events\\route.ts",nextConfigOutput:"standalone",userland:n}),{requestAsyncStorage:m,staticGenerationAsyncStorage:x,serverHooks:v}=l,g="/api/admin/events/route";function h(){return(0,o.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:x})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[89276,55972,54128,20958],()=>r(52837));module.exports=n})();