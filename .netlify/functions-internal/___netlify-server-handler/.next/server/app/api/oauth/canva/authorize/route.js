"use strict";(()=>{var e={};e.id=1105,e.ids=[1105],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},95091:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>v,patchFetch:()=>P,requestAsyncStorage:()=>m,routeModule:()=>h,serverHooks:()=>x,staticGenerationAsyncStorage:()=>g});var a={};r.r(a),r.d(a,{GET:()=>l});var s=r(49303),n=r(88716),o=r(60670),i=r(87070),c=r(20344),u=r(71615);let p=process.env.CANVA_CLIENT_ID||"",d=process.env.CANVA_REDIRECT_URI||`${process.env.NEXT_PUBLIC_APP_URL}/api/oauth/canva/callback`;async function l(e){try{let t=(0,c.createRouteHandlerClient)({cookies:u.cookies}),{data:{user:r}}=await t.auth.getUser();if(!r)return i.NextResponse.redirect(new URL("/login",e.url));let a=e.nextUrl.searchParams,s=a.get("clientId"),n=a.get("redirect")||"/admin/integracoes",o={userId:r.id,clientId:s,redirect:n,timestamp:Date.now()},l=Buffer.from(JSON.stringify(o)).toString("base64url"),h=new URL("https://www.canva.com/api/oauth/authorize");return h.searchParams.set("client_id",p),h.searchParams.set("redirect_uri",d),h.searchParams.set("response_type","code"),h.searchParams.set("scope","design:content:read design:content:write design:meta:read folder:read asset:read asset:write"),h.searchParams.set("state",l),i.NextResponse.redirect(h.toString())}catch(t){return console.error("Canva OAuth error:",t),i.NextResponse.redirect(new URL("/error?message=oauth_error",e.url))}}let h=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/oauth/canva/authorize/route",pathname:"/api/oauth/canva/authorize",filename:"route",bundlePath:"app/api/oauth/canva/authorize/route"},resolvedPagePath:"C:\\Users\\User\\Downloads\\valle-360-main\\valle-360-main\\src\\app\\api\\oauth\\canva\\authorize\\route.ts",nextConfigOutput:"standalone",userland:a}),{requestAsyncStorage:m,staticGenerationAsyncStorage:g,serverHooks:x}=h,v="/api/oauth/canva/authorize/route";function P(){return(0,o.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:g})}}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[89276,55972,54128,20958],()=>r(95091));module.exports=a})();