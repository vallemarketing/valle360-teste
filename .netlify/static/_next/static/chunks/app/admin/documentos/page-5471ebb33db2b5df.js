(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[666],{44816:function(e,a,r){Promise.resolve().then(r.bind(r,85581))},85581:function(e,a,r){"use strict";r.r(a),r.d(a,{default:function(){return f}});var t=r(57437),l=r(2265),s=r(79820),n=r(12381),o=r(40279),i=r(69174),c=r(5526),d=r(73247),u=r(17689),m=r(48736),v=r(88906),x=r(30401),p=r(92735),b=r(14438);function f(){let[e,a]=(0,l.useState)([]),[r,f]=(0,l.useState)(""),[h,g]=(0,l.useState)(""),[y,j]=(0,l.useState)("contract"),[N,w]=(0,l.useState)(!1),[_,C]=(0,l.useState)([]),[I,k]=(0,l.useState)({contract_number:"",plan_name:"",monthly_value:"",start_date:"",renewal_date:"",services:[]});(0,l.useEffect)(()=>{S()},[]),(0,l.useEffect)(()=>{r&&E(r)},[r]);let S=async()=>{try{let{data:e,error:r}=await c.supabase.from("user_profiles").select("id, full_name, email").eq("user_type","client").order("full_name");if(r)throw r;a(e||[])}catch(e){console.error("Error loading clients:",e)}},E=async e=>{try{let{data:a,error:r}=await c.supabase.from("client_contracts").select("*").eq("client_id",e).order("created_at",{ascending:!1}),{data:t,error:l}=await c.supabase.from("client_rules_documents").select("*").eq("client_id",e).order("created_at",{ascending:!1});if(r)throw r;if(l)throw l;let s=[...(a||[]).map(e=>({...e,type:"contract"})),...(t||[]).map(e=>({...e,type:"rules"}))];C(s)}catch(e){console.error("Error loading documents:",e)}},R=async e=>{var a;let t=null===(a=e.target.files)||void 0===a?void 0:a[0];if(t&&r){if("application/pdf"!==t.type){b.Am.error("Apenas arquivos PDF s\xe3o permitidos");return}if(t.size>10485760){b.Am.error("O arquivo deve ter no m\xe1ximo 10MB");return}w(!0);try{let e="contract"===y?"contracts":"client-rules",a="".concat(r,"/").concat(Date.now(),"_").concat(t.name),{error:l}=await c.supabase.storage.from(e).upload(a,t);if(l)throw l;let{data:{publicUrl:s}}=c.supabase.storage.from(e).getPublicUrl(a),{data:{user:n}}=await c.supabase.auth.getUser();if("contract"===y){let{error:e}=await c.supabase.from("client_contracts").insert({client_id:r,contract_number:I.contract_number,plan_name:I.plan_name,monthly_value:parseFloat(I.monthly_value),start_date:I.start_date,renewal_date:I.renewal_date,contract_file_url:s,services_included:I.services,uploaded_by:null==n?void 0:n.id,is_current:!0,version:1});if(e)throw e}else{let{error:e}=await c.supabase.from("client_rules_documents").insert({client_id:r,rules_file_url:s,uploaded_by:null==n?void 0:n.id,is_current:!0,version:1});if(e)throw e}b.Am.success("Documento enviado com sucesso!"),E(r),k({contract_number:"",plan_name:"",monthly_value:"",start_date:"",renewal_date:"",services:[]})}catch(e){console.error("Error uploading document:",e),b.Am.error("Erro ao enviar documento")}finally{w(!1)}}},Z=e.filter(e=>e.full_name.toLowerCase().includes(h.toLowerCase())||e.email.toLowerCase().includes(h.toLowerCase())),O=e=>{I.services.includes(e)?k({...I,services:I.services.filter(a=>a!==e)}):k({...I,services:[...I.services,e]})};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-valle-navy-900",children:"Gerenciar Documentos"}),(0,t.jsx)("p",{className:"text-valle-silver-600 mt-2",children:"Upload e gerenciamento de contratos e regras dos clientes"})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-3 gap-6",children:[(0,t.jsxs)(s.Zb,{className:"md:col-span-1",children:[(0,t.jsx)(s.Ol,{children:(0,t.jsxs)(s.ll,{className:"flex items-center gap-2",children:[(0,t.jsx)(d.Z,{className:"w-5 h-5 text-valle-blue-600"}),"Selecionar Cliente"]})}),(0,t.jsxs)(s.aY,{className:"space-y-4",children:[(0,t.jsx)(o.II,{placeholder:"Buscar cliente...",value:h,onChange:e=>g(e.target.value),className:"mb-4"}),(0,t.jsx)("div",{className:"space-y-2 max-h-[600px] overflow-y-auto",children:Z.map(e=>(0,t.jsxs)("button",{onClick:()=>f(e.id),className:"w-full p-3 rounded-lg text-left transition-all ".concat(r===e.id?"bg-valle-blue-600 text-white":"bg-valle-silver-100 hover:bg-valle-silver-200 text-valle-navy-800"),children:[(0,t.jsx)("p",{className:"font-medium",children:e.full_name}),(0,t.jsx)("p",{className:"text-sm opacity-80",children:e.email})]},e.id))})]})]}),(0,t.jsxs)(s.Zb,{className:"md:col-span-2",children:[(0,t.jsx)(s.Ol,{children:(0,t.jsxs)(s.ll,{className:"flex items-center gap-2",children:[(0,t.jsx)(u.Z,{className:"w-5 h-5 text-valle-blue-600"}),"Upload de Documento"]})}),(0,t.jsx)(s.aY,{children:r?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsxs)("button",{onClick:()=>j("contract"),className:"flex-1 p-4 rounded-lg border-2 transition-all ".concat("contract"===y?"border-valle-blue-600 bg-valle-blue-50":"border-valle-silver-200 hover:border-valle-blue-300"),children:[(0,t.jsx)(m.Z,{className:"w-8 h-8 mx-auto mb-2 ".concat("contract"===y?"text-valle-blue-600":"text-valle-silver-500")}),(0,t.jsx)("p",{className:"font-semibold text-center",children:"Contrato"})]}),(0,t.jsxs)("button",{onClick:()=>j("rules"),className:"flex-1 p-4 rounded-lg border-2 transition-all ".concat("rules"===y?"border-valle-blue-600 bg-valle-blue-50":"border-valle-silver-200 hover:border-valle-blue-300"),children:[(0,t.jsx)(v.Z,{className:"w-8 h-8 mx-auto mb-2 ".concat("rules"===y?"text-valle-blue-600":"text-valle-silver-500")}),(0,t.jsx)("p",{className:"font-semibold text-center",children:"Regras"})]})]}),"contract"===y&&(0,t.jsxs)("div",{className:"space-y-4 p-4 bg-valle-silver-50 rounded-lg",children:[(0,t.jsx)("h4",{className:"font-semibold text-valle-navy-900",children:"Informa\xe7\xf5es do Contrato"}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium text-valle-navy-700 mb-2 block",children:"N\xfamero do Contrato"}),(0,t.jsx)(o.II,{value:I.contract_number,onChange:e=>k({...I,contract_number:e.target.value}),placeholder:"CONT-2025-001"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium text-valle-navy-700 mb-2 block",children:"Nome do Plano"}),(0,t.jsx)(o.II,{value:I.plan_name,onChange:e=>k({...I,plan_name:e.target.value}),placeholder:"Plano Enterprise"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium text-valle-navy-700 mb-2 block",children:"Valor Mensal (R$)"}),(0,t.jsx)(o.II,{type:"number",value:I.monthly_value,onChange:e=>k({...I,monthly_value:e.target.value}),placeholder:"5999.00"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium text-valle-navy-700 mb-2 block",children:"Data de In\xedcio"}),(0,t.jsx)(o.II,{type:"date",value:I.start_date,onChange:e=>k({...I,start_date:e.target.value})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium text-valle-navy-700 mb-2 block",children:"Data de Renova\xe7\xe3o"}),(0,t.jsx)(o.II,{type:"date",value:I.renewal_date,onChange:e=>k({...I,renewal_date:e.target.value})})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium text-valle-navy-700 mb-2 block",children:"Servi\xe7os Inclusos"}),(0,t.jsx)("div",{className:"grid grid-cols-2 gap-2",children:["Gest\xe3o completa de Redes Sociais","Cria\xe7\xe3o de conte\xfado ilimitado","Tr\xe1fego pago (Google + Meta)","An\xe1lise de dados e relat\xf3rios","Suporte priorit\xe1rio 24/7","Consultoria estrat\xe9gica mensal","Desenvolvimento de site","SEO e otimiza\xe7\xe3o"].map(e=>(0,t.jsx)("button",{onClick:()=>O(e),className:"p-2 rounded-lg border-2 text-sm text-left transition-all ".concat(I.services.includes(e)?"border-green-600 bg-green-50":"border-valle-silver-200 hover:border-valle-silver-300"),children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[I.services.includes(e)&&(0,t.jsx)(x.Z,{className:"w-4 h-4 text-green-600"}),(0,t.jsx)("span",{children:e})]})},e))})]})]}),(0,t.jsxs)("div",{className:"border-2 border-dashed border-valle-silver-300 rounded-lg p-8 text-center",children:[(0,t.jsx)("input",{type:"file",accept:"application/pdf",onChange:R,disabled:N,id:"file-upload",className:"hidden"}),(0,t.jsxs)("label",{htmlFor:"file-upload",className:"cursor-pointer",children:[(0,t.jsx)(u.Z,{className:"w-16 h-16 text-valle-blue-600 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-lg font-semibold text-valle-navy-900 mb-2",children:N?"Enviando...":"Clique para fazer upload"}),(0,t.jsx)("p",{className:"text-sm text-valle-silver-600",children:"Apenas arquivos PDF (m\xe1ximo 10MB)"})]})]}),_.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-semibold text-valle-navy-900 mb-3",children:"Documentos Enviados"}),(0,t.jsx)("div",{className:"space-y-2",children:_.filter(e=>e.type===y).map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-valle-silver-100 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(m.Z,{className:"w-5 h-5 text-valle-blue-600"}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"font-medium text-valle-navy-900",children:["contract"===e.type?"Contrato":"Regras"," v",e.version]}),(0,t.jsx)("p",{className:"text-xs text-valle-silver-600",children:new Date(e.created_at).toLocaleString("pt-BR")})]}),e.is_current&&(0,t.jsx)(i.C,{className:"bg-green-600 text-white",children:"Atual"})]}),(0,t.jsx)(n.z,{variant:"outline",size:"sm",onClick:()=>window.open(e.file_url,"_blank"),children:(0,t.jsx)(p.Z,{className:"w-4 h-4"})})]},e.id))})]})]}):(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)(m.Z,{className:"w-16 h-16 text-valle-silver-400 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-valle-silver-600",children:"Selecione um cliente para fazer upload de documentos"})]})})]})]})]})}},69174:function(e,a,r){"use strict";r.d(a,{C:function(){return o}});var t=r(57437);r(2265);var l=r(90535),s=r(93448);let n=(0,l.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-valle-blue-600 text-white",secondary:"border-transparent bg-valle-silver-300 text-valle-navy-800",outline:"text-valle-navy-700 border-valle-silver-400",success:"border-transparent bg-green-600 text-white",warning:"border-transparent bg-yellow-600 text-white",danger:"border-transparent bg-red-600 text-white"}},defaultVariants:{variant:"default"}});function o(e){let{className:a,variant:r,...l}=e;return(0,t.jsx)("div",{className:(0,s.cn)(n({variant:r}),a),...l})}},12381:function(e,a,r){"use strict";r.d(a,{z:function(){return i}});var t=r(57437),l=r(2265),s=r(90535),n=r(93448);let o=(0,s.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-lg text-sm font-medium transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-valle-blue-600 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-gradient-to-r from-valle-blue-600 to-valle-blue-700 text-white hover:from-valle-blue-700 hover:to-valle-blue-800 shadow-lg",secondary:"bg-valle-silver-200 text-valle-navy-800 hover:bg-valle-silver-300",outline:"border-2 border-valle-blue-600 text-valle-blue-600 hover:bg-valle-blue-50",ghost:"hover:bg-valle-blue-50 hover:text-valle-blue-600",danger:"bg-red-600 text-white hover:bg-red-700"},size:{default:"h-10 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-12 rounded-lg px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),i=l.forwardRef((e,a)=>{let{className:r,variant:l,size:s,...i}=e;return(0,t.jsx)("button",{className:(0,n.cn)(o({variant:l,size:s,className:r})),ref:a,...i})});i.displayName="Button"},79820:function(e,a,r){"use strict";r.d(a,{Ol:function(){return o},SZ:function(){return c},Zb:function(){return n},aY:function(){return d},ll:function(){return i}});var t=r(57437),l=r(2265),s=r(93448);let n=l.forwardRef((e,a)=>{let{className:r,...l}=e;return(0,t.jsx)("div",{ref:a,className:(0,s.cn)("rounded-xl border-2 border-valle-silver-200 bg-white shadow-md",r),...l})});n.displayName="Card";let o=l.forwardRef((e,a)=>{let{className:r,...l}=e;return(0,t.jsx)("div",{ref:a,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",r),...l})});o.displayName="CardHeader";let i=l.forwardRef((e,a)=>{let{className:r,...l}=e;return(0,t.jsx)("h3",{ref:a,className:(0,s.cn)("font-semibold leading-none tracking-tight text-lg",r),...l})});i.displayName="CardTitle";let c=l.forwardRef((e,a)=>{let{className:r,...l}=e;return(0,t.jsx)("p",{ref:a,className:(0,s.cn)("text-sm text-foreground/70",r),...l})});c.displayName="CardDescription";let d=l.forwardRef((e,a)=>{let{className:r,...l}=e;return(0,t.jsx)("div",{ref:a,className:(0,s.cn)("p-6 pt-0",r),...l})});d.displayName="CardContent",l.forwardRef((e,a)=>{let{className:r,...l}=e;return(0,t.jsx)("div",{ref:a,className:(0,s.cn)("flex items-center p-6 pt-0",r),...l})}).displayName="CardFooter"},40279:function(e,a,r){"use strict";r.d(a,{II:function(){return x}});var t=r(57437),l=r(2265),s=r(57586),n=r(26892),o=r(51817),i=r(32489),c=r(87769),d=r(42208),u=r(49322),m=r(41671);let v={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2.5 text-sm",lg:"px-4 py-3 text-base"},x=(0,l.forwardRef)((e,a)=>{let{label:r,error:x,success:p,hint:b,icon:f,iconPosition:h="left",size:g="md",variant:y="default",loading:j=!1,clearable:N=!1,onClear:w,className:_="",type:C="text",disabled:I,value:k,...S}=e,[E,R]=(0,l.useState)(!1),[Z,O]=(0,l.useState)(!1),z="password"===C,A=z&&E?"text":C,B="\n    w-full rounded-xl border transition-all duration-200\n    ".concat(v[g],"\n    ").concat(f&&"left"===h?"pl-10":"","\n    ").concat(f&&"right"===h?"pr-10":"","\n    ").concat(z||N||j?"pr-10":"","\n    ").concat(I?"opacity-50 cursor-not-allowed":"","\n  "),D=x?"border-red-500 focus:border-red-500 focus:ring-red-500/20":p?"border-green-500 focus:border-green-500 focus:ring-green-500/20":"";return(0,t.jsxs)("div",{className:"space-y-1 ".concat(_),children:[r&&(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:"var(--text-secondary)"},children:r}),(0,t.jsxs)("div",{className:"relative",children:[f&&"left"===h&&(0,t.jsx)("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",style:{color:Z?"var(--primary-500)":"var(--text-tertiary)"},children:f}),(0,t.jsx)("input",{ref:a,type:A,value:k,disabled:I||j,onFocus:e=>{var a;O(!0),null===(a=S.onFocus)||void 0===a||a.call(S,e)},onBlur:e=>{var a;O(!1),null===(a=S.onBlur)||void 0===a||a.call(S,e)},className:"".concat(B," ").concat({default:"\n      bg-white dark:bg-gray-900\n      border-gray-200 dark:border-gray-700\n      focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20\n    ",filled:"\n      bg-gray-100 dark:bg-gray-800\n      border-transparent\n      focus:bg-white dark:focus:bg-gray-900\n      focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20\n    ",outlined:"\n      bg-transparent\n      border-gray-300 dark:border-gray-600\n      focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20\n    "}[y]," ").concat(D),style:{color:"var(--text-primary)",backgroundColor:"filled"===y?"var(--bg-secondary)":"var(--bg-primary)"},...S}),(0,t.jsxs)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 flex items-center gap-1",children:[j&&(0,t.jsx)(o.Z,{className:"w-4 h-4 animate-spin",style:{color:"var(--text-tertiary)"}}),N&&void 0!==k&&""!==k&&!j&&(0,t.jsx)("button",{type:"button",onClick:w,className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-800",children:(0,t.jsx)(i.Z,{className:"w-4 h-4",style:{color:"var(--text-tertiary)"}})}),z&&!j&&(0,t.jsx)("button",{type:"button",onClick:()=>R(!E),className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-800",children:E?(0,t.jsx)(c.Z,{className:"w-4 h-4",style:{color:"var(--text-tertiary)"}}):(0,t.jsx)(d.Z,{className:"w-4 h-4",style:{color:"var(--text-tertiary)"}})}),f&&"right"===h&&!z&&!N&&!j&&(0,t.jsx)("div",{style:{color:Z?"var(--primary-500)":"var(--text-tertiary)"},children:f}),x&&!j&&(0,t.jsx)(u.Z,{className:"w-4 h-4",style:{color:"var(--error-500)"}}),p&&!x&&!j&&(0,t.jsx)(m.Z,{className:"w-4 h-4",style:{color:"var(--success-500)"}})]})]}),(0,t.jsxs)(s.M,{mode:"wait",children:[x&&(0,t.jsx)(n.E.p,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},exit:{opacity:0,y:-5},className:"text-xs",style:{color:"var(--error-500)"},children:x}),p&&!x&&(0,t.jsx)(n.E.p,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},exit:{opacity:0,y:-5},className:"text-xs",style:{color:"var(--success-500)"},children:p}),b&&!x&&!p&&(0,t.jsx)("p",{className:"text-xs",style:{color:"var(--text-tertiary)"},children:b})]})]})});x.displayName="Input",(0,l.forwardRef)((e,a)=>{let{label:r,error:l,hint:s,size:n="md",className:o="",disabled:i,...c}=e;return(0,t.jsxs)("div",{className:"space-y-1 ".concat(o),children:[r&&(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:"var(--text-secondary)"},children:r}),(0,t.jsx)("textarea",{ref:a,disabled:i,className:"\n          w-full rounded-xl border transition-all duration-200 resize-none\n          ".concat({sm:"px-3 py-2 text-sm",md:"px-4 py-3 text-sm",lg:"px-4 py-4 text-base"}[n],"\n          ").concat(l?"border-red-500 focus:border-red-500 focus:ring-red-500/20":"border-gray-200 dark:border-gray-700 focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20","\n          ").concat(i?"opacity-50 cursor-not-allowed":"","\n        "),style:{color:"var(--text-primary)",backgroundColor:"var(--bg-primary)"},...c}),l&&(0,t.jsx)("p",{className:"text-xs",style:{color:"var(--error-500)"},children:l}),s&&!l&&(0,t.jsx)("p",{className:"text-xs",style:{color:"var(--text-tertiary)"},children:s})]})}).displayName="Textarea"},5526:function(e,a,r){"use strict";r.r(a),r.d(a,{supabase:function(){return n}});var t=r(62724);let l="https://ikjgsqtykkhqimypacro.supabase.co",s="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlramdzcXR5a2tocWlteXBhY3JvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMyMTE4OTksImV4cCI6MjA3ODc4Nzg5OX0.vgVCpFIt-5ajFhcXg65dqrEw915pqW8fGZ8xgJxrnxI";l&&s||console.error("‚ùå ERRO CR\xcdTICO: Vari\xe1veis de ambiente NEXT_PUBLIC_SUPABASE_URL ou NEXT_PUBLIC_SUPABASE_ANON_KEY n\xe3o encontradas!");let n=(0,t.eI)(l||"https://setup-missing.supabase.co",s||"setup-missing",{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}})},93448:function(e,a,r){"use strict";r.d(a,{cn:function(){return s},x:function(){return n}});var t=r(61994),l=r(53335);function s(){for(var e=arguments.length,a=Array(e),r=0;r<e;r++)a[r]=arguments[r];return(0,l.m6)((0,t.W)(a))}function n(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}}},function(e){e.O(0,[2882,6137,4609,2724,4438,9397,2971,2117,1744],function(){return e(e.s=44816)}),_N_E=e.O()}]);