"use strict";exports.id=4940,exports.ids=[4940],exports.modules={4940:(e,t,a)=>{a.d(t,{C1:()=>d,E1:()=>c,Fm:()=>g,Jv:()=>n,Uj:()=>s,cZ:()=>m,tl:()=>p});var o=a(1926),i=a(51547);let r=`Voc\xea \xe9 o CTO virtual da Valle 360, uma ag\xeancia de marketing digital.
Seu papel \xe9 otimizar opera\xe7\xf5es, gerenciar capacidade produtiva e recomendar ferramentas e automa\xe7\xf5es.

Suas responsabilidades:
1. Monitorar capacidade produtiva por setor
2. Identificar gargalos e sobrecargas
3. Recomendar ferramentas de IA e automa\xe7\xe3o
4. Analisar quando contratar vs automatizar vs terceirizar
5. Otimizar processos e fluxos de trabalho

Sempre forne\xe7a:
- An\xe1lise baseada em dados de utiliza\xe7\xe3o
- ROI claro para cada recomenda\xe7\xe3o
- Alternativas vi\xe1veis
- Prioriza\xe7\xe3o clara

Seja t\xe9cnico, anal\xedtico e focado em efici\xeancia operacional.`;async function n(e){let{data:t}=await o.O.from("user_profiles").select("id, full_name, role").in("role",["social_media","designer","trafego","video_maker","web_designer","comercial","rh"]),{data:a}=await o.O.from("kanban_tasks").select("assigned_to, estimated_hours, status").neq("status","done"),i=[];for(let o of["social_media","designer","trafego","video_maker","web_designer"]){if(e&&o!==e)continue;let r=t?.filter(e=>e.role===o)||[],n=a?.filter(e=>r.some(t=>t.id===e.assigned_to))||[],s=160*r.length,l=n.reduce((e,t)=>e+(t.estimated_hours||0),0),c=s>0?l/s*100:0,d=r.map(e=>{let t=n.filter(t=>t.assigned_to===e.id),a=t.reduce((e,t)=>e+(t.estimated_hours||0),0),i=a/160*100;return{id:e.id,name:e.full_name||"Colaborador",department:o,availableHours:160,allocatedHours:a,utilizationRate:i,isOverloaded:i>90,currentTasks:t.length}}),m=d.filter(e=>e.isOverloaded).length/(d.length||1)*100;i.push({department:o,totalAvailableHours:s,totalAllocatedHours:l,totalDeliveredHours:0,utilizationRate:c,efficiencyRate:85,bottleneckScore:m,trend:c>80?"increasing":c>60?"stable":"decreasing",collaborators:d})}return i}async function s(e=4){let t=await n(),a=[];for(let o of t){let t="increasing"===o.trend?5:"decreasing"===o.trend?-3:1,i=Math.min(150,o.utilizationRate+t*e),r=null;o.utilizationRate<100&&i>=100&&(r=Math.ceil((100-o.utilizationRate)/(t/7)));let n="";n=i>100?`Capacidade ser\xe1 excedida. Considere contratar ou redistribuir.`:i>85?`Pr\xf3ximo do limite. Monitore de perto e prepare conting\xeancias.`:i<50?`Subutiliza\xe7\xe3o. Considere redistribuir demandas ou prospectar mais.`:`Capacidade saud\xe1vel. Mantenha o ritmo atual.`,a.push({department:o.department,currentUtilization:o.utilizationRate,predictedUtilization:i,daysUntilOverload:r,willExceedCapacity:i>100,recommendation:n,confidenceLevel:75})}return a}async function l(){let e=await n(),t=[];for(let a of e)t.push(...a.collaborators.filter(e=>e.isOverloaded));return t.sort((e,t)=>t.utilizationRate-e.utilizationRate)}async function c(e){let t=o.O.from("tool_recommendations").select("*").eq("status","suggested").order("estimated_roi_percentage",{ascending:!1});e&&(t=t.eq("department",e));let{data:a}=await t;return(a||[]).map(e=>({id:e.id,toolName:e.tool_name,category:e.tool_category,department:e.department,monthlyCost:e.monthly_cost||0,timeSavingsHours:e.estimated_time_savings_hours||0,roiPercentage:e.estimated_roi_percentage||0,paybackMonths:e.payback_months||0,implementationEffort:e.implementation_effort,description:e.description||"",pros:e.pros||[],cons:e.cons||[],priority:e.estimated_roi_percentage>200?"high":e.estimated_roi_percentage>100?"medium":"low"}))}async function d(e){try{let t=(await (0,i.F)({task:"analysis",json:!0,temperature:.7,maxTokens:500,entityType:"cto_automation",entityId:null,messages:[{role:"system",content:r},{role:"user",content:`Analise o potencial de automa\xe7\xe3o deste processo:
"${e}"

Responda em JSON com:
- automationScore (0-100)
- recommendations (lista de 3 sugest\xf5es)
- tools (lista de ferramentas recomendadas)
- estimatedSavings (% de tempo que pode ser economizado)`}]})).json||{};return{automationScore:t.automationScore||50,recommendations:t.recommendations||[],tools:t.tools||[],estimatedSavings:t.estimatedSavings||20}}catch{return{automationScore:50,recommendations:["Avaliar manualmente"],tools:[],estimatedSavings:0}}}async function m(e){let t;let a=(await n(e))[0];if(!a)return null;let o=a.utilizationRate,i=a.collaborators.filter(e=>e.isOverloaded).length;if(o<75&&0===i)return null;let r=(await c(e))[0];if(o>110&&i>=2)t={department:e,positionTitle:`${e.replace("_"," ")} Jr/Pleno`,decisionType:"hire",urgency:"high",expectedCost:9e3,expectedRoiMonths:3,justification:`Utiliza\xe7\xe3o em ${o.toFixed(0)}% com ${i} colaboradores sobrecarregados. Contrata\xe7\xe3o necess\xe1ria para manter qualidade.`,alternativeOptions:r?[`Implementar ${r.toolName} para ganhar ${r.timeSavingsHours}h/m\xeas`]:[]};else if(r&&r.timeSavingsHours>=30)t={department:e,positionTitle:"",decisionType:"automate",urgency:"medium",expectedCost:r.monthlyCost,expectedRoiMonths:r.paybackMonths,justification:`${r.toolName} pode economizar ${r.timeSavingsHours}h/m\xeas com ROI de ${r.roiPercentage}%.`,alternativeOptions:["Contratar freelancer","Redistribuir tarefas"]};else if(1===i){let o=a.collaborators.filter(e=>e.utilizationRate<70);t={department:e,positionTitle:"",decisionType:"redistribute",urgency:"low",expectedCost:0,expectedRoiMonths:0,justification:`Redistribuir tarefas de colaboradores sobrecarregados para ${o.length} com capacidade dispon\xedvel.`,alternativeOptions:["Contratar estagi\xe1rio","Terceirizar demandas pontuais"]}}else t={department:e,positionTitle:`Freelancer ${e}`,decisionType:"outsource",urgency:"medium",expectedCost:5400,expectedRoiMonths:1,justification:`Terceiriza\xe7\xe3o pontual pode aliviar a sobrecarga sem compromisso de longo prazo.`,alternativeOptions:["Contratar CLT","Implementar ferramentas de automa\xe7\xe3o"]};return t}async function u(){let e=[],t=await n(),a=await s(2);for(let a of t)a.utilizationRate>95&&e.push({id:`overload-${a.department}`,type:"capacity_overload",severity:a.utilizationRate>110?"critical":"high",title:`${a.department} em sobrecarga`,description:`Utiliza\xe7\xe3o de ${a.utilizationRate.toFixed(0)}% - acima do limite saud\xe1vel de 85%`,department:a.department,recommendedAction:"Redistribuir tarefas ou considerar contrata\xe7\xe3o",createdAt:new Date().toISOString()});for(let t of a)t.daysUntilOverload&&t.daysUntilOverload<=30&&e.push({id:`forecast-${t.department}`,type:"capacity_forecast",severity:t.daysUntilOverload<=14?"high":"medium",title:`${t.department} vai estourar em ${t.daysUntilOverload} dias`,description:t.recommendation,department:t.department,recommendedAction:"Iniciar processo de contrata\xe7\xe3o ou automa\xe7\xe3o",createdAt:new Date().toISOString()});let o=await l();o.length>=3&&e.push({id:"multiple-overload",type:"team_burnout_risk",severity:"high",title:`${o.length} colaboradores sobrecarregados`,description:`Risco de burnout e queda de qualidade. Nomes: ${o.slice(0,3).map(e=>e.name).join(", ")}`,recommendedAction:"A\xe7\xe3o imediata: redistribuir tarefas e avaliar contrata\xe7\xe3o",createdAt:new Date().toISOString()});let i=(await c()).filter(e=>e.roiPercentage>200&&"high"===e.priority);return i.length>0&&e.push({id:"tools-roi",type:"automation_opportunity",severity:"medium",title:`${i.length} ferramentas com alto ROI dispon\xedveis`,description:`Potencial economia: ${i.reduce((e,t)=>e+t.timeSavingsHours,0)}h/m\xeas`,recommendedAction:`Avaliar: ${i.map(e=>e.toolName).join(", ")}`,createdAt:new Date().toISOString()}),e.sort((e,t)=>{let a={critical:0,high:1,medium:2,low:3};return a[e.severity]-a[t.severity]})}async function p(){let e=await n(),t=await s(4),a=await c(),o=await u(),i=e.reduce((e,t)=>e+t.totalAvailableHours,0),r=e.reduce((e,t)=>e+t.totalAllocatedHours,0),l=e.reduce((e,t)=>e+t.efficiencyRate,0)/(e.length||1),d=e.filter(e=>e.bottleneckScore>30).length,p=a.reduce((e,t)=>e+t.timeSavingsHours,0),g=[];for(let t of e){let e=await m(t.department);e&&g.push(e)}return{overview:{totalCapacity:i,totalUtilization:i>0?r/i*100:0,averageEfficiency:l,bottlenecks:d,toolsInUse:5,potentialSavings:p},departmentMetrics:e,capacityForecasts:t,toolRecommendations:a,hiringDecisions:g,processOptimizations:[{process:"Cria\xe7\xe3o de relat\xf3rios de performance",department:"trafego",currentTimeHours:8,potentialTimeHours:2,savingsPercentage:75,automationPossibility:"full",suggestion:"Usar Supermetrics + templates autom\xe1ticos"},{process:"Aprova\xe7\xe3o de artes com cliente",department:"designer",currentTimeHours:5,potentialTimeHours:1,savingsPercentage:80,automationPossibility:"partial",suggestion:"Implementar workflow de aprova\xe7\xe3o no sistema"},{process:"Publica\xe7\xe3o de posts em redes",department:"social_media",currentTimeHours:4,potentialTimeHours:.5,savingsPercentage:87,automationPossibility:"full",suggestion:"Agendamento autom\xe1tico via API"}],alerts:o}}async function g(e,t){let a=await p(),o=`
DADOS ATUAIS DE CAPACIDADE:
- Capacidade total: ${a.overview.totalCapacity}h/m\xeas
- Utiliza\xe7\xe3o geral: ${a.overview.totalUtilization.toFixed(1)}%
- Efici\xeancia m\xe9dia: ${a.overview.averageEfficiency.toFixed(1)}%
- Gargalos identificados: ${a.overview.bottlenecks} setores
- Potencial de economia: ${a.overview.potentialSavings}h/m\xeas

POR DEPARTAMENTO:
${a.departmentMetrics.map(e=>`- ${e.department}: ${e.utilizationRate.toFixed(1)}% utiliza\xe7\xe3o (${e.collaborators.length} pessoas)`).join("\n")}

ALERTAS ATIVOS:
${a.alerts.slice(0,3).map(e=>`- [${e.severity.toUpperCase()}] ${e.title}`).join("\n")}

PREVIS\xd5ES:
${a.capacityForecasts.filter(e=>e.willExceedCapacity).map(e=>`- ${e.department}: vai exceder capacidade em ${e.daysUntilOverload} dias`).join("\n")||"Nenhuma sobrecarga prevista"}

FERRAMENTAS RECOMENDADAS:
${a.toolRecommendations.slice(0,3).map(e=>`- ${e.toolName}: economia de ${e.timeSavingsHours}h/m\xeas, ROI ${e.roiPercentage}%`).join("\n")}
`;try{return(await (0,i.F)({task:"analysis",json:!1,temperature:.7,maxTokens:1e3,entityType:"cto_chat",entityId:null,messages:[{role:"system",content:r},{role:"system",content:o},{role:"user",content:e}]})).text||"Desculpe, n\xe3o consegui processar sua solicita\xe7\xe3o."}catch(e){return console.error("Erro no chat CTO:",e),"Erro ao processar solicita\xe7\xe3o. Tente novamente."}}}};