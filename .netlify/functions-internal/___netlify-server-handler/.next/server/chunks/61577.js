exports.id=61577,exports.ids=[61577],exports.modules={21659:(e,a,s)=>{Promise.resolve().then(s.bind(s,82724))},82724:(e,a,s)=>{"use strict";s.d(a,{default:()=>A});var t=s(10326),r=s(17577),l=s(90434),i=s(34738),n=s(71806),o=s(66307),c=s(79635),d=s(50949),u=s(71709),m=s(49758),x=s(94512),p=s(63685),h=s(77506),g=s(941),b=s(2777),f=s(50384),j=s(91664),v=s(29752),y=s(82015),N=s(20855),w=s(85999),S=s(10143),k=s(29280);function _(e){return String(e||"file").trim().replace(/[^\w.\-]+/g,"_").slice(0,120)}function C(e,a){return e&&a?new Date(`${e}T${a}:00`).toISOString():null}function P(e){return"instagram"===e?t.jsx(i.Z,{className:"w-3.5 h-3.5"}):"facebook"===e?t.jsx(n.Z,{className:"w-3.5 h-3.5"}):t.jsx("span",{className:"text-xs font-semibold",children:e.slice(0,2).toUpperCase()})}function A(e){let[a,s]=(0,r.useState)(!0),[i,n]=(0,r.useState)([]),[A,E]=(0,r.useState)(""),[T,$]=(0,r.useState)(!1);(0,r.useRef)(new Map);let[U,O]=(0,r.useState)([]),[D,R]=(0,r.useState)("instagramback"),[q,M]=(0,r.useState)([]),[Z,I]=(0,r.useState)("image"),[F,z]=(0,r.useState)([]),[L,B]=(0,r.useState)(""),[V,Y]=(0,r.useState)(""),[H,X]=(0,r.useState)(""),[J,K]=(0,r.useState)(""),[Q,W]=(0,r.useState)([]),[G,ee]=(0,r.useState)(!1),[ea,es]=(0,r.useState)(null),[et,er]=(0,r.useState)(null),[el,ei]=(0,r.useState)(null),[en,eo]=(0,r.useState)(!1),[ec,ed]=(0,r.useState)(null),[eu,em]=(0,r.useState)(!1),ex=e=>{try{window.open(e,"_blank","noopener,noreferrer")}catch{ei(`Abra este link em uma nova aba: ${e}`)}},[ep,eh]=(0,r.useState)(!1),[eg,eb]=(0,r.useState)([]),[ef,ej]=(0,r.useState)(!1),ev=(0,r.useRef)(null),ey=(0,r.useMemo)(()=>i.find(e=>e.id===A)||null,[i,A]),eN=(0,r.useMemo)(()=>F.map(e=>({file:e,url:URL.createObjectURL(e),isVideo:e.type.startsWith("video/")})),[F]);function ew(e){if(!e)return;let a=Array.from(e);if("carousel"===Z){z(a.filter(e=>e.type.startsWith("image/")).slice(0,10));return}z(a.slice(0,1))}async function eS(e){eh(!0),er(null);try{let a=e?`/api/social/posts-mirror?client_id=${encodeURIComponent(e)}`:"/api/social/posts-mirror",s=await fetch(a,{cache:"no-store"}),t=await s.json();if(!s.ok)throw Error(t?.error||"Falha ao carregar posts");eb(Array.isArray(t?.posts)?t.posts:[])}catch(e){er(e?.message||"Erro ao carregar posts")}finally{eh(!1)}}async function ek(){if(!F.length){er("Selecione arquivo(s) para upload");return}ee(!0),er(null),ei(null);try{let{data:e}=await b.O.auth.getUser(),a=e.user?.id;if(!a)throw Error("Sess\xe3o expirada. Fa\xe7a login novamente.");let s="social-media",t=Date.now(),r=A?_(A):"no_client",l=`${a}/posts/${r}`,i=[];for(let e of F){let a=`${t}_${Math.random().toString(36).slice(2,8)}_${_(e.name)}`,r=`${l}/${a}`,{error:n}=await b.O.storage.from(s).upload(r,e,{cacheControl:"31536000",upsert:!1,contentType:e.type||void 0});if(n){let e=String(n.message||"").toLowerCase();if(e.includes("bucket")&&e.includes("not found"))throw Error('Bucket "social-media" n\xe3o existe no Supabase Storage. Aplique a migration 20251230000003_create_social_media_bucket.sql.');throw n}let{data:o}=b.O.storage.from(s).getPublicUrl(r);if(!o?.publicUrl)throw Error("Falha ao obter URL p\xfablica do upload.");i.push(o.publicUrl)}W(i),ei("Upload conclu\xeddo (Supabase Storage). URLs prontas para postar.")}catch(e){er(e?.message||"Falha no upload")}finally{ee(!1)}}function e_(e){let a={};return"image"===Z&&(a.urlimagem=Q[0]||null),"video"===Z&&(a.urlvideo=Q[0]||null),"carousel"===Z&&(a.carrossel=Q.join(",")),{client_id:A||null,post_type:Z,type:Z,caption:L,legenda:L,collaborators:V,colaboradores:V,scheduled_at:C(H,J),scheduledAt:C(H,J),media_urls:Q,mediaUrls:Q,platforms:q.map(e=>String(e.platform)),channels:q,backend:D,...a,...e}}async function eC(e,a){var s;let t=(s={needsMedia:"schedule"===e||"publish_now"===e,needsSchedule:"schedule"===e},A?0===q.length?"Selecione ao menos um canal.":s.needsMedia&&0===Q.length?"Envie a m\xeddia (Storage) antes de continuar.":!s.needsSchedule||H&&J?"instagramback"===D&&q.some(e=>"instagram"!==e.platform)?"Para canais al\xe9m de Instagram, selecione o backend “Meta (OAuth)”.":null:"Informe data e hor\xe1rio.":"Selecione um perfil (cliente).");if(t){er(t);return}es(e+(a?.boost?"_boost":"")),er(null),ei(null);try{if("draft"===e){let e=await fetch("/api/social/post-records",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e_({is_draft:!0,approval_status:"approved",boost_requested:!!a?.boost,media_urls:Q,mediaUrls:Q}))}),s=await e.json();if(!e.ok)throw Error(s?.error||"Falha ao salvar rascunho");ei("Rascunho salvo.")}else if("approval"===e){let e=await fetch("/api/social/post-records",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e_({is_draft:!1,approval_status:"pending",boost_requested:!!a?.boost}))}),s=await e.json();if(!e.ok)throw Error(s?.error||"Falha ao enviar para aprova\xe7\xe3o");ei("Enviado para aprova\xe7\xe3o.")}else{let s="schedule"===e?C(H,J):null,t=e_({scheduled_at:s,scheduledAt:s,is_draft:!1,approval_status:"approved",boost_requested:!!a?.boost,mode:"schedule"===e?"schedule":"publish_now"});if("instagramback"===D){let a=await fetch("/api/social/instagramback/posts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),s=await a.json();if(!a.ok)throw Error(s?.error||"Falha ao criar post");ei("schedule"===e?"Post agendado (InstagramBack).":"Post enviado (InstagramBack).")}else{let a=await fetch("/api/social/meta/posts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),s=await a.json();if(!a.ok)throw Error(s?.error||"Falha ao publicar via Meta");ei("schedule"===e?"Post agendado (Meta).":"Post publicado (Meta).")}}z([]),W([]),B(""),Y(""),X(""),K(""),await eS(A)}catch(e){er(e?.message||"Erro")}finally{es(null)}}async function eP(e){ed(e||null),eo(!0)}async function eA(){if(!ec)return;let e=ec?.external_id?String(ec.external_id):null,a=ec?.id?String(ec.id):null;em(!0),er(null),ei(null);try{if(e&&"instagramback"===String(ec?.backend||"instagramback")){let a=await fetch(`/api/social/instagramback/posts/${encodeURIComponent(e)}`,{method:"DELETE"}),s=await a.json().catch(()=>null);if(!a.ok)throw Error(s?.error||"Falha ao deletar no InstagramBack")}else if(a){let e=await fetch(`/api/social/posts-mirror?id=${encodeURIComponent(a)}`,{method:"DELETE"}),s=await e.json().catch(()=>null);if(!e.ok)throw Error(s?.error||"Falha ao deletar")}else throw Error("N\xe3o foi poss\xedvel identificar o post para deletar.");w.Am.success("Post deletado."),ei("Post deletado."),eo(!1),ed(null),await eS(A)}catch(a){let e=String(a?.message||"Erro ao deletar");w.Am.error(e),er(e)}finally{em(!1)}}return(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[t.jsx("div",{className:"bg-white border-b px-6 py-4 sticky top-0 z-10",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto flex items-center justify-between gap-4",children:[(0,t.jsxs)("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:e.title}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Perfil → Canais → Texto → M\xeddia (Firebase) → Agendar/Publicar (InstagramBack ou Meta)."})]}),e.backHref&&t.jsx(l.default,{className:"text-sm text-gray-700 hover:text-gray-900 underline",href:e.backHref,children:"Voltar"})]})}),(0,t.jsxs)("div",{className:"max-w-7xl mx-auto p-6 pb-28",children:[et&&t.jsx("div",{className:"mb-4 rounded-xl border border-red-200 bg-red-50 p-4 text-sm text-red-700",children:et}),el&&(0,t.jsxs)("div",{className:"mb-4 rounded-xl border border-emerald-200 bg-emerald-50 p-4 text-sm text-emerald-800 flex items-center gap-2",children:[t.jsx(o.Z,{className:"w-4 h-4"}),el]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[(0,t.jsxs)("div",{className:"lg:col-span-4 space-y-6",children:[(0,t.jsxs)(v.Zb,{children:[t.jsx(v.Ol,{className:"pb-3",children:t.jsx(v.ll,{className:"text-base",children:"1. Selecione perfis"})}),t.jsx(v.aY,{className:"pt-0 space-y-3",children:a?(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx("div",{className:"h-10 rounded-lg bg-gray-100"}),t.jsx("div",{className:"h-4 w-40 rounded bg-gray-100"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(k.Ph,{value:A,onValueChange:e=>E(e),children:[t.jsx(k.i4,{className:"rounded-lg",children:t.jsx(k.ki,{placeholder:"Selecione um cliente",children:(0,t.jsxs)("span",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"w-8 h-8 rounded-lg bg-gray-100 flex items-center justify-center border",children:t.jsx(c.Z,{className:"w-4 h-4 text-gray-600"})}),t.jsx("span",{className:"text-sm font-medium text-gray-900",children:ey?String(ey.name||"").trim():"Selecione"})]})})}),(0,t.jsxs)(k.Bw,{children:[0===i.length&&t.jsx(k.Ql,{value:"__none",children:"Nenhum cliente"}),i.map(e=>t.jsx(k.Ql,{value:e.id,children:(0,t.jsxs)("div",{className:"flex items-center justify-between gap-3 w-full",children:[t.jsx("span",{className:"truncate",children:e.name}),(e.city||e.state)&&t.jsx("span",{className:"text-xs text-gray-500",children:[e.city,e.state].filter(Boolean).join(" • ")})]})},e.id))]})]}),t.jsx("p",{className:"text-xs text-gray-500",children:"O cliente conecta as redes em “Cliente → Redes Sociais”."})]})})]}),(0,t.jsxs)(v.Zb,{children:[t.jsx(v.Ol,{className:"pb-3",children:t.jsx(v.ll,{className:"text-base",children:"2. Selecione canais"})}),(0,t.jsxs)(v.aY,{className:"pt-0 space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,t.jsxs)("div",{className:"text-xs text-gray-600",children:["Selecionados: ",t.jsx("span",{className:"font-semibold",children:q.length})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx("button",{type:"button",onClick:()=>R("instagramback"),className:`text-xs rounded-full px-3 py-1 border ${"instagramback"===D?"bg-valle-blue-50 border-valle-blue-200 text-valle-blue-700":"bg-white border-gray-200 text-gray-600 hover:bg-gray-50"}`,children:"InstagramBack"}),t.jsx("button",{type:"button",onClick:()=>R("meta"),className:`text-xs rounded-full px-3 py-1 border ${"meta"===D?"bg-valle-blue-50 border-valle-blue-200 text-valle-blue-700":"bg-white border-gray-200 text-gray-600 hover:bg-gray-50"}`,children:"Meta (OAuth)"})]})]}),T?(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx("div",{className:"h-9 rounded-lg bg-gray-100"}),t.jsx("div",{className:"h-9 rounded-lg bg-gray-100"})]}):0===U.length?(0,t.jsxs)("div",{className:"rounded-xl border bg-gray-50 p-3 text-sm text-gray-700 flex items-start gap-2",children:[t.jsx(d.Z,{className:"w-4 h-4 mt-0.5 text-gray-500"}),"Nenhum canal conectado para este cliente ainda."]}):t.jsx("div",{className:"flex flex-wrap items-center gap-2",children:U.map(e=>{let a=q.some(a=>a.account_id===e.id);return(0,t.jsxs)("button",{type:"button",onClick:()=>{M(a=>a.some(a=>a.account_id===e.id)?a.filter(a=>a.account_id!==e.id):[...a,{account_id:e.id,platform:String(e.platform)}])},className:`inline-flex items-center gap-2 rounded-full border px-3 py-1.5 text-xs transition-colors ${a?"bg-valle-blue-50 border-valle-blue-200 text-valle-blue-700":"bg-white hover:bg-gray-50"}`,title:e.display_name||e.username||e.external_account_id,children:[t.jsx("span",{className:"w-5 h-5 rounded-full bg-white border flex items-center justify-center text-gray-700",children:P(String(e.platform))}),t.jsx("span",{className:"max-w-[160px] truncate",children:e.display_name||(e.username?`@${e.username}`:e.external_account_id)})]},e.id)})})]})]}),(0,t.jsxs)(v.Zb,{children:[t.jsx(v.Ol,{className:"pb-3",children:t.jsx(v.ll,{className:"text-base",children:"3. Texto do post"})}),(0,t.jsxs)(v.aY,{className:"pt-0 space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Tipo"}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,t.jsxs)("button",{type:"button",onClick:()=>{I("image"),z([]),W([])},className:`rounded-lg border px-3 py-2 text-sm flex items-center justify-center gap-2 ${"image"===Z?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 hover:bg-gray-50"}`,children:[t.jsx(u.Z,{className:"w-4 h-4"}),"Imagem"]}),(0,t.jsxs)("button",{type:"button",onClick:()=>{I("video"),z([]),W([])},className:`rounded-lg border px-3 py-2 text-sm flex items-center justify-center gap-2 ${"video"===Z?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 hover:bg-gray-50"}`,children:[t.jsx(m.Z,{className:"w-4 h-4"}),"V\xeddeo"]}),(0,t.jsxs)("button",{type:"button",onClick:()=>{I("carousel"),z([]),W([])},className:`rounded-lg border px-3 py-2 text-sm flex items-center justify-center gap-2 ${"carousel"===Z?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 hover:bg-gray-50"}`,children:[t.jsx(x.Z,{className:"w-4 h-4"}),"Carrossel"]})]}),t.jsx("p",{className:"text-xs text-gray-500",children:"carousel"===Z?"At\xe9 10 m\xeddias (IG). FB: 1 m\xeddia no momento.":"Selecione 1 arquivo."})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Legenda"}),t.jsx(y.g,{value:L,onChange:e=>B(e.target.value),placeholder:"Digite a legenda aqui…",className:"min-h-[140px]"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Colaboradores (opcional)"}),t.jsx("input",{value:V,onChange:e=>Y(e.target.value),placeholder:"@user1, @user2",className:"w-full h-10 rounded-lg border px-3 text-sm bg-white"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx("label",{className:"text-sm font-medium text-gray-700",children:"5. Data e hor\xe1rio das publica\xe7\xf5es"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[t.jsx("input",{type:"date",value:H,onChange:e=>X(e.target.value),className:"w-full h-10 rounded-lg border px-3 text-sm bg-white"}),t.jsx("input",{type:"time",value:J,onChange:e=>K(e.target.value),className:"w-full h-10 rounded-lg border px-3 text-sm bg-white"})]}),t.jsx("p",{className:"text-xs text-gray-500",children:"Para “Publicar agora”, deixe em branco ou use a a\xe7\xe3o “Publicar agora”."})]})]})]})]}),t.jsx("div",{className:"lg:col-span-5 space-y-6",children:(0,t.jsxs)(v.Zb,{children:[t.jsx(v.Ol,{className:"pb-3",children:t.jsx(v.ll,{className:"text-base",children:"4. M\xeddias"})}),(0,t.jsxs)(v.aY,{className:"pt-0 space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)(j.z,{type:"button",variant:"outline",className:"gap-2",onClick:()=>ev.current?.click(),children:[t.jsx(p.Z,{className:"w-4 h-4"}),"Upload"]}),t.jsx(j.z,{type:"button",variant:"outline",onClick:()=>ex("https://business.facebook.com/latest/content_calendar"),children:"Studio"}),t.jsx(j.z,{type:"button",variant:"outline",onClick:()=>ex("https://www.canva.com/"),children:"Canva"})]}),(0,t.jsxs)("div",{className:`rounded-xl border-2 border-dashed bg-gray-50 p-6 transition-colors ${ef?"border-valle-blue-400 bg-valle-blue-50":"border-gray-300"}`,onDragEnter:e=>{e.preventDefault(),e.stopPropagation(),ej(!0)},onDragOver:e=>{e.preventDefault(),e.stopPropagation(),ej(!0)},onDragLeave:e=>{e.preventDefault(),e.stopPropagation(),ej(!1)},onDrop:e=>{e.preventDefault(),e.stopPropagation(),ej(!1),ew(e.dataTransfer?.files||null)},onClick:()=>ev.current?.click(),role:"button",tabIndex:0,children:[t.jsx("input",{ref:e=>{ev.current=e},type:"file",className:"hidden",accept:"video"===Z?"video/*":"image/*",multiple:"carousel"===Z,onChange:e=>ew(e.target.files)}),F.length?(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[t.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Arquivos selecionados"}),t.jsx("button",{type:"button",className:"text-xs text-red-600 underline",onClick:e=>{e.stopPropagation(),z([]),W([])},children:"Limpar"})]}),t.jsx("div",{className:`grid gap-3 ${"carousel"===Z?"grid-cols-2":"grid-cols-1"}`,children:eN.map(e=>(0,t.jsxs)("div",{className:"rounded-xl border bg-white overflow-hidden",children:[t.jsx("div",{className:"aspect-video bg-black/5 flex items-center justify-center",children:e.isVideo?t.jsx("video",{src:e.url,controls:!0,className:"w-full h-full object-contain bg-black"}):t.jsx("img",{src:e.url,alt:e.file.name,className:"w-full h-full object-cover"})}),(0,t.jsxs)("div",{className:"p-3",children:[t.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.file.name}),(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:[Math.round(e.file.size/1024)," KB"]})]})]},`${e.file.name}-${e.file.size}`))})]}):(0,t.jsxs)("div",{className:"text-center",children:[t.jsx("div",{className:"mx-auto w-12 h-12 rounded-xl bg-white border flex items-center justify-center",children:t.jsx(p.Z,{className:"w-5 h-5 text-gray-600"})}),t.jsx("p",{className:"mt-3 text-sm font-medium text-gray-900",children:"Imagens e v\xeddeos"}),t.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Clique aqui ou arraste arquivos para enviar"})]})]}),(0,t.jsxs)("div",{className:"text-xs text-gray-600",children:["URLs carregadas: ",t.jsx("span",{className:"font-semibold",children:Q.length}),Q.length>0&&t.jsx("div",{className:"mt-2 grid grid-cols-1 gap-1",children:Q.slice(0,3).map(e=>t.jsx("a",{href:e,target:"_blank",rel:"noreferrer",className:"underline text-valle-blue-700",children:e},e))})]})]})]})}),t.jsx("div",{className:"lg:col-span-3 space-y-6",children:(0,t.jsxs)(v.Zb,{children:[t.jsx(v.Ol,{className:"pb-3",children:t.jsx(v.ll,{className:"text-base",children:"Preview"})}),t.jsx(v.aY,{className:"pt-0",children:(0,t.jsxs)(f.mQ,{defaultValue:"preview",children:[(0,t.jsxs)(f.dr,{className:"w-full justify-between",children:[t.jsx(f.SP,{value:"preview",children:"Preview"}),t.jsx(f.SP,{value:"all",children:"Ver todos"})]}),t.jsx(f.nU,{value:"preview",className:"mt-4",children:(0,t.jsxs)("div",{className:"rounded-xl border bg-white overflow-hidden",children:[(0,t.jsxs)("div",{className:"p-3 flex items-center gap-2 border-b",children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-pink-500 to-purple-500"}),(0,t.jsxs)("div",{className:"flex-1",children:[t.jsx("p",{className:"text-sm font-semibold text-gray-900",children:ey?.name||"Selecione um perfil"}),t.jsx("p",{className:"text-xs text-gray-500",children:q.length?`${q.length} canal(is)`:"Selecione canais"})]}),t.jsx("div",{className:"flex items-center gap-1 text-gray-600",children:q.slice(0,2).map(e=>t.jsx("span",{className:"w-7 h-7 rounded-full border bg-white flex items-center justify-center",children:P(e.platform)},e.account_id))})]}),t.jsx("div",{className:"bg-gray-100",children:0===eN.length?t.jsx("div",{className:"aspect-square flex items-center justify-center text-xs text-gray-500",children:"Selecione uma m\xeddia para ver o preview"}):eN[0].isVideo?t.jsx("div",{className:"aspect-square",children:t.jsx("video",{src:eN[0].url,controls:!0,className:"w-full h-full object-contain bg-black"})}):t.jsx("div",{className:"aspect-square",children:t.jsx("img",{src:eN[0].url,alt:"preview",className:"w-full h-full object-cover"})})}),t.jsx("div",{className:"p-3",children:t.jsx("p",{className:"text-sm text-gray-800 whitespace-pre-wrap",children:L||"Escreva a legenda para ver aqui…"})})]})}),(0,t.jsxs)(f.nU,{value:"all",className:"mt-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("p",{className:"text-sm font-semibold text-gray-900",children:"Posts (Hist\xf3rico)"}),t.jsx(j.z,{type:"button",variant:"outline",size:"sm",onClick:()=>eS(A),disabled:ep,children:ep?"Atualizando…":"Recarregar"})]}),0===eg.length&&!ep&&t.jsx("p",{className:"text-sm text-gray-600",children:"Nenhum post encontrado."}),t.jsx("div",{className:"space-y-3",children:eg.slice(0,25).map(e=>{let a=function(e){let a=e?.id??e?._id??e?.external_id??e?.externalId;return a?String(a):null}(e)||String(e?.id||""),s=String(e?.backend||"instagramback"),r=String(e?.status||""),l=Array.isArray(e?.media_urls)?e.media_urls:[];return(0,t.jsxs)("div",{className:"rounded-xl border bg-white p-3",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,t.jsxs)("div",{children:[t.jsx("p",{className:"text-sm font-semibold text-gray-900",children:e?.external_id?`#${String(e.external_id)}`:`Post ${String(e.id).slice(0,6)}`}),(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:[s," • ",r]})]}),t.jsx("button",{onClick:()=>eP(e),className:"text-xs underline text-red-600",children:"Deletar"})]}),(e?.caption||e?.legenda)&&t.jsx("p",{className:"text-sm mt-2 text-gray-700 line-clamp-3",children:String(e?.caption||e?.legenda)}),Array.isArray(l)&&l.length>0&&t.jsx("div",{className:"mt-2 grid grid-cols-2 gap-2",children:l.slice(0,2).map(e=>t.jsx("a",{href:String(e),target:"_blank",rel:"noreferrer",className:"text-xs underline text-valle-blue-700",children:"m\xeddia"},String(e)))})]},a||JSON.stringify(e).slice(0,40))})})]})]})})]})})]})]}),t.jsx("div",{className:"fixed inset-x-0 bottom-0 border-t bg-white",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-6 py-4 flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-3",children:[(0,t.jsxs)("div",{className:"text-xs text-gray-600",children:[t.jsx("span",{className:"font-medium text-gray-900",children:F.length})," arquivo(s) •"," ",t.jsx("span",{className:"font-medium text-gray-900",children:Q.length})," URL(s) pronta(s)"]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 justify-end",children:[t.jsx(j.z,{type:"button",variant:"outline",onClick:ek,disabled:G||!F.length,children:G?(0,t.jsxs)("span",{className:"inline-flex items-center gap-2",children:[t.jsx(h.Z,{className:"w-4 h-4 animate-spin"}),"Enviando…"]}):"Enviar m\xeddia"}),t.jsx(j.z,{type:"button",variant:"outline",onClick:()=>eC("publish_now"),disabled:!!ea,children:"publish_now"===ea?"Publicando…":"Publicar agora"}),(0,t.jsxs)("div",{className:"flex items-center",children:[t.jsx(j.z,{type:"button",onClick:()=>eC("schedule"),disabled:!!ea,children:"schedule"===ea?"Agendando…":"Agendar"}),(0,t.jsxs)(S.h_,{children:[t.jsx(S.$F,{asChild:!0,children:t.jsx("button",{type:"button",className:"h-10 w-10 inline-flex items-center justify-center rounded-lg border-2 border-valle-blue-600 text-valle-blue-600 hover:bg-valle-blue-50 disabled:opacity-50 disabled:pointer-events-none","aria-label":"Mais op\xe7\xf5es",disabled:!!ea,children:t.jsx(g.Z,{className:"w-4 h-4"})})}),(0,t.jsxs)(S.AW,{align:"end",children:[t.jsx(S.Xi,{onClick:()=>eC("schedule"),children:"Agendar"}),t.jsx(S.Xi,{onClick:()=>eC("publish_now"),children:"Publicar agora"}),t.jsx(S.VD,{}),t.jsx(S.Xi,{onClick:()=>eC("draft"),children:"Salvar como rascunho"}),t.jsx(S.Xi,{onClick:()=>eC("approval"),children:"Enviar para aprova\xe7\xe3o"}),t.jsx(S.VD,{}),t.jsx(S.Xi,{onClick:()=>eC("schedule",{boost:!0}),children:"Agendar e impulsionar"}),t.jsx(S.Xi,{onClick:()=>eC("publish_now",{boost:!0}),children:"Publicar agora e impulsionar"})]})]})]})]})]})}),t.jsx(N.do,{isOpen:en,onClose:()=>{eu||(eo(!1),ed(null))},onConfirm:eA,title:"Deletar post",message:"Tem certeza que deseja deletar este post? Essa a\xe7\xe3o n\xe3o pode ser desfeita.",confirmText:"Deletar",cancelText:"Cancelar",variant:"danger",loading:eu})]})}},29752:(e,a,s)=>{"use strict";s.d(a,{Ol:()=>n,SZ:()=>c,Zb:()=>i,aY:()=>d,ll:()=>o});var t=s(10326),r=s(17577),l=s(51223);let i=r.forwardRef(({className:e,...a},s)=>t.jsx("div",{ref:s,className:(0,l.cn)("rounded-xl border-2 border-valle-silver-200 bg-white shadow-md",e),...a}));i.displayName="Card";let n=r.forwardRef(({className:e,...a},s)=>t.jsx("div",{ref:s,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",e),...a}));n.displayName="CardHeader";let o=r.forwardRef(({className:e,...a},s)=>t.jsx("h3",{ref:s,className:(0,l.cn)("font-semibold leading-none tracking-tight text-lg",e),...a}));o.displayName="CardTitle";let c=r.forwardRef(({className:e,...a},s)=>t.jsx("p",{ref:s,className:(0,l.cn)("text-sm text-foreground/70",e),...a}));c.displayName="CardDescription";let d=r.forwardRef(({className:e,...a},s)=>t.jsx("div",{ref:s,className:(0,l.cn)("p-6 pt-0",e),...a}));d.displayName="CardContent",r.forwardRef(({className:e,...a},s)=>t.jsx("div",{ref:s,className:(0,l.cn)("flex items-center p-6 pt-0",e),...a})).displayName="CardFooter"},50384:(e,a,s)=>{"use strict";s.d(a,{SP:()=>c,dr:()=>o,mQ:()=>n,nU:()=>d});var t=s(10326),r=s(17577),l=s(51223);let i=r.createContext(void 0);function n({defaultValue:e,value:a,onValueChange:s,children:n,className:o}){if(void 0===a&&void 0===e)throw Error("Tabs requires either `value` (controlled) or `defaultValue` (uncontrolled).");let c=a??e??"",[d,u]=r.useState(c);return r.useEffect(()=>{void 0!==a&&u(a)},[a]),t.jsx(i.Provider,{value:{activeTab:d,setActiveTab:e=>{void 0===a&&u(e),s?.(e)}},children:t.jsx("div",{className:(0,l.cn)("",o),children:n})})}function o({children:e,className:a}){return t.jsx("div",{className:(0,l.cn)("inline-flex h-10 items-center justify-center rounded-lg bg-gray-100 dark:bg-gray-800 p-1 text-gray-600 dark:text-gray-400",a),children:e})}function c({value:e,children:a,className:s}){let n=r.useContext(i);if(!n)throw Error("TabsTrigger must be used within Tabs");let{activeTab:o,setActiveTab:c}=n,d=o===e;return t.jsx("button",{type:"button",onClick:()=>c(e),className:(0,l.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1.5 text-sm font-medium ring-offset-white transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-400 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",d?"bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700",s),children:a})}function d({value:e,children:a,className:s}){let n=r.useContext(i);if(!n)throw Error("TabsContent must be used within Tabs");let{activeTab:o}=n;return o!==e?null:t.jsx("div",{className:(0,l.cn)("mt-2 ring-offset-white focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-400 focus-visible:ring-offset-2",s),children:a})}},82015:(e,a,s)=>{"use strict";s.d(a,{g:()=>i});var t=s(10326),r=s(17577),l=s(51223);let i=r.forwardRef(({className:e,...a},s)=>t.jsx("textarea",{className:(0,l.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:s,...a}));i.displayName="Textarea"},15214:(e,a,s)=>{"use strict";s.d(a,{Z:()=>t});let t=(0,s(68570).createProxy)(String.raw`C:\Users\User\Downloads\valle-360-main\valle-360-main\src\components\social\UploadPostsCenter.tsx#default`)},52955:(e,a,s)=>{"use strict";s.d(a,{U:()=>i});var t=s(57157);async function r(e,a,s){try{let{data:t,error:r}=await e.rpc(a,s);if(r)return{ok:!1,error:r};return{ok:!0,data:t}}catch(e){return{ok:!1,error:e}}}function l(e){return Array.from(new Set(e))}async function i(e){let a=e.supabase,{data:s}=await a.auth.getUser(),i=s.user?.id;if(!i)return{userId:"",isSuperAdmin:!1,isAdmin:!1,allowed:!1,reason:"N\xe3o autenticado",areaKeys:[]};let n=await r(a,"is_admin"),o=!!n.ok&&!!n.data,c=await r(a,"is_super_admin"),d=!!c.ok&&!!c.data;if(o||d)return{userId:i,isSuperAdmin:d,isAdmin:o,allowed:!0,areaKeys:[]};let u=await r(a,"employee_area_keys");if(u.ok&&Array.isArray(u.data)){let e=(u.data||[]).map(e=>String(e)),a=e.includes("social_media")||e.includes("head_marketing");return{userId:i,isSuperAdmin:d,isAdmin:o,allowed:a,reason:a?void 0:"Acesso restrito: necess\xe1rio Social Media ou Head Marketing",areaKeys:l(e)}}let{data:m}=await a.from("employees").select("department, area_of_expertise, areas, is_active").eq("user_id",i).maybeSingle(),x=[];m?.department&&x.push(String(m.department)),m?.area_of_expertise&&x.push(String(m.area_of_expertise)),Array.isArray(m?.areas)&&x.push(...m.areas.map(e=>String(e)));let p=l(x.map(e=>(0,t.IY)(e)).filter(Boolean).map(e=>e)),h=p.includes("social_media")||p.includes("head_marketing");return{userId:i,isSuperAdmin:d,isAdmin:o,allowed:h,reason:h?void 0:"Acesso restrito: necess\xe1rio Social Media ou Head Marketing",areaKeys:p}}}};