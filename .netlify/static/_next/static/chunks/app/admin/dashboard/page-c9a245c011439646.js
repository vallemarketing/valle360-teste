(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8427],{70059:function(e,s,a){Promise.resolve().then(a.bind(a,76764))},76764:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return B}});var t=a(57437),r=a(2265),i=a(26892),l=a(57586),d=a(37806),n=a(95805),c=a(96215),o=a(98728),m=a(5005),x=a(95252),h=a(58896),u=a(94766),p=a(42488),j=a(49322),b=a(11239),g=a(10407),f=a(91723),N=a(64972),v=a(33327),y=a(70525),w=a(60044),C=a(32489),Z=a(89345),k=a(13041),E=a(42208),I=a(53417),S=a(27648),A=a(79820),_=a(69174),O=a(12381),T=a(96246),z=a(45387),R=a(92267),V=a(76078),P=a(93448),q=a(14438),J=a(13337),X=a(5526);function B(){let e=(0,r.useRef)(null),[s,a]=(0,r.useState)({totalClients:0,activeClients:0,totalEmployees:0,activeEmployees:0,monthlyRevenue:0,pendingTasks:0,completedTasksToday:0,avgClientSatisfaction:0}),[B,D]=(0,r.useState)(null),[Y,F]=(0,r.useState)(!1),[H,L]=(0,r.useState)([]),M=async()=>{try{var e;let{data:s}=await X.supabase.auth.getSession(),a=null===(e=s.session)||void 0===e?void 0:e.access_token;return a?{Authorization:"Bearer ".concat(a)}:{}}catch(e){return{}}},[U,G]=(0,r.useState)("/admin/fluxos?tab=transitions&status=pending"),Q=async()=>{try{var e,s;let t=await M(),r=await fetch("/api/admin/dashboard",{headers:t}),i=await r.json().catch(()=>null);if(!r.ok)return;(null==i?void 0:i.stats)&&a(e=>({...e,...i.stats})),Array.isArray(null==i?void 0:i.recentActivity)&&i.recentActivity.length>0&&es(i.recentActivity),Array.isArray(null==i?void 0:i.activeClients)&&i.activeClients.length>0&&L(i.activeClients),(null==i?void 0:null===(s=i.hub)||void 0===s?void 0:null===(e=s.links)||void 0===e?void 0:e.pending)&&G(String(i.hub.links.pending))}catch(e){}};(0,r.useEffect)(()=>{Q()},[]);let K=e=>{D(e),F(!0)},W=e=>{switch(e){case"em_dia":return"bg-emerald-500/10 text-emerald-500 border-emerald-500/30";case"atrasado":return"bg-red-500/10 text-red-500 border-red-500/30";case"novo":return"bg-[#1672d6]/10 text-[#1672d6] border-[#1672d6]/30";default:return"bg-gray-500/10 text-gray-500 border-gray-500/30"}},$=e=>{switch(e){case"em_dia":return"Em dia";case"atrasado":return"Atrasado";case"novo":return"Novo";default:return e}},[ee,es]=(0,r.useState)([]),ea=[{title:"Novo Cliente",description:"Cadastrar novo cliente",icon:d.Z,href:"/admin/clientes/novo",color:"#1672d6"},{title:"Novo Colaborador",description:"Adicionar colaborador",icon:n.Z,href:"/admin/colaboradores/novo",color:"#10b981"},{title:"Relat\xf3rios",description:"Ver todos os relat\xf3rios",href:"/admin/relatorios",icon:c.Z,color:"#8b5cf6"},{title:"Configura\xe7\xf5es",description:"Gerenciar sistema",href:"/admin/configuracoes",icon:o.Z,color:"#f59e0b"}],et=[{title:"Total de Clientes",value:s.totalClients.toString(),change:{value:"+".concat(s.activeClients," ativos"),type:"increase"},icon:(0,t.jsx)(m.Z,{className:"w-5 h-5"}),description:"Clientes cadastrados"},{title:"Colaboradores",value:s.totalEmployees.toString(),change:{value:"+".concat(s.activeEmployees," ativos"),type:"increase"},icon:(0,t.jsx)(n.Z,{className:"w-5 h-5"}),description:"Equipe completa"},{title:"Receita Mensal",value:"R$ ".concat((s.monthlyRevenue/1e3).toFixed(0),"k"),change:{value:"+12% vs m\xeas anterior",type:"increase"},icon:(0,t.jsx)(x.Z,{className:"w-5 h-5"}),description:"Faturamento do m\xeas"},{title:"Tarefas Pendentes",value:s.pendingTasks.toString(),change:{value:"".concat(s.completedTasksToday," conclu\xeddas hoje"),type:"neutral"},icon:(0,t.jsx)(h.Z,{className:"w-5 h-5"}),description:"Kanban + Fluxos + Eventos"}],er=e=>({user:n.Z,task:h.Z,money:x.Z,alert:u.Z})[e],ei=e=>({user:"bg-[#1672d6]/10 text-[#1672d6]",task:"bg-emerald-500/10 text-emerald-500",money:"bg-purple-500/10 text-purple-500",alert:"bg-amber-500/10 text-amber-500"})[e];return(0,t.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,t.jsx)(i.E.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-8",children:(0,t.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-foreground",children:"Dashboard Admin"}),(0,t.jsx)("p",{className:"text-muted-foreground mt-1",children:"Vis\xe3o geral do sistema Valle 360"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)(_.C,{variant:"outline",className:"border-[#1672d6]/30 text-[#1672d6] bg-[#1672d6]/5",children:[(0,t.jsx)(p.Z,{className:"w-3 h-3 mr-1"}),"Sistema Online"]}),(0,t.jsx)(S.default,{href:U,children:(0,t.jsxs)(O.z,{variant:"outline",className:"border-[#1672d6]/30 text-[#1672d6] hover:bg-[#1672d6]/5",children:[(0,t.jsx)(j.Z,{className:"w-4 h-4 mr-2"}),"Pend\xeancias do Hub"]})}),(0,t.jsxs)(O.z,{onClick:()=>{try{var s;null===(s=e.current)||void 0===s||s.scrollIntoView({behavior:"smooth",block:"start"}),q.Am.info("Abrindo a\xe7\xf5es r\xe1pidas…"),(0,J.L)("admin_dashboard_quick_actions_click",{level:"info"})}catch(e){(0,J.L)("admin_dashboard_quick_actions_click_error",{level:"error",message:null==e?void 0:e.message})}},className:"bg-[#1672d6] hover:bg-[#1672d6]/90",children:[(0,t.jsx)(b.Z,{className:"w-4 h-4 mr-2"}),"A\xe7\xf5es R\xe1pidas"]})]})]})}),(0,t.jsx)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"mb-8",children:(0,t.jsx)(S.default,{href:U,className:"block",children:(0,t.jsx)(z.ZP,{stats:et,columns:4})})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8",children:[(0,t.jsx)(i.E.div,{ref:e,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"lg:col-span-2",children:(0,t.jsxs)(A.Zb,{className:"border-border/60 h-full",children:[(0,t.jsx)(A.Ol,{className:"pb-4",children:(0,t.jsxs)(A.ll,{className:"text-xl font-semibold flex items-center gap-2",children:[(0,t.jsx)(p.Z,{className:"w-5 h-5 text-[#1672d6]"}),"A\xe7\xf5es R\xe1pidas"]})}),(0,t.jsx)(A.aY,{children:(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:ea.map((e,s)=>{let a=e.icon;return(0,t.jsx)(S.default,{href:e.href,children:(0,t.jsx)(i.E.div,{whileHover:{y:-4,transition:{duration:.2}},whileTap:{scale:.98},className:"p-4 rounded-xl border-2 border-border/60 cursor-pointer transition-all hover:border-[#1672d6]/40 hover:shadow-lg hover:shadow-[#1672d6]/5 bg-card",children:(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("div",{className:"p-3 rounded-lg",style:{backgroundColor:"".concat(e.color,"15")},children:(0,t.jsx)(a,{className:"w-6 h-6",style:{color:e.color}})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h3",{className:"font-semibold text-foreground mb-1",children:e.title}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:e.description})]}),(0,t.jsx)(g.Z,{className:"w-5 h-5 text-muted-foreground"})]})})},s)})})})]})}),(0,t.jsx)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:(0,t.jsxs)(A.Zb,{className:"border-border/60 h-full",children:[(0,t.jsx)(A.Ol,{className:"pb-4",children:(0,t.jsxs)(A.ll,{className:"text-xl font-semibold flex items-center justify-between",children:[(0,t.jsxs)("span",{className:"flex items-center gap-2",children:[(0,t.jsx)(f.Z,{className:"w-5 h-5 text-[#1672d6]"}),"Atividades Recentes"]}),(0,t.jsx)(S.default,{href:"/admin/auditoria",children:(0,t.jsx)(O.z,{variant:"ghost",size:"sm",className:"text-[#1672d6]",children:"Ver todas"})})]})}),(0,t.jsx)(A.aY,{children:(0,t.jsx)("div",{className:"space-y-4",children:ee.map(e=>{let s=er(e.icon),a=(0,t.jsxs)(i.E.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},whileHover:{x:4},className:"flex items-start gap-3 pb-4 border-b border-border/60 last:border-b-0 last:pb-0 cursor-pointer",children:[(0,t.jsx)("div",{className:"p-2 rounded-lg flex-shrink-0 ".concat(ei(e.icon)),children:(0,t.jsx)(s,{className:"w-4 h-4"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"font-medium text-sm text-foreground mb-1",children:e.title}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mb-1 truncate",children:e.description}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground/70",children:e.time})]})]},e.id);return e.link?(0,t.jsx)(S.default,{href:e.link,className:"block",children:a},e.id):a})})})]})})]}),(0,t.jsx)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"mb-8",children:(0,t.jsx)(A.Zb,{className:"border-2 border-[#1672d6]/20 bg-gradient-to-br from-[#1672d6]/5 to-transparent",children:(0,t.jsx)(A.aY,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-start gap-4",children:[(0,t.jsx)("div",{className:"p-3 rounded-xl bg-gradient-to-br from-[#001533] to-[#1672d6] shadow-lg shadow-[#1672d6]/20",children:(0,t.jsx)(N.Z,{className:"w-6 h-6 text-white"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)("h3",{className:"font-bold text-foreground",children:"\uD83D\uDCA1 Insights da Val (IA)"}),(0,t.jsx)(_.C,{variant:"outline",className:"border-[#1672d6]/30 text-[#1672d6] text-xs",children:"Atualizado agora"})]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Baseado nos dados dos \xfaltimos 30 dias, identifiquei algumas oportunidades:"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)(i.E.div,{whileHover:{y:-2},className:"flex items-center gap-3 p-3 rounded-lg bg-card border border-border/60",children:[(0,t.jsx)("div",{className:"p-2 rounded-lg bg-emerald-500/10",children:(0,t.jsx)(v.Z,{className:"w-4 h-4 text-emerald-500"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-foreground",children:"3 clientes"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"prontos para upgrade"})]})]}),(0,t.jsxs)(i.E.div,{whileHover:{y:-2},className:"flex items-center gap-3 p-3 rounded-lg bg-card border border-border/60",children:[(0,t.jsx)("div",{className:"p-2 rounded-lg bg-[#1672d6]/10",children:(0,t.jsx)(y.Z,{className:"w-4 h-4 text-[#1672d6]"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-foreground",children:"+18%"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"produtividade este m\xeas"})]})]}),(0,t.jsxs)(i.E.div,{whileHover:{y:-2},className:"flex items-center gap-3 p-3 rounded-lg bg-card border border-border/60",children:[(0,t.jsx)("div",{className:"p-2 rounded-lg bg-amber-500/10",children:(0,t.jsx)(u.Z,{className:"w-4 h-4 text-amber-500"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-foreground",children:"2 colaboradores"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"precisam de aten\xe7\xe3o"})]})]})]})]})]})})})}),(0,t.jsx)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"mb-8",children:(0,t.jsx)(A.Zb,{className:"border-border/60 overflow-hidden",children:(0,t.jsx)(R.Z,{title:"Projetos Ativos",subtitle:"Visualize o status de todos os projetos e suas conex\xf5es"})})}),(0,t.jsx)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"mb-8",children:(0,t.jsxs)(A.Zb,{className:"border-border/60",children:[(0,t.jsxs)(A.Ol,{className:"pb-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)(A.ll,{className:"text-xl font-semibold flex items-center gap-2",children:[(0,t.jsx)(w.Z,{className:"w-5 h-5 text-[#1672d6]"}),"Clientes Ativos"]}),(0,t.jsx)(S.default,{href:"/admin/clientes",children:(0,t.jsxs)(O.z,{variant:"ghost",size:"sm",className:"text-[#1672d6]",children:["Ver todos",(0,t.jsx)(g.Z,{className:"w-4 h-4 ml-1"})]})})]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Clique no nome do cliente para ver detalhes"})]}),(0,t.jsx)(A.aY,{children:(0,t.jsx)("div",{className:"space-y-3",children:H.map(e=>(0,t.jsxs)(i.E.button,{onClick:()=>K(e),whileHover:{x:4,backgroundColor:"rgba(22, 114, 214, 0.05)"},className:"w-full flex items-center justify-between p-4 rounded-xl border border-border/60 bg-card hover:border-[#1672d6]/40 transition-all text-left",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(T.qE,{className:"h-10 w-10 border-2 border-[#1672d6]/20",children:(0,t.jsx)(T.Q5,{className:"bg-[#1672d6]/10 text-[#1672d6] font-semibold",children:e.name.split(" ").map(e=>e[0]).join("")})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold text-foreground",children:e.name}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:e.company})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("div",{className:"text-right hidden sm:block",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-foreground",children:e.projectStatus}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Pr\xf3x. entrega: ",e.nextDelivery]})]}),(0,t.jsx)(_.C,{className:(0,P.cn)("border",W(e.status)),children:$(e.status)}),(0,t.jsx)(g.Z,{className:"w-5 h-5 text-muted-foreground"})]})]},e.id))})})]})}),(0,t.jsx)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},children:(0,t.jsx)(A.Zb,{className:"border-border/60 overflow-hidden",children:(0,t.jsx)(V.Z,{title:"Central de Integra\xe7\xf5es",subtitle:"Gerencie todas as conex\xf5es do ecossistema Valle 360"})})})]}),(0,t.jsx)(l.M,{children:Y&&B&&(0,t.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4",onClick:()=>F(!1),children:(0,t.jsxs)(i.E.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},onClick:e=>e.stopPropagation(),className:"bg-white dark:bg-[#0a0f1a] rounded-2xl w-full max-w-lg shadow-2xl border border-border/60",children:[(0,t.jsx)("div",{className:"p-6 border-b border-border/60",children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(T.qE,{className:"h-14 w-14 border-2 border-[#1672d6]/30",children:(0,t.jsx)(T.Q5,{className:"bg-[#1672d6] text-white text-lg font-bold",children:B.name.split(" ").map(e=>e[0]).join("")})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-foreground",children:B.name}),(0,t.jsx)("p",{className:"text-muted-foreground",children:B.company}),(0,t.jsx)(_.C,{className:(0,P.cn)("mt-2 border",W(B.status)),children:$(B.status)})]})]}),(0,t.jsx)("button",{onClick:()=>F(!1),className:"p-2 hover:bg-muted rounded-lg transition-colors",children:(0,t.jsx)(C.Z,{className:"w-5 h-5"})})]})}),(0,t.jsxs)("div",{className:"p-6 space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-muted/50",children:[(0,t.jsx)(Z.Z,{className:"w-4 h-4 text-[#1672d6]"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"E-mail"}),(0,t.jsx)("p",{className:"text-sm font-medium",children:B.email})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-muted/50",children:[(0,t.jsx)(k.Z,{className:"w-4 h-4 text-[#1672d6]"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Telefone"}),(0,t.jsx)("p",{className:"text-sm font-medium",children:B.phone})]})]})]}),(0,t.jsxs)("div",{className:"p-4 rounded-xl border border-border/60 bg-card",children:[(0,t.jsxs)("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[(0,t.jsx)(h.Z,{className:"w-4 h-4 text-[#1672d6]"}),"Status do Projeto"]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Status"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:B.projectStatus})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Pr\xf3xima Entrega"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:B.nextDelivery})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Valor Contratado"}),(0,t.jsx)("span",{className:"text-sm font-bold text-[#1672d6]",children:B.contractValue})]})]})]}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)(S.default,{href:"/admin/clientes?id=".concat(B.id),className:"flex-1",children:(0,t.jsxs)(O.z,{variant:"outline",className:"w-full",children:[(0,t.jsx)(E.Z,{className:"w-4 h-4 mr-2"}),"Ver Perfil Completo"]})}),(0,t.jsxs)(O.z,{className:"flex-1 bg-[#1672d6] hover:bg-[#1672d6]/90",children:[(0,t.jsx)(I.Z,{className:"w-4 h-4 mr-2"}),"Enviar Mensagem"]})]})]})]})})})]})}},5526:function(e,s,a){"use strict";a.r(s),a.d(s,{supabase:function(){return l}});var t=a(62724);let r="https://ikjgsqtykkhqimypacro.supabase.co",i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlramdzcXR5a2tocWlteXBhY3JvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMyMTE4OTksImV4cCI6MjA3ODc4Nzg5OX0.vgVCpFIt-5ajFhcXg65dqrEw915pqW8fGZ8xgJxrnxI";r&&i||console.error("❌ ERRO CR\xcdTICO: Vari\xe1veis de ambiente NEXT_PUBLIC_SUPABASE_URL ou NEXT_PUBLIC_SUPABASE_ANON_KEY n\xe3o encontradas!");let l=(0,t.eI)(r||"https://setup-missing.supabase.co",i||"setup-missing",{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}})},13337:function(e,s,a){"use strict";async function t(e,s){try{await fetch("/api/telemetry",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,level:(null==s?void 0:s.level)||"info",message:null==s?void 0:s.message,data:null==s?void 0:s.data,path:null==s?void 0:s.path,requestId:null==s?void 0:s.requestId,ts:new Date().toISOString()})})}catch(e){}}a.d(s,{L:function(){return t}})}},function(e){e.O(0,[2882,6137,4609,2724,4438,2972,3281,4641,4900,2971,2117,1744],function(){return e(e.s=70059)}),_N_E=e.O()}]);