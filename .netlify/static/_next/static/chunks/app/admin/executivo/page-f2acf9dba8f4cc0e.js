(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1329],{59099:function(e,t,a){Promise.resolve().then(a.bind(a,14307))},79205:function(e,t,a){"use strict";a.d(t,{Z:function(){return u}});var r=a(2265);let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),n=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase()),l=e=>{let t=n(e);return t.charAt(0).toUpperCase()+t.slice(1)},i=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim()},c=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let d=(0,r.forwardRef)((e,t)=>{let{color:a="currentColor",size:s=24,strokeWidth:n=2,absoluteStrokeWidth:l,className:d="",children:u,iconNode:h,...x}=e;return(0,r.createElement)("svg",{ref:t,...o,width:s,height:s,stroke:a,strokeWidth:l?24*Number(n)/Number(s):n,className:i("lucide",d),...!u&&!c(x)&&{"aria-hidden":"true"},...x},[...h.map(e=>{let[t,a]=e;return(0,r.createElement)(t,a)}),...Array.isArray(u)?u:[u]])}),u=(e,t)=>{let a=(0,r.forwardRef)((a,n)=>{let{className:c,...o}=a;return(0,r.createElement)(d,{ref:n,iconNode:t,className:i("lucide-".concat(s(l(e))),"lucide-".concat(e),c),...o})});return a.displayName=l(e),a}},64972:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(79205).Z)("brain",[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]])},96215:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(79205).Z)("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]])},82431:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(79205).Z)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},11239:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(79205).Z)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]])},27648:function(e,t,a){"use strict";a.d(t,{default:function(){return s.a}});var r=a(72972),s=a.n(r)},14307:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return v}});var r=a(57437),s=a(2265),n=a(27648),l=a(96215),i=a(82431);let c=(0,a(79205).Z)("shield-alert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);var o=a(64972),d=a(11239),u=a(79820),h=a(69174),x=a(12381),m=a(5526),f=a(14438);function v(){var e,t,a,v;let[p,g]=(0,s.useState)(!0),[b,j]=(0,s.useState)(null),y=async()=>{try{var e;let{data:t}=await m.supabase.auth.getSession(),a=null===(e=t.session)||void 0===e?void 0:e.access_token;return a?{Authorization:"Bearer ".concat(a)}:{}}catch(e){return{}}},N=async()=>{g(!0);try{let e=await y(),t=await fetch("/api/admin/executive/summary",{headers:e}),a=await t.json().catch(()=>null);if(!t.ok||!(null==a?void 0:a.success))throw Error((null==a?void 0:a.error)||"Falha ao carregar resumo executivo");j(a)}catch(e){f.Am.error((null==e?void 0:e.message)||"Falha ao carregar resumo executivo"),j(null)}finally{g(!1)}},w=async(e,t)=>{try{let a=await y(),r=await fetch(e,{method:"POST",headers:a}),s=await r.json().catch(()=>null);if(!r.ok)throw Error((null==s?void 0:s.error)||"Falha ao executar ".concat(t));f.Am.success("".concat(t," executado.")),await N()}catch(e){f.Am.error((null==e?void 0:e.message)||"Falha ao executar ".concat(t))}};(0,s.useEffect)(()=>{N()},[]);let k=null==b?void 0:b.kpis,C=(0,s.useMemo)(()=>((null==b?void 0:b.highlights)||[]).slice(0,6),[b]);return(0,r.jsx)("div",{className:"min-h-screen p-6",style:{backgroundColor:"var(--bg-secondary)"},children:(0,r.jsxs)("div",{className:"max-w-6xl mx-auto space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-12 h-12 rounded-2xl bg-gradient-to-br from-[#1672d6] to-[#001533] flex items-center justify-center",children:(0,r.jsx)(l.Z,{className:"w-6 h-6 text-white"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-[#001533] dark:text-white",children:"Executivo"}),(0,r.jsx)("p",{className:"text-sm",style:{color:"var(--text-secondary)"},children:"Snapshot unificado (complementar): KPIs + principais sinais do ML/preditivo."})]})]}),(0,r.jsx)("div",{className:"flex items-center gap-2",children:(0,r.jsxs)(x.z,{variant:"outline",onClick:()=>N(),disabled:p,className:"gap-2",children:[(0,r.jsx)(i.Z,{className:p?"w-4 h-4 animate-spin":"w-4 h-4"}),"Atualizar"]})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,r.jsxs)(u.Zb,{children:[(0,r.jsx)(u.Ol,{children:(0,r.jsx)(u.ll,{className:"text-sm",children:"Clientes"})}),(0,r.jsxs)(u.aY,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:k?k.totalClients:"—"}),(0,r.jsx)("div",{className:"text-xs text-gray-600",children:k?"".concat(k.activeClients," ativos"):""})]})]}),(0,r.jsxs)(u.Zb,{children:[(0,r.jsx)(u.Ol,{children:(0,r.jsx)(u.ll,{className:"text-sm",children:"MRR"})}),(0,r.jsxs)(u.aY,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:k?"R$ ".concat(k.mrr.toLocaleString("pt-BR")):"—"}),(0,r.jsx)("div",{className:"text-xs text-gray-600",children:"Contratos ativos"})]})]}),(0,r.jsxs)(u.Zb,{children:[(0,r.jsx)(u.Ol,{children:(0,r.jsx)(u.ll,{className:"text-sm",children:"Faturas pendentes"})}),(0,r.jsxs)(u.aY,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:k?k.pendingInvoices:"—"}),(0,r.jsx)("div",{className:"text-xs text-gray-600",children:"N\xe3o pagas"})]})]}),(0,r.jsxs)(u.Zb,{children:[(0,r.jsx)(u.Ol,{children:(0,r.jsx)(u.ll,{className:"text-sm",children:"Acesso r\xe1pido"})}),(0,r.jsxs)(u.aY,{className:"flex flex-wrap gap-2",children:[(0,r.jsx)(n.default,{href:(null==b?void 0:null===(e=b.links)||void 0===e?void 0:e.analytics)||"/admin/analytics/preditivo",className:"text-sm text-blue-700 hover:underline",children:"Analytics Preditivo"}),(0,r.jsx)("span",{className:"text-gray-300",children:"•"}),(0,r.jsx)(n.default,{href:(null==b?void 0:null===(t=b.links)||void 0===t?void 0:t.intelligence)||"/admin/centro-inteligencia",className:"text-sm text-blue-700 hover:underline",children:"Centro de Intelig\xeancia"}),(0,r.jsx)("span",{className:"text-gray-300",children:"•"}),(0,r.jsx)(n.default,{href:(null==b?void 0:null===(a=b.links)||void 0===a?void 0:a.billing)||"/admin/financeiro/clientes",className:"text-sm text-blue-700 hover:underline",children:"Cobran\xe7as"}),(0,r.jsx)("span",{className:"text-gray-300",children:"•"}),(0,r.jsx)(n.default,{href:(null==b?void 0:null===(v=b.links)||void 0===v?void 0:v.machineLearning)||"/admin/machine-learning",className:"text-sm text-blue-700 hover:underline",children:"Machine Learning"})]})]})]}),(0,r.jsxs)(u.Zb,{children:[(0,r.jsxs)(u.Ol,{className:"flex flex-row items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(c,{className:"w-5 h-5 text-[#1672d6]"}),(0,r.jsx)(u.ll,{className:"text-base",children:"Sinais principais (top)"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)(x.z,{variant:"outline",onClick:()=>w("/api/cron/ml","ML"),className:"gap-2",children:[(0,r.jsx)(o.Z,{className:"w-4 h-4"})," Rodar ML agora"]}),(0,r.jsxs)(x.z,{variant:"outline",onClick:()=>w("/api/cron/alerts","Alertas"),className:"gap-2",children:[(0,r.jsx)(d.Z,{className:"w-4 h-4"})," Rodar alertas agora"]})]})]}),(0,r.jsx)(u.aY,{children:p?(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"Carregando…"}):C.length?(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:C.map(e=>(0,r.jsx)(n.default,{href:e.href,className:"block",children:(0,r.jsxs)("div",{className:"rounded-xl border p-4 hover:bg-gray-50 transition",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,r.jsx)("div",{className:"text-sm font-semibold text-gray-900",children:e.label}),(0,r.jsx)(h.C,{children:e.type})]}),(0,r.jsx)("div",{className:"mt-2 text-2xl font-bold text-[#001533]",children:"number"==typeof e.value?"".concat(Math.round(e.value),"%"):"—"}),(0,r.jsxs)("div",{className:"text-xs text-gray-600 mt-1",children:["Confian\xe7a: ",e.confidence,"%"]})]})},e.id))}):(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"Ainda sem predi\xe7\xf5es suficientes neste ambiente. Rode o ML acima para preencher o log."})})]})]})})}},69174:function(e,t,a){"use strict";a.d(t,{C:function(){return i}});var r=a(57437);a(2265);var s=a(90535),n=a(93448);let l=(0,s.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-valle-blue-600 text-white",secondary:"border-transparent bg-valle-silver-300 text-valle-navy-800",outline:"text-valle-navy-700 border-valle-silver-400",success:"border-transparent bg-green-600 text-white",warning:"border-transparent bg-yellow-600 text-white",danger:"border-transparent bg-red-600 text-white"}},defaultVariants:{variant:"default"}});function i(e){let{className:t,variant:a,...s}=e;return(0,r.jsx)("div",{className:(0,n.cn)(l({variant:a}),t),...s})}},12381:function(e,t,a){"use strict";a.d(t,{z:function(){return c}});var r=a(57437),s=a(2265),n=a(90535),l=a(93448);let i=(0,n.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-lg text-sm font-medium transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-valle-blue-600 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-gradient-to-r from-valle-blue-600 to-valle-blue-700 text-white hover:from-valle-blue-700 hover:to-valle-blue-800 shadow-lg",secondary:"bg-valle-silver-200 text-valle-navy-800 hover:bg-valle-silver-300",outline:"border-2 border-valle-blue-600 text-valle-blue-600 hover:bg-valle-blue-50",ghost:"hover:bg-valle-blue-50 hover:text-valle-blue-600",danger:"bg-red-600 text-white hover:bg-red-700"},size:{default:"h-10 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-12 rounded-lg px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=s.forwardRef((e,t)=>{let{className:a,variant:s,size:n,...c}=e;return(0,r.jsx)("button",{className:(0,l.cn)(i({variant:s,size:n,className:a})),ref:t,...c})});c.displayName="Button"},79820:function(e,t,a){"use strict";a.d(t,{Ol:function(){return i},SZ:function(){return o},Zb:function(){return l},aY:function(){return d},ll:function(){return c}});var r=a(57437),s=a(2265),n=a(93448);let l=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("rounded-xl border-2 border-valle-silver-200 bg-white shadow-md",a),...s})});l.displayName="Card";let i=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",a),...s})});i.displayName="CardHeader";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("h3",{ref:t,className:(0,n.cn)("font-semibold leading-none tracking-tight text-lg",a),...s})});c.displayName="CardTitle";let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-foreground/70",a),...s})});o.displayName="CardDescription";let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",a),...s})});d.displayName="CardContent",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",a),...s})}).displayName="CardFooter"},5526:function(e,t,a){"use strict";a.r(t),a.d(t,{supabase:function(){return l}});var r=a(62724);let s="https://ikjgsqtykkhqimypacro.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlramdzcXR5a2tocWlteXBhY3JvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMyMTE4OTksImV4cCI6MjA3ODc4Nzg5OX0.vgVCpFIt-5ajFhcXg65dqrEw915pqW8fGZ8xgJxrnxI";s&&n||console.error("❌ ERRO CR\xcdTICO: Vari\xe1veis de ambiente NEXT_PUBLIC_SUPABASE_URL ou NEXT_PUBLIC_SUPABASE_ANON_KEY n\xe3o encontradas!");let l=(0,r.eI)(s||"https://setup-missing.supabase.co",n||"setup-missing",{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}})},93448:function(e,t,a){"use strict";a.d(t,{cn:function(){return n},x:function(){return l}});var r=a(61994),s=a(53335);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.m6)((0,r.W)(t))}function l(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}},90535:function(e,t,a){"use strict";a.d(t,{j:function(){return l}});var r=a(61994);let s=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,n=r.W,l=(e,t)=>a=>{var r;if((null==t?void 0:t.variants)==null)return n(e,null==a?void 0:a.class,null==a?void 0:a.className);let{variants:l,defaultVariants:i}=t,c=Object.keys(l).map(e=>{let t=null==a?void 0:a[e],r=null==i?void 0:i[e];if(null===t)return null;let n=s(t)||s(r);return l[e][n]}),o=a&&Object.entries(a).reduce((e,t)=>{let[a,r]=t;return void 0===r||(e[a]=r),e},{});return n(e,c,null==t?void 0:null===(r=t.compoundVariants)||void 0===r?void 0:r.reduce((e,t)=>{let{class:a,className:r,...s}=t;return Object.entries(s).every(e=>{let[t,a]=e;return Array.isArray(a)?a.includes({...i,...o}[t]):({...i,...o})[t]===a})?[...e,a,r]:e},[]),null==a?void 0:a.class,null==a?void 0:a.className)}}},function(e){e.O(0,[6137,4609,2724,4438,2972,2971,2117,1744],function(){return e(e.s=59099)}),_N_E=e.O()}]);