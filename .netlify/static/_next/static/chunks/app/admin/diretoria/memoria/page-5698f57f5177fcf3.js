(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4492],{74791:function(e,r,a){Promise.resolve().then(a.bind(a,53779))},53779:function(e,r,a){"use strict";a.r(r),a.d(r,{default:function(){return u}});var l=a(57437),o=a(2265),t=a(27648),s=a(71769),n=a(82431),i=a(98420),c=a(83229),d=a(18930),x=a(14438),m=a(98702);function u(){let[e,r]=(0,o.useState)(!0),[a,u]=(0,o.useState)([]),[v,y]=(0,o.useState)("all"),[p,b]=(0,o.useState)(""),[h,g]=(0,o.useState)(""),[f,j]=(0,o.useState)(""),[N,C]=(0,o.useState)("ceo"),[w,k]=(0,o.useState)("policy"),[S,E]=(0,o.useState)(""),[F,_]=(0,o.useState)("general"),[A,M]=(0,o.useState)(""),[O,T]=(0,o.useState)("0.85"),[Z,z]=(0,o.useState)('{\n  "text": ""\n}'),[B,L]=(0,o.useState)(null),[J,D]=(0,o.useState)(null),R=(0,o.useMemo)(()=>{let e=new Map;for(let o of a){var r,l;let a=String((null==o?void 0:null===(r=o.executive)||void 0===r?void 0:r.role)||"").toLowerCase(),t=String((null==o?void 0:null===(l=o.executive)||void 0===l?void 0:l.name)||"");a&&e.set(a,t)}let o=Array.from(e.entries()).map(e=>{let[r,a]=e;return{value:r,label:"".concat(r.toUpperCase()).concat(a?" — ".concat(a):"")}});return o.sort((e,r)=>e.label.localeCompare(r.label)),[{value:"all",label:"Todos"},...o]},[a]),U=async()=>{r(!0);try{let e=new URLSearchParams;e.set("limit","60"),"all"!==v&&e.set("role",v),p.trim()&&e.set("q",p.trim()),h.trim()&&e.set("knowledge_type",h.trim()),f.trim()&&e.set("category",f.trim());let r=await fetch("/api/admin/csuite/knowledge?".concat(e.toString()),{method:"GET"}),a=await r.json();u(Array.isArray(null==a?void 0:a.items)?a.items:[])}catch(e){x.Am.error(String((null==e?void 0:e.message)||"Falha ao carregar")),u([])}finally{r(!1)}};(0,o.useEffect)(()=>{U()},[]);let V=async()=>{let e;let r=S.trim();if(!r)return x.Am.error("Key \xe9 obrigat\xf3rio");try{e=JSON.parse(Z)}catch(e){return x.Am.error("Value precisa ser um JSON v\xe1lido")}let a=Number(O);if(!Number.isFinite(a)||a<0||a>1)return x.Am.error("Confidence deve ser entre 0 e 1 (ex.: 0.85)");D("save");try{let l=await fetch("/api/admin/csuite/knowledge",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({role:N,knowledge_type:w,category:F||null,key:r,value:e,confidence:a,source:A||null})}),o=await l.json();if(!l.ok||!(null==o?void 0:o.success))throw Error((null==o?void 0:o.error)||"Falha ao salvar");x.Am.success("Salvo."),E(""),z('{\n  "text": ""\n}'),await U()}catch(e){x.Am.error(String((null==e?void 0:e.message)||"Falha ao salvar"))}finally{D(null)}},q=e=>L({open:!0,id:e}),P=async()=>{let e=null==B?void 0:B.id;if(e){D(e);try{let r=await fetch("/api/admin/csuite/knowledge/".concat(e),{method:"DELETE"}),a=await r.json();if(!r.ok||!(null==a?void 0:a.success))throw Error((null==a?void 0:a.error)||"Falha ao excluir");x.Am.success("Exclu\xeddo."),await U()}catch(e){x.Am.error(String((null==e?void 0:e.message)||"Falha ao excluir"))}finally{D(null),L(null)}}};return(0,l.jsxs)("div",{className:"min-h-screen p-6",style:{backgroundColor:"var(--bg-secondary)"},children:[(0,l.jsxs)("div",{className:"max-w-6xl mx-auto space-y-6",children:[(0,l.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"w-12 h-12 rounded-2xl bg-gradient-to-br from-[#1672d6] to-[#001533] flex items-center justify-center",children:(0,l.jsx)(s.Z,{className:"w-6 h-6 text-white"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-bold",style:{color:"var(--text-primary)"},children:"Mem\xf3ria & Conhecimento (C‑Suite)"}),(0,l.jsx)("p",{className:"text-sm",style:{color:"var(--text-secondary)"},children:"Cadastre “regras”, “decis\xf5es” e “benchmarks” para os executivos reutilizarem em chats/insights."})]})]}),(0,l.jsx)("div",{className:"flex items-center gap-2",children:(0,l.jsxs)("button",{type:"button",onClick:()=>void U(),className:"px-3 py-2 rounded-xl border text-sm flex items-center gap-2 hover:opacity-90",style:{backgroundColor:"var(--bg-primary)",borderColor:"var(--border-light)",color:"var(--text-primary)"},children:[(0,l.jsx)(n.Z,{className:"w-4 h-4 ".concat(e?"animate-spin":"")}),"Atualizar"]})})]}),(0,l.jsx)("div",{className:"flex items-center gap-3 text-sm",children:(0,l.jsx)(t.default,{className:"underline",href:"/admin/diretoria",children:(0,l.jsxs)("span",{className:"inline-flex items-center gap-2",style:{color:"var(--text-primary)"},children:[(0,l.jsx)(i.Z,{className:"w-4 h-4"})," Voltar para Diretoria"]})})}),(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[(0,l.jsxs)("div",{className:"p-5 rounded-2xl border",style:{backgroundColor:"var(--bg-primary)",borderColor:"var(--border-light)"},children:[(0,l.jsx)("h2",{className:"font-semibold mb-3",style:{color:"var(--text-primary)"},children:"Novo item"}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-xs",style:{color:"var(--text-secondary)"},children:"Executivo"}),(0,l.jsx)("select",{className:"mt-1 w-full px-3 py-2 rounded-xl border text-sm",style:{backgroundColor:"var(--bg-secondary)",borderColor:"var(--border-light)",color:"var(--text-primary)"},value:N,onChange:e=>C(e.target.value),children:["ceo","cfo","cmo","cto","coo","cco","chro"].map(e=>(0,l.jsx)("option",{value:e,children:e.toUpperCase()},e))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-xs",style:{color:"var(--text-secondary)"},children:"Tipo"}),(0,l.jsx)("select",{className:"mt-1 w-full px-3 py-2 rounded-xl border text-sm",style:{backgroundColor:"var(--bg-secondary)",borderColor:"var(--border-light)",color:"var(--text-primary)"},value:w,onChange:e=>k(e.target.value),children:["policy","decision","benchmark","playbook","note"].map(e=>(0,l.jsx)("option",{value:e,children:e},e))})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-xs",style:{color:"var(--text-secondary)"},children:"Key (\xfanica por executivo + tipo)"}),(0,l.jsx)("input",{className:"mt-1 w-full px-3 py-2 rounded-xl border text-sm",style:{backgroundColor:"var(--bg-secondary)",borderColor:"var(--border-light)",color:"var(--text-primary)"},value:S,onChange:e=>E(e.target.value),placeholder:"ex: pricing_policy_v1"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-xs",style:{color:"var(--text-secondary)"},children:"Categoria"}),(0,l.jsx)("input",{className:"mt-1 w-full px-3 py-2 rounded-xl border text-sm",style:{backgroundColor:"var(--bg-secondary)",borderColor:"var(--border-light)",color:"var(--text-primary)"},value:F,onChange:e=>_(e.target.value),placeholder:"financial/marketing/..."})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-xs",style:{color:"var(--text-secondary)"},children:"Confian\xe7a (0–1)"}),(0,l.jsx)("input",{className:"mt-1 w-full px-3 py-2 rounded-xl border text-sm",style:{backgroundColor:"var(--bg-secondary)",borderColor:"var(--border-light)",color:"var(--text-primary)"},value:O,onChange:e=>T(e.target.value),placeholder:"0.85"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-xs",style:{color:"var(--text-secondary)"},children:"Fonte (opcional)"}),(0,l.jsx)("input",{className:"mt-1 w-full px-3 py-2 rounded-xl border text-sm",style:{backgroundColor:"var(--bg-secondary)",borderColor:"var(--border-light)",color:"var(--text-primary)"},value:A,onChange:e=>M(e.target.value),placeholder:"ex: decis\xe3o em reuni\xe3o 2026-01-08"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-xs",style:{color:"var(--text-secondary)"},children:"Value (JSON)"}),(0,l.jsx)("textarea",{className:"mt-1 w-full px-3 py-2 rounded-xl border text-xs min-h-[160px]",style:{backgroundColor:"var(--bg-secondary)",borderColor:"var(--border-light)",color:"var(--text-primary)",fontFamily:"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace"},value:Z,onChange:e=>z(e.target.value)})]}),(0,l.jsxs)("button",{type:"button",onClick:()=>void V(),disabled:"save"===J,className:"w-full px-4 py-2.5 rounded-xl border text-sm font-medium flex items-center justify-center gap-2 hover:opacity-90 disabled:opacity-60",style:{backgroundColor:"var(--bg-primary)",borderColor:"var(--border-light)",color:"var(--text-primary)"},children:[(0,l.jsx)(c.Z,{className:"w-4 h-4"}),"save"===J?"Salvando...":"Salvar"]})]})]}),(0,l.jsxs)("div",{className:"lg:col-span-2 p-5 rounded-2xl border",style:{backgroundColor:"var(--bg-primary)",borderColor:"var(--border-light)"},children:[(0,l.jsxs)("div",{className:"flex items-start justify-between gap-3 mb-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"font-semibold",style:{color:"var(--text-primary)"},children:"Itens cadastrados"}),(0,l.jsxs)("p",{className:"text-xs",style:{color:"var(--text-secondary)"},children:[a.length," itens"]})]}),(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,l.jsx)("select",{className:"px-3 py-2 rounded-xl border text-sm",style:{backgroundColor:"var(--bg-secondary)",borderColor:"var(--border-light)",color:"var(--text-primary)"},value:v,onChange:e=>y(e.target.value),children:R.map(e=>(0,l.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,l.jsx)("input",{className:"px-3 py-2 rounded-xl border text-sm",style:{backgroundColor:"var(--bg-secondary)",borderColor:"var(--border-light)",color:"var(--text-primary)"},value:h,onChange:e=>g(e.target.value),placeholder:"knowledge_type (ex: policy)"}),(0,l.jsx)("input",{className:"px-3 py-2 rounded-xl border text-sm",style:{backgroundColor:"var(--bg-secondary)",borderColor:"var(--border-light)",color:"var(--text-primary)"},value:f,onChange:e=>j(e.target.value),placeholder:"categoria (ex: financial)"}),(0,l.jsx)("input",{className:"px-3 py-2 rounded-xl border text-sm",style:{backgroundColor:"var(--bg-secondary)",borderColor:"var(--border-light)",color:"var(--text-primary)"},value:p,onChange:e=>b(e.target.value),placeholder:"buscar por key/categoria..."}),(0,l.jsx)("button",{type:"button",onClick:()=>void U(),className:"px-3 py-2 rounded-xl border text-sm hover:opacity-90",style:{backgroundColor:"var(--bg-secondary)",borderColor:"var(--border-light)",color:"var(--text-primary)"},children:"Filtrar"})]})]}),(0,l.jsxs)("div",{className:"space-y-3",children:[a.slice(0,60).map(e=>{var r,a,o;return(0,l.jsxs)("div",{className:"p-4 rounded-2xl border",style:{borderColor:"var(--border-light)",backgroundColor:"var(--bg-secondary)"},children:[(0,l.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,l.jsxs)("div",{className:"min-w-0",children:[(0,l.jsxs)("p",{className:"text-sm font-semibold truncate",style:{color:"var(--text-primary)"},children:[(null===(r=e.executive)||void 0===r?void 0:r.role)?String(e.executive.role).toUpperCase():"C‑Suite"," • ",e.knowledge_type," • ",(0,l.jsx)("span",{className:"font-mono",children:e.key})]}),(0,l.jsxs)("p",{className:"text-xs mt-1",style:{color:"var(--text-secondary)"},children:[e.category||"sem categoria"," • conf: ",null!==(a=e.confidence)&&void 0!==a?a:"—"," • usos: ",Number(e.times_referenced||0)," • ",function(e){if(!e)return"";try{return new Date(e).toLocaleString("pt-BR")}catch(r){return String(e)}}(e.updated_at||e.created_at||null),e.source?" • fonte: ".concat(e.source):""]})]}),(0,l.jsxs)("button",{type:"button",disabled:J===e.id,onClick:()=>q(e.id),className:"px-3 py-2 rounded-xl border text-sm hover:opacity-90 disabled:opacity-60 flex items-center gap-2",style:{backgroundColor:"var(--bg-primary)",borderColor:"var(--border-light)",color:"var(--text-primary)"},title:"Excluir",children:[(0,l.jsx)(d.Z,{className:"w-4 h-4"}),"Excluir"]})]}),(0,l.jsx)("pre",{className:"mt-3 text-xs whitespace-pre-wrap break-words",style:{color:"var(--text-secondary)",fontFamily:"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace"},children:JSON.stringify(null!==(o=e.value)&&void 0!==o?o:{},null,2)})]},e.id)}),e||0!==a.length?null:(0,l.jsx)("p",{className:"text-sm",style:{color:"var(--text-secondary)"},children:"Sem itens ainda."})]})]})]})]}),(0,l.jsx)(m.sm,{isOpen:!!(null==B?void 0:B.open),onClose:()=>L(null),onConfirm:P,title:"Excluir item",message:"Tem certeza que deseja excluir este item de conhecimento?",confirmText:"Excluir",cancelText:"Voltar",variant:"danger",loading:!!((null==B?void 0:B.id)&&J===B.id)})]})}},98702:function(e,r,a){"use strict";a.d(r,{sm:function(){return v}});var l=a(57437),o=a(2265),t=a(57586),s=a(26892),n=a(32489),i=a(76865),c=a(33245),d=a(41671);let x={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl",full:"max-w-4xl"};function m(e){let{isOpen:r,onClose:a,title:i,description:c,children:d,size:m="md",showCloseButton:u=!0,closeOnBackdrop:v=!0,closeOnEscape:y=!0,footer:p}=e;return(0,o.useEffect)(()=>{if(!y)return;let e=e=>{"Escape"===e.key&&r&&a()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[r,a,y]),(0,o.useEffect)(()=>(r?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[r]),(0,l.jsx)(t.M,{children:r&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:v?a:void 0,className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50"}),(0,l.jsxs)(s.E.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-full ".concat(x[m]," max-h-[90vh] overflow-auto rounded-2xl shadow-2xl z-50"),style:{backgroundColor:"var(--bg-primary)"},children:[(i||u)&&(0,l.jsxs)("div",{className:"flex items-start justify-between p-6 border-b",style:{borderColor:"var(--border-light)"},children:[(0,l.jsxs)("div",{children:[i&&(0,l.jsx)("h2",{className:"text-lg font-semibold",style:{color:"var(--text-primary)"},children:i}),c&&(0,l.jsx)("p",{className:"text-sm mt-1",style:{color:"var(--text-secondary)"},children:c})]}),u&&(0,l.jsx)("button",{onClick:a,className:"p-2 rounded-lg transition-colors -mr-2 -mt-2",style:{backgroundColor:"var(--bg-secondary)"},children:(0,l.jsx)(n.Z,{className:"w-5 h-5",style:{color:"var(--text-secondary)"}})})]}),(0,l.jsx)("div",{className:"p-6",children:d}),p&&(0,l.jsx)("div",{className:"flex items-center justify-end gap-3 p-6 border-t",style:{borderColor:"var(--border-light)"},children:p})]})]})})}let u={danger:{icon:(0,l.jsx)(i.Z,{className:"w-6 h-6"}),color:"#EF4444",bg:"#FEF2F2"},warning:{icon:(0,l.jsx)(i.Z,{className:"w-6 h-6"}),color:"#F59E0B",bg:"#FFFBEB"},info:{icon:(0,l.jsx)(c.Z,{className:"w-6 h-6"}),color:"#3B82F6",bg:"#EFF6FF"},success:{icon:(0,l.jsx)(d.Z,{className:"w-6 h-6"}),color:"#10B981",bg:"#ECFDF5"}};function v(e){let{isOpen:r,onClose:a,onConfirm:o,title:t="Confirmar a\xe7\xe3o",message:s="Tem certeza que deseja continuar?",confirmText:n="Confirmar",cancelText:i="Cancelar",variant:c="danger",loading:d=!1}=e,x=u[c];return(0,l.jsx)(m,{isOpen:r,onClose:a,size:"sm",showCloseButton:!1,children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"w-14 h-14 rounded-full mx-auto mb-4 flex items-center justify-center",style:{backgroundColor:x.bg,color:x.color},children:x.icon}),(0,l.jsx)("h3",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:t}),(0,l.jsx)("div",{className:"text-sm mb-6",style:{color:"var(--text-secondary)"},children:s}),(0,l.jsxs)("div",{className:"flex gap-3",children:[(0,l.jsx)("button",{onClick:a,disabled:d,className:"flex-1 px-4 py-2.5 rounded-xl font-medium transition-colors",style:{backgroundColor:"var(--bg-secondary)",color:"var(--text-primary)"},children:i}),(0,l.jsx)("button",{onClick:o,disabled:d,className:"flex-1 px-4 py-2.5 rounded-xl font-medium text-white transition-colors disabled:opacity-50",style:{backgroundColor:x.color},children:d?"Aguarde...":n})]})]})})}}},function(e){e.O(0,[2882,4438,2972,3308,2971,2117,1744],function(){return e(e.s=74791)}),_N_E=e.O()}]);