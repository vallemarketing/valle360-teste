(()=>{var e={};e.id=82936,e.ids=[82936],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},64168:(e,a,t)=>{"use strict";t.r(a),t.d(a,{GlobalError:()=>d.a,__next_app__:()=>u,originalPathname:()=>x,pages:()=>o,routeModule:()=>m,tree:()=>c}),t(10232),t(9457),t(49991),t(35866);var r=t(23191),s=t(88716),i=t(37922),d=t.n(i),l=t(95231),n={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>l[e]);t.d(a,n);let c=["",{children:["admin",{children:["feature-flags",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,10232)),"C:\\Users\\User\\Downloads\\valle-360-main\\valle-360-main\\src\\app\\admin\\feature-flags\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,9457)),"C:\\Users\\User\\Downloads\\valle-360-main\\valle-360-main\\src\\app\\admin\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,49991)),"C:\\Users\\User\\Downloads\\valle-360-main\\valle-360-main\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"]}],o=["C:\\Users\\User\\Downloads\\valle-360-main\\valle-360-main\\src\\app\\admin\\feature-flags\\page.tsx"],x="/admin/feature-flags/page",u={require:t,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/admin/feature-flags/page",pathname:"/admin/feature-flags",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},19380:(e,a,t)=>{Promise.resolve().then(t.bind(t,20688))},38787:(e,a,t)=>{"use strict";t.d(a,{Z:()=>r});let r=(0,t(62881).Z)("building",[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]])},7507:(e,a,t)=>{"use strict";t.d(a,{Z:()=>r});let r=(0,t(62881).Z)("chart-pie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]])},52952:(e,a,t)=>{"use strict";t.d(a,{Z:()=>r});let r=(0,t(62881).Z)("clipboard-check",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]])},48238:(e,a,t)=>{"use strict";t.d(a,{Z:()=>r});let r=(0,t(62881).Z)("clipboard-list",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]])},48998:(e,a,t)=>{"use strict";t.d(a,{Z:()=>r});let r=(0,t(62881).Z)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},26092:(e,a,t)=>{"use strict";t.d(a,{Z:()=>r});let r=(0,t(62881).Z)("crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]])},25880:(e,a,t)=>{"use strict";t.d(a,{Z:()=>r});let r=(0,t(62881).Z)("file-code",[["path",{d:"M10 12.5 8 15l2 2.5",key:"1tg20x"}],["path",{d:"m14 12.5 2 2.5-2 2.5",key:"yinavb"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}]])},92529:(e,a,t)=>{"use strict";t.d(a,{Z:()=>r});let r=(0,t(62881).Z)("file-pen-line",[["path",{d:"m18 5-2.414-2.414A2 2 0 0 0 14.172 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2",key:"142zxg"}],["path",{d:"M21.378 12.626a1 1 0 0 0-3.004-3.004l-4.01 4.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"2t3380"}],["path",{d:"M8 18h1",key:"13wk12"}]])},86645:(e,a,t)=>{"use strict";t.d(a,{Z:()=>r});let r=(0,t(62881).Z)("handshake",[["path",{d:"m11 17 2 2a1 1 0 1 0 3-3",key:"efffak"}],["path",{d:"m14 14 2.5 2.5a1 1 0 1 0 3-3l-3.88-3.88a3 3 0 0 0-4.24 0l-.88.88a1 1 0 1 1-3-3l2.81-2.81a5.79 5.79 0 0 1 7.06-.87l.47.28a2 2 0 0 0 1.42.25L21 4",key:"9pr0kb"}],["path",{d:"m21 3 1 11h-2",key:"1tisrp"}],["path",{d:"M3 3 2 14l6.5 6.5a1 1 0 1 0 3-3",key:"1uvwmv"}],["path",{d:"M3 4h8",key:"1ep09j"}]])},70717:(e,a,t)=>{"use strict";t.d(a,{Z:()=>r});let r=(0,t(62881).Z)("history",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]])},29798:(e,a,t)=>{"use strict";t.d(a,{Z:()=>r});let r=(0,t(62881).Z)("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]])},52351:(e,a,t)=>{"use strict";t.d(a,{Z:()=>r});let r=(0,t(62881).Z)("kanban",[["path",{d:"M5 3v14",key:"9nsxs2"}],["path",{d:"M12 3v8",key:"1h2ygw"}],["path",{d:"M19 3v18",key:"1sk56x"}]])},17129:(e,a,t)=>{"use strict";t.d(a,{Z:()=>r});let r=(0,t(62881).Z)("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]])},77506:(e,a,t)=>{"use strict";t.d(a,{Z:()=>r});let r=(0,t(62881).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},21405:(e,a,t)=>{"use strict";t.d(a,{Z:()=>r});let r=(0,t(62881).Z)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},58038:(e,a,t)=>{"use strict";t.d(a,{Z:()=>r});let r=(0,t(62881).Z)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},85571:(e,a,t)=>{"use strict";t.d(a,{Z:()=>r});let r=(0,t(62881).Z)("toggle-left",[["circle",{cx:"9",cy:"12",r:"3",key:"u3jwor"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]])},94909:(e,a,t)=>{"use strict";t.d(a,{Z:()=>r});let r=(0,t(62881).Z)("users-round",[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]])},99513:(e,a,t)=>{"use strict";t.d(a,{Z:()=>r});let r=(0,t(62881).Z)("workflow",[["rect",{width:"8",height:"8",x:"3",y:"3",rx:"2",key:"by2w9f"}],["path",{d:"M7 11v4a2 2 0 0 0 2 2h4",key:"xkn7yn"}],["rect",{width:"8",height:"8",x:"13",y:"13",rx:"2",key:"1cgmvn"}]])},20688:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>w});var r=t(10326),s=t(17577),i=t(28870),d=t(21405),l=t(85571),n=t(6507),c=t(24061),o=t(48998),x=t(36283),u=t(88307),m=t(39183),h=t(70717),g=t(32933),y=t(94019),p=t(1572),b=t(59734),f=t(51223),v=t(2777),j=t(42629);function w(){let[e,a]=(0,s.useState)("clients"),[t,w]=(0,s.useState)([]),[k,_]=(0,s.useState)([]),[N,Z]=(0,s.useState)([]),[M,q]=(0,s.useState)(null),[S,C]=(0,s.useState)([]),[O,E]=(0,s.useState)([]),[P,D]=(0,s.useState)([]),[z,U]=(0,s.useState)(""),[L,A]=(0,s.useState)(!0),[H,F]=(0,s.useState)(!1),[V,I]=(0,s.useState)(!1),B=async()=>{A(!0);try{let[e,a,t]=await Promise.all([(0,j.Cq)(),(0,j.UV)(),(0,j.oY)()]);w(e),_(a),E(t);let{data:r}=await v.O.from("clients").select("id, company_name, fantasy_name, cnpj, status").order("company_name");Z(r||[])}catch(e){console.error("Erro ao carregar dados:",e)}finally{A(!1)}},G=async e=>{q(e),C(await (0,j.zx)(e.id)),D(await (0,j.a8)(e.id))},R=async(e,a)=>{if(M){F(!0);try{let{data:{user:t}}=await v.O.auth.getUser();if(!t)return;(await (0,j.hX)(M.id,e,a,t.id,a?"Habilitado manualmente":"Desabilitado manualmente")).success&&await G(M)}catch(e){console.error("Erro ao alterar feature:",e)}finally{F(!1)}}},X=async e=>{F(!0);try{let{data:{user:a}}=await v.O.auth.getUser();if(!a)return;(await (0,j.o$)(e,a.id,"Aprovado")).success&&(await B(),M&&await G(M))}catch(e){console.error("Erro ao aprovar:",e)}finally{F(!1)}},$=async(e,a)=>{F(!0);try{let{data:{user:t}}=await v.O.auth.getUser();if(!t)return;(await (0,j.r5)(e,t.id,a||"N\xe3o aprovado")).success&&await B()}catch(e){console.error("Erro ao rejeitar:",e)}finally{F(!1)}},T=N.filter(e=>e.company_name?.toLowerCase().includes(z.toLowerCase())||e.fantasy_name?.toLowerCase().includes(z.toLowerCase())||e.cnpj?.includes(z));return L?r.jsx("div",{className:"min-h-screen flex items-center justify-center",style:{backgroundColor:"var(--bg-secondary)"},children:r.jsx(d.Z,{className:"w-8 h-8 animate-spin text-[#1672d6]"})}):r.jsx("div",{className:"min-h-screen p-6",style:{backgroundColor:"var(--bg-secondary)"},children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-14 h-14 rounded-2xl bg-gradient-to-br from-[#1672d6] to-[#001533] flex items-center justify-center",children:r.jsx(l.Z,{className:"w-7 h-7 text-white"})}),(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-[#001533] dark:text-white",children:"Feature Flags"}),r.jsx("p",{className:"text-gray-500",children:"Controle de funcionalidades por cliente"})]})]}),O.length>0&&(0,r.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2 bg-amber-100 text-amber-700 rounded-xl",children:[r.jsx(n.Z,{className:"w-5 h-5"}),(0,r.jsxs)("span",{className:"font-medium",children:[O.length," solicita\xe7\xf5es pendentes"]})]})]}),r.jsx("div",{className:"flex gap-2 border-b border-gray-200 dark:border-gray-700",children:[{id:"clients",label:"Por Cliente",icon:c.Z},{id:"requests",label:"Solicita\xe7\xf5es",icon:o.Z,badge:O.length},{id:"services",label:"Servi\xe7os x Features",icon:x.Z}].map(t=>(0,r.jsxs)("button",{onClick:()=>a(t.id),className:(0,f.cn)("flex items-center gap-2 px-4 py-3 font-medium transition-colors border-b-2 -mb-px",e===t.id?"border-[#1672d6] text-[#1672d6]":"border-transparent text-gray-500 hover:text-gray-700"),children:[r.jsx(t.icon,{className:"w-4 h-4"}),t.label,t.badge&&t.badge>0&&r.jsx("span",{className:"ml-1 px-2 py-0.5 text-xs bg-primary text-white rounded-full",children:t.badge})]},t.id))}),"clients"===e&&(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-6",children:[(0,r.jsxs)("div",{className:"col-span-1 bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[r.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:(0,r.jsxs)("div",{className:"relative",children:[r.jsx(u.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),r.jsx("input",{type:"text",placeholder:"Buscar cliente...",value:z,onChange:e=>U(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-200 dark:border-gray-600 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-[#1672d6]"})]})}),r.jsx("div",{className:"max-h-[600px] overflow-y-auto",children:T.map(e=>(0,r.jsxs)("button",{onClick:()=>G(e),className:(0,f.cn)("w-full flex items-center gap-3 p-4 text-left transition-colors border-b border-gray-100 dark:border-gray-700",M?.id===e.id?"bg-[#1672d6]/10":"hover:bg-gray-50 dark:hover:bg-gray-700"),children:[r.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-[#1672d6] to-[#001533] flex items-center justify-center text-white font-bold",children:e.company_name?.charAt(0)||"C"}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:"font-medium text-gray-800 dark:text-white truncate",children:e.fantasy_name||e.company_name}),r.jsx("p",{className:"text-xs text-gray-500 truncate",children:e.cnpj})]}),r.jsx(m.Z,{className:"w-4 h-4 text-gray-400"})]},e.id))})]}),r.jsx("div",{className:"col-span-2",children:M?(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-700",children:[(0,r.jsxs)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("h2",{className:"text-lg font-bold text-gray-800 dark:text-white",children:M.fantasy_name||M.company_name}),r.jsx("p",{className:"text-sm text-gray-500",children:M.cnpj})]}),(0,r.jsxs)("button",{onClick:()=>I(!V),className:(0,f.cn)("flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm transition-colors",V?"bg-[#1672d6] text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:[r.jsx(h.Z,{className:"w-4 h-4"}),"Hist\xf3rico"]})]}),V?(0,r.jsxs)("div",{className:"p-4 max-h-[500px] overflow-y-auto",children:[r.jsx("h3",{className:"font-medium text-gray-700 dark:text-gray-300 mb-3",children:"\xdaltimas altera\xe7\xf5es"}),r.jsx("div",{className:"space-y-2",children:P.map(e=>(0,r.jsxs)("div",{className:"flex items-start gap-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[r.jsx("div",{className:(0,f.cn)("w-8 h-8 rounded-lg flex items-center justify-center","enabled"===e.action||"request_approved"===e.action?"bg-green-100 text-green-600":"disabled"===e.action||"request_rejected"===e.action?"bg-red-100 text-red-600":"bg-blue-100 text-blue-600"),children:"enabled"===e.action||"request_approved"===e.action?r.jsx(g.Z,{className:"w-4 h-4"}):"disabled"===e.action||"request_rejected"===e.action?r.jsx(y.Z,{className:"w-4 h-4"}):r.jsx(o.Z,{className:"w-4 h-4"})}),(0,r.jsxs)("div",{className:"flex-1",children:[r.jsx("p",{className:"text-sm font-medium text-gray-800 dark:text-white",children:e.feature_code}),(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:["enabled"===e.action&&"Habilitado","disabled"===e.action&&"Desabilitado","request_created"===e.action&&"Solicita\xe7\xe3o criada","request_approved"===e.action&&"Solicita\xe7\xe3o aprovada","request_rejected"===e.action&&"Solicita\xe7\xe3o rejeitada"," â€¢ ",new Date(e.created_at).toLocaleDateString("pt-BR")]}),e.reason&&r.jsx("p",{className:"text-xs text-gray-400 mt-1",children:e.reason})]})]},e.id))})]}):r.jsx("div",{className:"p-4 space-y-3",children:S.map(({feature:e,status:a,enabled_by:t})=>(0,r.jsxs)("div",{className:(0,f.cn)("flex items-center justify-between p-4 rounded-xl border transition-colors","enabled"===a?"bg-green-50 border-green-200 dark:bg-green-900/20 dark:border-green-800":"pending"===a?"bg-yellow-50 border-yellow-200 dark:bg-yellow-900/20 dark:border-yellow-800":"bg-gray-50 border-gray-200 dark:bg-gray-700 dark:border-gray-600"),children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:(0,f.cn)("w-10 h-10 rounded-xl flex items-center justify-center","enabled"===a?"bg-green-100 text-green-600":"pending"===a?"bg-yellow-100 text-yellow-600":"bg-gray-200 text-gray-500"),children:r.jsx(p.Z,{className:"w-5 h-5"})}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"font-medium text-gray-800 dark:text-white",children:e.name}),r.jsx("p",{className:"text-xs text-gray-500",children:e.description}),"enabled"===a&&t&&(0,r.jsxs)("span",{className:"inline-flex items-center gap-1 mt-1 px-2 py-0.5 bg-green-100 text-green-700 text-xs rounded-full",children:["contract"===t&&"Por contrato","manual"===t&&"Manual","request"===t&&"Por solicita\xe7\xe3o"]}),"pending"===a&&(0,r.jsxs)("span",{className:"inline-flex items-center gap-1 mt-1 px-2 py-0.5 bg-yellow-100 text-yellow-700 text-xs rounded-full",children:[r.jsx(o.Z,{className:"w-3 h-3"}),"Solicita\xe7\xe3o pendente"]})]})]}),r.jsx("button",{onClick:()=>R(e.code,"enabled"!==a),disabled:H,className:(0,f.cn)("relative w-14 h-7 rounded-full transition-colors","enabled"===a?"bg-green-500":"bg-gray-300"),children:r.jsx(i.E.div,{animate:{x:"enabled"===a?28:4},className:"absolute top-1 w-5 h-5 bg-white rounded-full shadow"})})]},e.id))})]}):(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-700 p-12 text-center",children:[r.jsx(b.Z,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),r.jsx("h3",{className:"text-lg font-medium text-gray-600 dark:text-gray-400",children:"Selecione um cliente"}),r.jsx("p",{className:"text-sm text-gray-400",children:"Escolha um cliente na lista para gerenciar suas funcionalidades"})]})})]}),"requests"===e&&(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-700",children:[(0,r.jsxs)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:[r.jsx("h2",{className:"text-lg font-bold text-gray-800 dark:text-white",children:"Solicita\xe7\xf5es Pendentes"}),r.jsx("p",{className:"text-sm text-gray-500",children:"Solicita\xe7\xf5es de libera\xe7\xe3o de features feitas pelo comercial"})]}),0===O.length?(0,r.jsxs)("div",{className:"p-12 text-center",children:[r.jsx(g.Z,{className:"w-16 h-16 mx-auto text-green-300 mb-4"}),r.jsx("h3",{className:"text-lg font-medium text-gray-600 dark:text-gray-400",children:"Nenhuma solicita\xe7\xe3o pendente"}),r.jsx("p",{className:"text-sm text-gray-400",children:"Todas as solicita\xe7\xf5es foram processadas"})]}):r.jsx("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:O.map(e=>r.jsx("div",{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex items-start gap-4",children:[r.jsx("div",{className:"w-12 h-12 rounded-xl bg-amber-100 flex items-center justify-center",children:r.jsx(o.Z,{className:"w-6 h-6 text-primary"})}),(0,r.jsxs)("div",{children:[r.jsx("h4",{className:"font-medium text-gray-800 dark:text-white",children:e.feature?.name||"Feature"}),(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:["Cliente ID: ",e.client_id]}),(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:["Solicitado por: ",e.requested_by_name]}),e.justification&&(0,r.jsxs)("p",{className:"text-sm text-gray-600 mt-2 p-2 bg-gray-50 rounded-lg",children:['"',e.justification,'"']}),r.jsx("p",{className:"text-xs text-gray-400 mt-2",children:new Date(e.created_at).toLocaleDateString("pt-BR",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})})]})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)("button",{onClick:()=>$(e.id,""),disabled:H,className:"flex items-center gap-2 px-4 py-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 transition-colors",children:[r.jsx(y.Z,{className:"w-4 h-4"}),"Rejeitar"]}),(0,r.jsxs)("button",{onClick:()=>X(e.id),disabled:H,className:"flex items-center gap-2 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors",children:[r.jsx(g.Z,{className:"w-4 h-4"}),"Aprovar"]})]})]})},e.id))})]}),"services"===e&&(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-700",children:[(0,r.jsxs)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:[r.jsx("h2",{className:"text-lg font-bold text-gray-800 dark:text-white",children:"Matriz Servi\xe7os x Features"}),r.jsx("p",{className:"text-sm text-gray-500",children:"Quais features cada servi\xe7o libera automaticamente"})]}),r.jsx("div",{className:"p-4 overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[r.jsx("thead",{children:(0,r.jsxs)("tr",{children:[r.jsx("th",{className:"text-left p-3 bg-gray-50 dark:bg-gray-700 rounded-tl-lg font-medium text-gray-600 dark:text-gray-300",children:"Servi\xe7o"}),t.map(e=>r.jsx("th",{className:"p-3 bg-gray-50 dark:bg-gray-700 text-center font-medium text-gray-600 dark:text-gray-300 text-xs",children:r.jsx("div",{className:"flex flex-col items-center gap-1",children:r.jsx("span",{children:e.name})})},e.id))]})}),r.jsx("tbody",{children:k.map(e=>(0,r.jsxs)("tr",{className:"border-t border-gray-100 dark:border-gray-700",children:[r.jsx("td",{className:"p-3",children:(0,r.jsxs)("div",{children:[r.jsx("p",{className:"font-medium text-gray-800 dark:text-white",children:e.name}),r.jsx("p",{className:"text-xs text-gray-500",children:e.description})]})}),t.map(a=>{let t=e.features?.some(e=>e.id===a.id);return r.jsx("td",{className:"p-3 text-center",children:t?r.jsx("div",{className:"w-6 h-6 mx-auto rounded-full bg-green-100 flex items-center justify-center",children:r.jsx(g.Z,{className:"w-4 h-4 text-green-600"})}):r.jsx("div",{className:"w-6 h-6 mx-auto rounded-full bg-gray-100 flex items-center justify-center",children:r.jsx(y.Z,{className:"w-4 h-4 text-gray-400"})})},a.id)})]},e.id))})]})})]})]})})}},42629:(e,a,t)=>{"use strict";t.d(a,{Cq:()=>s,UV:()=>o,a8:()=>x,hX:()=>d,o$:()=>n,oY:()=>l,r5:()=>c,zx:()=>i});var r=t(2777);async function s(){let{data:e,error:a}=await r.O.from("features").select("*").eq("is_active",!0).order("sort_order");return a?(console.error("Erro ao buscar features:",a),[]):e||[]}async function i(e){let{data:a,error:t}=await r.O.from("features").select("*").eq("is_active",!0).order("sort_order");if(t||!a)return console.error("Erro ao buscar features:",t),[];let{data:s,error:i}=await r.O.from("client_features").select("*").eq("client_id",e);i&&console.error("Erro ao buscar features do cliente:",i);let{data:d,error:l}=await r.O.from("feature_requests").select("feature_id").eq("client_id",e).eq("status","pending");l&&console.error("Erro ao buscar solicita\xe7\xf5es:",l);let n=new Map((s||[]).map(e=>[e.feature_id,e])),c=new Set((d||[]).map(e=>e.feature_id));return a.map(e=>{let a=n.get(e.id),t=c.has(e.id),r="disabled";return a?.is_enabled?(!a.expires_at||new Date(a.expires_at)>new Date)&&(r="enabled"):t&&(r="pending"),{feature:e,status:r,enabled_by:a?.enabled_by,enabled_at:a?.enabled_at||void 0,expires_at:a?.expires_at||void 0}})}async function d(e,a,t,s,i){try{let{data:d,error:l}=await r.O.from("features").select("id").eq("code",a).single();if(l||!d)return{success:!1,error:"Feature n\xe3o encontrada"};let{error:n}=await r.O.from("client_features").upsert({client_id:e,feature_id:d.id,is_enabled:t,enabled_by:"manual",enabled_by_user_id:s,enabled_at:t?new Date().toISOString():null,notes:i},{onConflict:"client_id,feature_id"});if(n)return{success:!1,error:n.message};return await r.O.from("feature_logs").insert({client_id:e,feature_id:d.id,feature_code:a,action:t?"enabled":"disabled",changed_by_user_id:s,reason:i||"Altera\xe7\xe3o manual"}),{success:!0}}catch(e){return console.error("Erro ao toggle feature:",e),{success:!1,error:"Erro interno"}}}async function l(){let{data:e,error:a}=await r.O.from("feature_requests").select(`
      *,
      feature:features(*)
    `).eq("status","pending").order("created_at",{ascending:!1});return a?(console.error("Erro ao buscar solicita\xe7\xf5es:",a),[]):e||[]}async function n(e,a,t){try{let{data:s,error:i}=await r.O.from("feature_requests").select("client_id, feature_id").eq("id",e).single();if(i||!s)return{success:!1,error:"Solicita\xe7\xe3o n\xe3o encontrada"};let{error:d}=await r.O.from("feature_requests").update({status:"approved",reviewed_by_user_id:a,reviewed_at:new Date().toISOString(),review_notes:t}).eq("id",e);if(d)return{success:!1,error:d.message};let{error:l}=await r.O.from("client_features").upsert({client_id:s.client_id,feature_id:s.feature_id,is_enabled:!0,enabled_by:"request",enabled_by_user_id:a,enabled_at:new Date().toISOString(),notes:`Aprovado via solicita\xe7\xe3o. ${t||""}`},{onConflict:"client_id,feature_id"});if(l)return{success:!1,error:l.message};return await r.O.from("feature_logs").insert({client_id:s.client_id,feature_id:s.feature_id,action:"request_approved",changed_by_user_id:a,reason:t||"Solicita\xe7\xe3o aprovada"}),{success:!0}}catch(e){return console.error("Erro ao aprovar solicita\xe7\xe3o:",e),{success:!1,error:"Erro interno"}}}async function c(e,a,t){try{let{data:s,error:i}=await r.O.from("feature_requests").select("client_id, feature_id").eq("id",e).single();if(i||!s)return{success:!1,error:"Solicita\xe7\xe3o n\xe3o encontrada"};let{error:d}=await r.O.from("feature_requests").update({status:"rejected",reviewed_by_user_id:a,reviewed_at:new Date().toISOString(),review_notes:t}).eq("id",e);if(d)return{success:!1,error:d.message};return await r.O.from("feature_logs").insert({client_id:s.client_id,feature_id:s.feature_id,action:"request_rejected",changed_by_user_id:a,reason:t}),{success:!0}}catch(e){return console.error("Erro ao rejeitar solicita\xe7\xe3o:",e),{success:!1,error:"Erro interno"}}}async function o(){let{data:e,error:a}=await r.O.from("services").select(`
      *,
      service_features(
        feature:features(*)
      )
    `).eq("is_active",!0).order("sort_order");return a?(console.error("Erro ao buscar servi\xe7os:",a),[]):(e||[]).map(e=>({...e,features:e.service_features?.map(e=>e.feature).filter(Boolean)||[]}))}async function x(e,a=50){let{data:t,error:s}=await r.O.from("feature_logs").select("*").eq("client_id",e).order("created_at",{ascending:!1}).limit(a);return s?(console.error("Erro ao buscar logs:",s),[]):t||[]}},10232:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>r});let r=(0,t(68570).createProxy)(String.raw`C:\Users\User\Downloads\valle-360-main\valle-360-main\src\app\admin\feature-flags\page.tsx#default`)}};var a=require("../../../webpack-runtime.js");a.C(e);var t=e=>a(a.s=e),r=a.X(0,[89276,54267,51789,78515,46226,28870,39215,16819,72418,86148,61288,36499,18832,14574,92237],()=>t(64168));module.exports=r})();