(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[858],{5667:function(e,a,s){Promise.resolve().then(s.bind(s,98980))},30401:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(79205).Z)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},92451:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(79205).Z)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},10407:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(79205).Z)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},96362:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(79205).Z)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]])},37760:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(79205).Z)("instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]])},89345:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(79205).Z)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]])},88893:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(79205).Z)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]])},13041:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(79205).Z)("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]])},73247:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(79205).Z)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},18930:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(79205).Z)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},95805:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(79205).Z)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},98980:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return _}});var t=s(57437),l=s(2265),r=s(26892),n=s(57586),i=s(51817),c=s(37760),o=s(99397),d=s(73247),m=s(95805),h=s(89345),x=s(13041),u=s(96362),p=s(88893),g=s(18930),j=s(92451),v=s(10407),y=s(32489),f=s(30401),N=s(79820),b=s(12381),k=s(69174),w=s(40279),C=s(75060),Z=s(15291),z=s(14438);function _(){let[e,a]=(0,l.useState)([]),[s,y]=(0,l.useState)([]),[f,C]=(0,l.useState)({}),[_,M]=(0,l.useState)(!0),[S,I]=(0,l.useState)(!1),[P,A]=(0,l.useState)(""),[q,T]=(0,l.useState)(""),[Q,O]=(0,l.useState)(1),[V,L]=(0,l.useState)(1),[D,H]=(0,l.useState)(!1),[B,Y]=(0,l.useState)(null),[J,U]=(0,l.useState)(!1);(0,l.useEffect)(()=>{F()},[P,q,Q]);let F=async()=>{try{let e=new URLSearchParams({page:Q.toString(),limit:"20"});P&&e.set("search",P),q&&e.set("category",q);let s=await fetch("/api/client/contacts?".concat(e)),t=await s.json();t.success&&(a(t.contacts),y(t.tags),C(t.stats),L(t.pagination.totalPages))}catch(e){console.error("Erro ao carregar contatos:",e),z.Am.error("Erro ao carregar contatos")}finally{M(!1)}},G=async e=>{I(!0);try{let a=await fetch("/api/client/contacts/sync-instagram",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({syncType:e})}),s=await a.json();s.success?(z.Am.success(s.message),F()):z.Am.error(s.error)}catch(e){console.error("Erro ao sincronizar:",e),z.Am.error("Erro ao sincronizar Instagram")}finally{I(!1),U(!1)}},R=async e=>{if(confirm("Tem certeza que deseja excluir este contato?"))try{(await fetch("/api/client/contacts?id=".concat(e),{method:"DELETE"})).ok?(z.Am.success("Contato exclu\xeddo"),F()):z.Am.error("Erro ao excluir contato")}catch(e){console.error("Erro ao excluir:",e),z.Am.error("Erro ao excluir contato")}},K=e=>{let a={lead:"bg-blue-100 text-blue-800",customer:"bg-green-100 text-green-800",vip:"bg-purple-100 text-purple-800",partner:"bg-amber-100 text-amber-800",outros:"bg-gray-100 text-gray-800"};return a[e]||a.outros},W=e=>({manual:"Manual",instagram_dm:"Instagram DM",instagram_comment:"Coment\xe1rio",instagram_mention:"Men\xe7\xe3o",form:"Formul\xe1rio"})[e]||e;return(0,t.jsxs)("div",{className:"space-y-6 pb-8",children:[(0,t.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold",style:{color:"var(--text-primary)"},children:"Meus Contatos"}),(0,t.jsx)("p",{className:"text-sm",style:{color:"var(--text-secondary)"},children:"Gerencie seus leads e clientes"})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(b.z,{variant:"outline",onClick:()=>U(!0),disabled:S,children:[S?(0,t.jsx)(i.Z,{className:"w-4 h-4 mr-2 animate-spin"}):(0,t.jsx)(c.Z,{className:"w-4 h-4 mr-2"}),"Sincronizar Instagram"]}),(0,t.jsxs)(b.z,{className:"bg-primary hover:bg-[#1260b5]",onClick:()=>H(!0),children:[(0,t.jsx)(o.Z,{className:"w-4 h-4 mr-2"}),"Novo Contato"]})]})]}),(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[{label:"Total",value:Object.values(f).reduce((e,a)=>e+a,0),color:"bg-gray-100"},{label:"Leads",value:f.lead||0,color:"bg-blue-100"},{label:"Clientes",value:f.customer||0,color:"bg-green-100"},{label:"VIP",value:f.vip||0,color:"bg-purple-100"},{label:"Parceiros",value:f.partner||0,color:"bg-amber-100"}].map((e,a)=>(0,t.jsx)(r.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*a},children:(0,t.jsx)(N.Zb,{className:e.color,children:(0,t.jsxs)(N.aY,{className:"p-4 text-center",children:[(0,t.jsx)("p",{className:"text-2xl font-bold",children:e.value}),(0,t.jsx)("p",{className:"text-sm opacity-70",children:e.label})]})})},e.label))}),(0,t.jsx)(N.Zb,{children:(0,t.jsx)(N.aY,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(d.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,t.jsx)(w.II,{placeholder:"Buscar por nome, email ou Instagram...",value:P,onChange:e=>A(e.target.value),className:"pl-10"})]})}),(0,t.jsxs)(Z.Ph,{value:q,onValueChange:T,children:[(0,t.jsx)(Z.i4,{className:"w-full md:w-48",children:(0,t.jsx)(Z.ki,{placeholder:"Categoria"})}),(0,t.jsxs)(Z.Bw,{children:[(0,t.jsx)(Z.Ql,{value:"",children:"Todas"}),(0,t.jsx)(Z.Ql,{value:"lead",children:"Leads"}),(0,t.jsx)(Z.Ql,{value:"customer",children:"Clientes"}),(0,t.jsx)(Z.Ql,{value:"vip",children:"VIP"}),(0,t.jsx)(Z.Ql,{value:"partner",children:"Parceiros"})]})]})]})})}),(0,t.jsx)(N.Zb,{children:(0,t.jsxs)(N.aY,{className:"p-0",children:[_?(0,t.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,t.jsx)(i.Z,{className:"w-8 h-8 animate-spin text-primary"})}):0===e.length?(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)(m.Z,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-500",children:"Nenhum contato encontrado"}),(0,t.jsx)("p",{className:"text-sm text-gray-400",children:"Adicione contatos manualmente ou sincronize do Instagram"})]}):(0,t.jsx)("div",{className:"divide-y",children:e.map((e,a)=>{var s;return(0,t.jsx)(r.E.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.02*a},className:"p-4 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("div",{className:"w-12 h-12 rounded-full overflow-hidden flex-shrink-0",children:e.profile_picture_url?(0,t.jsx)("img",{src:e.profile_picture_url,alt:"",className:"w-full h-full object-cover"}):(0,t.jsx)("div",{className:"w-full h-full bg-gradient-to-br from-primary-light to-primary flex items-center justify-center text-white font-bold",children:(null===(s=e.name)||void 0===s?void 0:s.charAt(0).toUpperCase())||"?"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)("h3",{className:"font-medium truncate",children:e.name}),(0,t.jsx)(k.C,{className:K(e.category),children:e.category})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 text-sm text-gray-500",children:[e.instagram_handle&&(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)(c.Z,{className:"w-3 h-3"}),"@",e.instagram_handle]}),e.email&&(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)(h.Z,{className:"w-3 h-3"}),e.email]}),e.phone&&(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)(x.Z,{className:"w-3 h-3"}),e.phone]})]}),e.tags.length>0&&(0,t.jsxs)("div",{className:"flex items-center gap-1 mt-2",children:[e.tags.slice(0,3).map(e=>(0,t.jsx)(k.C,{variant:"outline",className:"text-xs",children:e},e)),e.tags.length>3&&(0,t.jsxs)("span",{className:"text-xs text-gray-400",children:["+",e.tags.length-3]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-xs text-gray-400 hidden md:block",children:W(e.source)}),(0,t.jsxs)("div",{className:"flex gap-1",children:[e.instagram_handle&&(0,t.jsx)(b.z,{variant:"ghost",size:"sm",onClick:()=>window.open("https://instagram.com/".concat(e.instagram_handle),"_blank"),children:(0,t.jsx)(u.Z,{className:"w-4 h-4"})}),(0,t.jsx)(b.z,{variant:"ghost",size:"sm",onClick:()=>Y(e),children:(0,t.jsx)(p.Z,{className:"w-4 h-4"})}),(0,t.jsx)(b.z,{variant:"ghost",size:"sm",className:"text-red-500 hover:text-red-600",onClick:()=>R(e.id),children:(0,t.jsx)(g.Z,{className:"w-4 h-4"})})]})]})]})},e.id)})}),V>1&&(0,t.jsxs)("div",{className:"flex items-center justify-center gap-2 p-4 border-t",children:[(0,t.jsx)(b.z,{variant:"outline",size:"sm",onClick:()=>O(e=>Math.max(1,e-1)),disabled:1===Q,children:(0,t.jsx)(j.Z,{className:"w-4 h-4"})}),(0,t.jsxs)("span",{className:"text-sm text-gray-500",children:["P\xe1gina ",Q," de ",V]}),(0,t.jsx)(b.z,{variant:"outline",size:"sm",onClick:()=>O(e=>Math.min(V,e+1)),disabled:Q===V,children:(0,t.jsx)(v.Z,{className:"w-4 h-4"})})]})]})}),(0,t.jsx)(n.M,{children:J&&(0,t.jsx)(r.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:()=>U(!1),children:(0,t.jsxs)(r.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white dark:bg-gray-800 rounded-xl p-6 max-w-md w-full",onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("h3",{className:"text-xl font-bold mb-4",children:"Sincronizar do Instagram"}),(0,t.jsx)("p",{className:"text-gray-500 mb-6",children:"Escolha o tipo de contatos que deseja importar:"}),(0,t.jsx)("div",{className:"space-y-3",children:[{type:"dms",label:"Mensagens Diretas",desc:"Pessoas que enviaram DMs"},{type:"comments",label:"Coment\xe1rios",desc:"Pessoas que comentaram seus posts"},{type:"mentions",label:"Men\xe7\xf5es",desc:"Pessoas que te mencionaram"}].map(e=>(0,t.jsxs)("button",{onClick:()=>G(e.type),disabled:S,className:"w-full p-4 text-left rounded-lg border hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors disabled:opacity-50",children:[(0,t.jsx)("p",{className:"font-medium",children:e.label}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:e.desc})]},e.type))}),(0,t.jsx)(b.z,{variant:"outline",className:"w-full mt-4",onClick:()=>U(!1),children:"Cancelar"})]})})}),(0,t.jsx)(n.M,{children:(D||B)&&(0,t.jsx)(E,{contact:B,onClose:()=>{H(!1),Y(null)},onSave:()=>{H(!1),Y(null),F()}})})]})}function E(e){let{contact:a,onClose:s,onSave:n}=e,[c,o]=(0,l.useState)({name:(null==a?void 0:a.name)||"",email:(null==a?void 0:a.email)||"",phone:(null==a?void 0:a.phone)||"",instagram_handle:(null==a?void 0:a.instagram_handle)||"",category:(null==a?void 0:a.category)||"lead",notes:(null==a?void 0:a.notes)||"",tags:(null==a?void 0:a.tags)||[]}),[d,m]=(0,l.useState)(!1),h=async()=>{if(!c.name.trim()){z.Am.error("Nome \xe9 obrigat\xf3rio");return}m(!0);try{let e=a?{id:a.id,...c}:c,s=await fetch("/api/client/contacts",{method:a?"PATCH":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),t=await s.json();t.success?(z.Am.success(a?"Contato atualizado!":"Contato criado!"),n()):z.Am.error(t.error||"Erro ao salvar contato")}catch(e){console.error("Erro ao salvar:",e),z.Am.error("Erro ao salvar contato")}finally{m(!1)}};return(0,t.jsx)(r.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:s,children:(0,t.jsxs)(r.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white dark:bg-gray-800 rounded-xl p-6 max-w-lg w-full max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsx)("h3",{className:"text-xl font-bold",children:a?"Editar Contato":"Novo Contato"}),(0,t.jsx)(b.z,{variant:"ghost",size:"sm",onClick:s,children:(0,t.jsx)(y.Z,{className:"w-4 h-4"})})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(C._,{children:"Nome *"}),(0,t.jsx)(w.II,{value:c.name,onChange:e=>o({...c,name:e.target.value}),placeholder:"Nome do contato"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(C._,{children:"Email"}),(0,t.jsx)(w.II,{type:"email",value:c.email,onChange:e=>o({...c,email:e.target.value}),placeholder:"email@exemplo.com"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(C._,{children:"Telefone"}),(0,t.jsx)(w.II,{value:c.phone,onChange:e=>o({...c,phone:e.target.value}),placeholder:"(11) 99999-9999"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(C._,{children:"Instagram"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",children:"@"}),(0,t.jsx)(w.II,{value:c.instagram_handle,onChange:e=>o({...c,instagram_handle:e.target.value}),placeholder:"usuario",className:"pl-8"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(C._,{children:"Categoria"}),(0,t.jsxs)(Z.Ph,{value:c.category,onValueChange:e=>o({...c,category:e}),children:[(0,t.jsx)(Z.i4,{children:(0,t.jsx)(Z.ki,{})}),(0,t.jsxs)(Z.Bw,{children:[(0,t.jsx)(Z.Ql,{value:"lead",children:"Lead"}),(0,t.jsx)(Z.Ql,{value:"customer",children:"Cliente"}),(0,t.jsx)(Z.Ql,{value:"vip",children:"VIP"}),(0,t.jsx)(Z.Ql,{value:"partner",children:"Parceiro"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(C._,{children:"Notas"}),(0,t.jsx)("textarea",{value:c.notes,onChange:e=>o({...c,notes:e.target.value}),placeholder:"Observa\xe7\xf5es sobre o contato...",className:"w-full p-3 border rounded-lg resize-none focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-700 dark:border-gray-600",rows:3})]})]}),(0,t.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,t.jsx)(b.z,{variant:"outline",className:"flex-1",onClick:s,children:"Cancelar"}),(0,t.jsxs)(b.z,{className:"flex-1 bg-primary hover:bg-[#1260b5]",onClick:h,disabled:d,children:[d?(0,t.jsx)(i.Z,{className:"w-4 h-4 animate-spin mr-2"}):(0,t.jsx)(f.Z,{className:"w-4 h-4 mr-2"}),a?"Atualizar":"Criar"]})]})]})})}}},function(e){e.O(0,[2882,6137,4438,5940,9857,2971,2117,1744],function(){return e(e.s=5667)}),_N_E=e.O()}]);