(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1294],{26252:function(e,t,r){Promise.resolve().then(r.bind(r,65937))},32660:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(79205).Z)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},96362:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(79205).Z)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]])},51817:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(79205).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},99397:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(79205).Z)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},58896:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(79205).Z)("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]])},18930:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(79205).Z)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},76865:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(79205).Z)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},27648:function(e,t,r){"use strict";r.d(t,{default:function(){return s.a}});var a=r(72972),s=r.n(a)},65937:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return p}});var a=r(57437),s=r(26892),i=r(27648),n=r(2265),l=r(32660),d=r(58896),o=r(51817),c=r(76865),m=r(99397),x=r(18930),u=r(96362),h=r(93448);function p(){var e;let[t,r]=(0,n.useState)(!0),[p,f]=(0,n.useState)(!1),[g,b]=(0,n.useState)(null),[y,w]=(0,n.useState)("Cliente"),[j,v]=(0,n.useState)(""),[k,N]=(0,n.useState)([]),[S,Z]=(0,n.useState)(""),[E,M]=(0,n.useState)(null),[A,z]=(0,n.useState)(!1);(0,n.useEffect)(()=>{let e=!0;return(async()=>{try{r(!0),b(null);let t=await fetch("/api/client/profile"),a=await t.json().catch(()=>null);if(!t.ok)throw Error((null==a?void 0:a.error)||"Falha ao carregar perfil do cliente");if(!e)return;let s=(null==a?void 0:a.profile)||{};w(String(s.company_name||"Cliente")),v(String(s.segment||s.industry||"")),N(Array.isArray(s.competitors)?s.competitors.map(String).filter(Boolean):[])}catch(t){if(!e)return;b(String((null==t?void 0:t.message)||"Erro ao carregar"))}finally{e&&r(!1)}})(),()=>{e=!1}},[]);let C=(0,n.useMemo)(()=>k.join("\n"),[k]),F=async e=>{let t=Array.from(new Set((e||[]).map(e=>String(e).trim()).filter(Boolean))).slice(0,25);f(!0);try{let e=await fetch("/api/client/profile",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({segment:j||null,competitors:t,concorrentes:t.join("\n")})}),r=await e.json().catch(()=>null);if(!e.ok)throw Error((null==r?void 0:r.error)||"Falha ao salvar concorrentes");N(t)}finally{f(!1)}},_=async()=>{let e=String(S||"").trim();e&&(Z(""),await F([...k,e]))},B=async e=>{await F(k.filter(t=>t!==e))},O=async()=>{z(!0);try{let e=await fetch("/api/ai/val/web-insights"),t=await e.json().catch(()=>null);if(!e.ok)throw Error((null==t?void 0:t.error)||"Falha ao gerar insights");if(null==t?void 0:t.skip){M(null);return}M({message:String((null==t?void 0:t.message)||""),sources:Array.isArray(null==t?void 0:t.sources)?t.sources.map(String):[],provider:null==t?void 0:t.provider,generatedAt:null==t?void 0:t.generatedAt})}catch(e){M({message:String((null==e?void 0:e.message)||"Erro ao gerar insights"),sources:[]})}finally{z(!1)}};return(0,a.jsxs)("div",{className:"p-4 lg:p-6 space-y-6 max-w-7xl mx-auto",children:[(0,a.jsxs)(s.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,a.jsx)(i.default,{href:"/cliente/painel",className:"p-2 rounded-lg bg-[#001533]/5 hover:bg-[#001533]/10 transition-colors",children:(0,a.jsx)(l.Z,{className:"size-5 text-[#001533] dark:text-white"})}),(0,a.jsx)("div",{className:"p-2 rounded-lg bg-gradient-to-br from-purple-500 to-purple-600",children:(0,a.jsx)(d.Z,{className:"size-5 text-white"})}),(0,a.jsx)("h1",{className:"text-3xl font-bold text-[#001533] dark:text-white",children:"Concorrentes"})]}),(0,a.jsxs)("p",{className:"text-[#001533]/60 dark:text-white/60 ml-12",children:["Configure seus concorrentes para ",(0,a.jsx)("span",{className:"font-medium",children:y}),j?(0,a.jsxs)(a.Fragment,{children:[" ","• ",(0,a.jsx)("span",{className:"font-medium",children:j})]}):null]})]}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)("button",{onClick:O,disabled:A||t,className:(0,h.cn)("px-4 py-2 rounded-xl font-medium transition-all border","bg-white dark:bg-[#001533]/50 text-[#001533] dark:text-white","border-[#001533]/10 dark:border-white/10 hover:border-[#1672d6]/30"),children:A?(0,a.jsxs)("span",{className:"inline-flex items-center gap-2",children:[(0,a.jsx)(o.Z,{className:"size-4 animate-spin"})," Gerando…"]}):"Gerar insights com fontes"})})]}),g&&(0,a.jsxs)("div",{className:"rounded-xl border border-red-200 bg-red-50 p-4 text-sm text-red-700 flex items-start gap-2",children:[(0,a.jsx)(c.Z,{className:"size-4 mt-0.5"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:"N\xe3o foi poss\xedvel carregar seu perfil"}),(0,a.jsx)("p",{className:"mt-1 opacity-80",children:g})]})]}),(0,a.jsxs)(s.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:(0,h.cn)("rounded-2xl border-2 border-[#001533]/10 dark:border-white/10 bg-white dark:bg-[#001533]/50 p-6",t&&"opacity-70"),children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-3 md:items-end",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-[#001533] dark:text-white mb-1.5",children:"Adicionar concorrente"}),(0,a.jsx)("input",{value:S,onChange:e=>Z(e.target.value),placeholder:"Ex: Empresa X, @perfil, dom\xednio.com.br",className:"w-full px-4 py-3 rounded-xl border-2 border-[#001533]/10 dark:border-white/10 bg-white dark:bg-[#001533]/50 text-[#001533] dark:text-white placeholder:text-[#001533]/40 dark:placeholder:text-white/40 focus:border-[#1672d6] focus:outline-none transition-colors",disabled:t||p,onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),_())}})]}),(0,a.jsx)("button",{onClick:()=>void _(),disabled:t||p||!S.trim(),className:(0,h.cn)("px-4 py-3 rounded-xl font-medium transition-all","bg-[#1672d6] text-white hover:bg-[#1260b5]","disabled:opacity-50 disabled:cursor-not-allowed"),children:(0,a.jsxs)("span",{className:"inline-flex items-center gap-2",children:[p?(0,a.jsx)(o.Z,{className:"size-4 animate-spin"}):(0,a.jsx)(m.Z,{className:"size-4"}),"Adicionar"]})})]}),(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-[#001533] dark:text-white",children:"Seus concorrentes"}),(0,a.jsxs)("span",{className:"text-sm text-[#001533]/50 dark:text-white/50",children:[k.length," monitorados"]})]}),0===k.length?(0,a.jsx)("p",{className:"mt-3 text-sm text-[#001533]/60 dark:text-white/60",children:"Adicione pelo menos 1 concorrente para a Val conseguir comparar e sugerir a\xe7\xf5es."}):(0,a.jsx)("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-2 gap-3",children:k.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between gap-3 rounded-xl border border-[#001533]/10 dark:border-white/10 bg-white/60 dark:bg-[#001533]/30 p-3",children:[(0,a.jsxs)("div",{className:"min-w-0",children:[(0,a.jsx)("p",{className:"font-medium text-[#001533] dark:text-white truncate",children:e}),(0,a.jsx)("p",{className:"text-xs text-[#001533]/50 dark:text-white/50 truncate",children:"Salvo no seu perfil"})]}),(0,a.jsx)("button",{onClick:()=>void B(e),disabled:p,className:"p-2 rounded-lg hover:bg-red-500/10 text-red-600 disabled:opacity-50",title:"Remover",children:(0,a.jsx)(x.Z,{className:"size-4"})})]},e))}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-[#001533]/50 dark:text-white/50 mb-1",children:"(Opcional) Lista em texto"}),(0,a.jsx)("textarea",{value:C,readOnly:!0,rows:3,className:"w-full px-3 py-2 rounded-xl border border-[#001533]/10 dark:border-white/10 bg-[#001533]/5 dark:bg-white/5 text-[#001533] dark:text-white text-sm"})]})]})]}),E&&E.message&&(0,a.jsxs)(s.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.15},className:"rounded-2xl border-2 border-[#001533]/10 dark:border-white/10 bg-white dark:bg-[#001533]/50 p-6",children:[(0,a.jsx)("div",{className:"flex items-start justify-between gap-4",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-[#001533] dark:text-white",children:"Insights com fontes"}),(0,a.jsxs)("p",{className:"text-xs text-[#001533]/50 dark:text-white/50 mt-1",children:[E.provider?"Fonte: ".concat(E.provider):"Fonte: web",E.generatedAt?" • ".concat(new Date(E.generatedAt).toLocaleString("pt-BR")):""]})]})}),(0,a.jsx)("div",{className:"mt-3 whitespace-pre-wrap text-sm text-[#001533] dark:text-white",children:E.message}),(null===(e=E.sources)||void 0===e?void 0:e.length)>0&&(0,a.jsxs)("div",{className:"mt-4 pt-4 border-t border-[#001533]/10 dark:border-white/10",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-[#001533] dark:text-white mb-2",children:"Fontes"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:E.sources.slice(0,10).map(e=>(0,a.jsxs)("a",{href:e,target:"_blank",rel:"noreferrer",className:"flex items-center justify-between gap-2 rounded-xl border border-[#001533]/10 dark:border-white/10 bg-white/60 dark:bg-[#001533]/30 px-3 py-2 hover:border-[#1672d6]/30 transition-colors",children:[(0,a.jsx)("span",{className:"text-xs text-[#1672d6] underline break-all",children:e}),(0,a.jsx)(u.Z,{className:"size-4 text-[#001533]/40 dark:text-white/40"})]},e))})]})]})]})}},93448:function(e,t,r){"use strict";r.d(t,{cn:function(){return i},x:function(){return n}});var a=r(61994),s=r(53335);function i(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.m6)((0,a.W)(t))}function n(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}}},function(e){e.O(0,[2882,6137,2972,2971,2117,1744],function(){return e(e.s=26252)}),_N_E=e.O()}]);