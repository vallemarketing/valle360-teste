"use strict";(()=>{var e={};e.id=96656,e.ids=[96656],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},15799:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>k,patchFetch:()=>g,requestAsyncStorage:()=>_,routeModule:()=>m,serverHooks:()=>w,staticGenerationAsyncStorage:()=>f});var a={};r.r(a),r.d(a,{GET:()=>u,POST:()=>h,dynamic:()=>c});var i=r(49303),n=r(88716),o=r(60670),s=r(87070);let c="force-dynamic",d=process.env.LINKEDIN_CLIENT_ID,l=process.env.LINKEDIN_CLIENT_SECRET,p=process.env.NEXT_PUBLIC_APP_URL+"/api/oauth/linkedin/callback";async function u(e){let{searchParams:t}=new URL(e.url),r=t.get("client_id"),a=t.get("state")||Math.random().toString(36).substring(7);if(!d)return s.NextResponse.json({error:"LinkedIn Client ID n\xe3o configurado"},{status:500});let i=new URL("https://www.linkedin.com/oauth/v2/authorization");return i.searchParams.set("response_type","code"),i.searchParams.set("client_id",d),i.searchParams.set("redirect_uri",p),i.searchParams.set("scope","r_liteprofile r_emailaddress w_member_social r_organization_social w_organization_social"),i.searchParams.set("state",JSON.stringify({clientId:r,state:a})),s.NextResponse.redirect(i.toString())}async function h(e){try{let t;let{code:r,state:a}=await e.json();if(!r)return s.NextResponse.json({error:"C\xf3digo de autoriza\xe7\xe3o n\xe3o fornecido"},{status:400});let i=await fetch("https://www.linkedin.com/oauth/v2/accessToken",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"authorization_code",code:r,redirect_uri:p,client_id:d,client_secret:l})}),n=await i.json();if(n.error)return s.NextResponse.json({error:n.error_description||n.error},{status:400});let o=await fetch("https://api.linkedin.com/v2/me",{headers:{Authorization:`Bearer ${n.access_token}`}}),c=await o.json(),u=await fetch("https://api.linkedin.com/v2/me?projection=(profilePicture(displayImage~:playableStreams))",{headers:{Authorization:`Bearer ${n.access_token}`}}),h=await u.json(),m=h.profilePicture?.["displayImage~"]?.elements?.[0]?.identifiers?.[0]?.identifier;try{t=JSON.parse(a).clientId}catch{t=a}return s.NextResponse.json({success:!0,profile:{id:c.id,firstName:c.localizedFirstName,lastName:c.localizedLastName,profilePicture:m},accessToken:n.access_token,expiresIn:n.expires_in,clientId:t})}catch(e){return console.error("Erro no OAuth do LinkedIn:",e),s.NextResponse.json({error:"Erro ao processar autentica\xe7\xe3o"},{status:500})}}let m=new i.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/oauth/linkedin/route",pathname:"/api/oauth/linkedin",filename:"route",bundlePath:"app/api/oauth/linkedin/route"},resolvedPagePath:"C:\\Users\\User\\Downloads\\valle-360-main\\valle-360-main\\src\\app\\api\\oauth\\linkedin\\route.ts",nextConfigOutput:"standalone",userland:a}),{requestAsyncStorage:_,staticGenerationAsyncStorage:f,serverHooks:w}=m,k="/api/oauth/linkedin/route";function g(){return(0,o.patchFetch)({serverHooks:w,staticGenerationAsyncStorage:f})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[89276,55972],()=>r(15799));module.exports=a})();