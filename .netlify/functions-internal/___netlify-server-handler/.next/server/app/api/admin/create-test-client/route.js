"use strict";(()=>{var e={};e.id=7200,e.ids=[7200],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},42810:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>I,patchFetch:()=>v,requestAsyncStorage:()=>h,routeModule:()=>_,serverHooks:()=>f,staticGenerationAsyncStorage:()=>g});var r={};a.r(r),a.d(r,{POST:()=>m,dynamic:()=>u});var s=a(49303),i=a(88716),n=a(60670),o=a(87070),c=a(54128);let u="force-dynamic",l=process.env.SUPABASE_SERVICE_ROLE_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlramdzcXR5a2tocWlteXBhY3JvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMyMTE4OTksImV4cCI6MjA3ODc4Nzg5OX0.vgVCpFIt-5ajFhcXg65dqrEw915pqW8fGZ8xgJxrnxI",d=(0,c.eI)("https://ikjgsqtykkhqimypacro.supabase.co",l||"setup-missing",{auth:{persistSession:!1,autoRefreshToken:!1,detectSessionInUrl:!1}});async function p(e){let t=e.headers.get("authorization")||e.headers.get("Authorization"),a=t?.startsWith("Bearer ")?t.slice(7):null;if(!a)return null;let{data:{user:r}}=await d.auth.getUser(a);return r||null}async function m(e){let t=await p(e);if(!t)return o.NextResponse.json({error:"N\xe3o autorizado"},{status:401});let{data:a}=await d.from("users").select("role,user_type").eq("id",t.id).maybeSingle(),r=a?.role||null,s=a?.user_type||null;if(!("super_admin"===r||"super_admin"===s))return o.NextResponse.json({error:"Acesso negado (super_admin)"},{status:403});let i=await e.json().catch(()=>({})),n=i?.company_name||`Cliente Teste ${new Date().toLocaleDateString("pt-BR")}`,c=`cliente.teste+${Date.now()}_${function(e=6){return Math.random().toString(36).slice(2,2+e)}(4)}@valle360.com.br`,u=`Valle@${Math.floor(9e5*Math.random()+1e5)}!`,l=i?.full_name||n,{data:m,error:_}=await d.auth.admin.createUser({email:c,password:u,email_confirm:!0,user_metadata:{full_name:l,user_type:"client"}});if(_||!m?.user?.id)return o.NextResponse.json({error:_?.message||"Falha ao criar usu\xe1rio"},{status:500});let h=m.user.id;await d.from("users").upsert({id:h,email:c,full_name:l,name:l,role:"client",user_type:"client",account_status:"active",created_by:t.id,created_at:new Date().toISOString()}),await d.from("user_profiles").upsert({id:h,user_id:h,email:c,full_name:l,role:"client",user_type:"client",is_active:!0,metadata:{created_as_test:!0}});let{data:g,error:f}=await d.from("clients").insert({user_id:h,company_name:n,contact_name:l,contact_email:c,status:"active",is_active:!0,onboarding_completed:!1,email:c,nome_fantasia:n,razao_social:n,created_at:new Date().toISOString()}).select("id").single();return f||!g?.id?o.NextResponse.json({error:f?.message||"Falha ao criar cliente"},{status:500}):o.NextResponse.json({success:!0,credentials:{email:c,password:u,client_id:String(g.id),user_id:h}})}let _=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/admin/create-test-client/route",pathname:"/api/admin/create-test-client",filename:"route",bundlePath:"app/api/admin/create-test-client/route"},resolvedPagePath:"C:\\Users\\User\\Downloads\\valle-360-main\\valle-360-main\\src\\app\\api\\admin\\create-test-client\\route.ts",nextConfigOutput:"standalone",userland:r}),{requestAsyncStorage:h,staticGenerationAsyncStorage:g,serverHooks:f}=_,I="/api/admin/create-test-client/route";function v(){return(0,n.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:g})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[89276,55972,54128],()=>a(42810));module.exports=r})();