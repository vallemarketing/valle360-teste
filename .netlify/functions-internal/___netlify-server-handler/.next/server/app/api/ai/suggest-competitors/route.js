"use strict";(()=>{var e={};e.id=7904,e.ids=[7904],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},17347:(e,a,o)=>{o.r(a),o.d(a,{originalPathname:()=>f,patchFetch:()=>x,requestAsyncStorage:()=>p,routeModule:()=>u,serverHooks:()=>g,staticGenerationAsyncStorage:()=>d});var r={};o.r(r),o.d(r,{POST:()=>l});var s=o(49303),t=o(88716),n=o(60670),i=o(87070),m=o(20344),c=o(71615);async function l(e){let a=(0,m.createRouteHandlerClient)({cookies:c.cookies}),{data:{user:o},error:r}=await a.auth.getUser();if(r||!o)return i.NextResponse.json({error:"N\xe3o autorizado"},{status:401});let{segment:s,industry:t,location:n}=await e.json();if(!s)return i.NextResponse.json({error:"Segmento \xe9 obrigat\xf3rio"},{status:400});try{let{data:e}=await a.from("clients").select("id, company_name").eq("user_id",o.id).single(),r=`
Voc\xea \xe9 um especialista em marketing digital brasileiro. 
Com base nas informa\xe7\xf5es abaixo, liste 5 principais concorrentes no Instagram que o cliente deveria monitorar.

Informa\xe7\xf5es do cliente:
- Segmento: ${s}
- Nicho espec\xedfico: ${t||"N\xe3o especificado"}
- Localiza\xe7\xe3o: ${n||"Brasil"}
- Empresa: ${e?.company_name||"N\xe3o especificado"}

Retorne um JSON com a seguinte estrutura:
{
  "competitors": [
    {
      "username": "@exemplo",
      "name": "Nome da Empresa",
      "reason": "Por que \xe9 um bom concorrente para monitorar",
      "followers_estimate": 10000,
      "category": "Categoria do neg\xf3cio"
    }
  ]
}

Considere:
- Empresas do mesmo segmento
- Diferentes tamanhos (algumas maiores, algumas similares)
- Marcas com boa presen\xe7a no Instagram
- Concorrentes diretos e indiretos
`,m=process.env.OPENAI_API_KEY;if(m){let e=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{Authorization:`Bearer ${m}`,"Content-Type":"application/json"},body:JSON.stringify({model:"gpt-4-turbo-preview",messages:[{role:"system",content:"Voc\xea \xe9 um especialista em marketing digital e an\xe1lise de concorr\xeancia. Responda sempre em JSON v\xe1lido."},{role:"user",content:r}],temperature:.7,response_format:{type:"json_object"}})});if(e.ok){let a=await e.json(),o=a.choices[0]?.message?.content;try{let e=JSON.parse(o);return i.NextResponse.json({success:!0,competitors:e.competitors||[],source:"ai"})}catch(e){console.error("Erro ao parsear resposta da IA:",e)}}}let c=process.env.TAVILY_API_KEY;if(c){let e=`melhores empresas ${s} ${t||""} Instagram Brasil`,a=await fetch("https://api.tavily.com/search",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({api_key:c,query:e,search_depth:"advanced",max_results:10,include_domains:["instagram.com","forbes.com.br","exame.com","infomoney.com.br"]})});if(a.ok){let e=await a.json(),o=e.results?.filter(e=>e.url?.includes("instagram.com"))?.slice(0,5)?.map((e,a)=>{let o=e.url?.split("instagram.com/")[1]?.split("/")[0]||`competitor${a+1}`;return{username:`@${o}`,name:e.title||o,reason:"Encontrado atrav\xe9s de busca de mercado",followers_estimate:1e4+5e3*a,category:s}})||[];if(o.length>0)return i.NextResponse.json({success:!0,competitors:o,source:"search"})}}let l={ecommerce:[{username:"@netshoes",name:"Netshoes",reason:"Refer\xeancia em e-commerce esportivo",followers_estimate:15e5,category:"E-commerce"},{username:"@americanas",name:"Americanas",reason:"Grande player de marketplace",followers_estimate:5e6,category:"E-commerce"},{username:"@shopee_br",name:"Shopee Brasil",reason:"L\xedder em engajamento",followers_estimate:8e6,category:"E-commerce"}],food:[{username:"@iflodbr",name:"iFood",reason:"L\xedder em delivery",followers_estimate:4e6,category:"Alimenta\xe7\xe3o"},{username:"@mcdonalds_br",name:"McDonalds Brasil",reason:"Refer\xeancia em conte\xfado",followers_estimate:35e5,category:"Alimenta\xe7\xe3o"}],beauty:[{username:"@oboticario",name:"O Botic\xe1rio",reason:"L\xedder em beleza",followers_estimate:6e6,category:"Beleza"},{username:"@sabordebeleza",name:"Sabor de Beleza",reason:"Influente no segmento",followers_estimate:5e5,category:"Beleza"}],fashion:[{username:"@renlojas",name:"Renner",reason:"Refer\xeancia em moda",followers_estimate:4e6,category:"Moda"},{username:"@zaaborjaz",name:"Zara Brasil",reason:"Fast fashion l\xedder",followers_estimate:2e6,category:"Moda"}],tech:[{username:"@magazineluiza",name:"Magazine Luiza",reason:"L\xedder em tech retail",followers_estimate:1e7,category:"Tecnologia"},{username:"@kababorjaz",name:"Kabum",reason:"Refer\xeancia em tech",followers_estimate:15e5,category:"Tecnologia"}],health:[{username:"@biolab",name:"Biolab",reason:"Refer\xeancia em sa\xfade",followers_estimate:2e5,category:"Sa\xfade"},{username:"@smartfit",name:"Smart Fit",reason:"L\xedder em fitness",followers_estimate:25e5,category:"Sa\xfade"}],services:[{username:"@nubank",name:"Nubank",reason:"Refer\xeancia em conte\xfado B2C",followers_estimate:5e6,category:"Servi\xe7os"},{username:"@xpinvestimentos",name:"XP Investimentos",reason:"L\xedder em finan\xe7as",followers_estimate:15e5,category:"Servi\xe7os"}]}[s]||[{username:"@exemplo1",name:"Concorrente Exemplo 1",reason:"Sugest\xe3o baseada no segmento",followers_estimate:5e4,category:s},{username:"@exemplo2",name:"Concorrente Exemplo 2",reason:"Sugest\xe3o baseada no segmento",followers_estimate:3e4,category:s},{username:"@exemplo3",name:"Concorrente Exemplo 3",reason:"Sugest\xe3o baseada no segmento",followers_estimate:8e4,category:s}];return i.NextResponse.json({success:!0,competitors:l,source:"generic"})}catch(e){return console.error("Erro ao sugerir concorrentes:",e),i.NextResponse.json({error:e.message},{status:500})}}let u=new s.AppRouteRouteModule({definition:{kind:t.x.APP_ROUTE,page:"/api/ai/suggest-competitors/route",pathname:"/api/ai/suggest-competitors",filename:"route",bundlePath:"app/api/ai/suggest-competitors/route"},resolvedPagePath:"C:\\Users\\User\\Downloads\\valle-360-main\\valle-360-main\\src\\app\\api\\ai\\suggest-competitors\\route.ts",nextConfigOutput:"standalone",userland:r}),{requestAsyncStorage:p,staticGenerationAsyncStorage:d,serverHooks:g}=u,f="/api/ai/suggest-competitors/route";function x(){return(0,n.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:d})}}};var a=require("../../../../webpack-runtime.js");a.C(e);var o=e=>a(a.s=e),r=a.X(0,[89276,55972,54128,20958],()=>o(17347));module.exports=r})();