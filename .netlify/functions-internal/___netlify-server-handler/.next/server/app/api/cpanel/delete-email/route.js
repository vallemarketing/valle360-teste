"use strict";(()=>{var e={};e.id=5736,e.ids=[5736],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},73644:(e,s,t)=>{t.r(s),t.d(s,{originalPathname:()=>f,patchFetch:()=>P,requestAsyncStorage:()=>m,routeModule:()=>p,serverHooks:()=>g,staticGenerationAsyncStorage:()=>x});var o={};t.r(o),t.d(o,{POST:()=>d,dynamic:()=>u});var r=t(49303),n=t(88716),a=t(60670),i=t(87070),l=t(20344),c=t(71615);let u="force-dynamic";async function d(e){try{let s=(0,c.cookies)(),t=(0,l.createRouteHandlerClient)({cookies:()=>s}),{data:o}=await t.auth.getUser();if(!o.user?.id)return i.NextResponse.json({error:"N\xe3o autorizado"},{status:401});let{data:r,error:n}=await t.rpc("is_admin");if(n||!r)return i.NextResponse.json({error:"Acesso negado (admin)"},{status:403});let{email:a}=await e.json();if(!a)return i.NextResponse.json({error:"Email \xe9 obrigat\xf3rio"},{status:400});let[u,d]=a.split("@");if(!u||!d)return i.NextResponse.json({success:!1,message:"Email inv\xe1lido (formato esperado: usuario@dominio)"},{status:400});let p=process.env.CPANEL_USER,m=process.env.CPANEL_PASSWORD,x=process.env.CPANEL_DOMAIN;if(!p||!m||!x)return console.warn("âš ï¸ Credenciais do cPanel n\xe3o configuradas"),i.NextResponse.json({success:!1,message:"Credenciais do cPanel n\xe3o configuradas",email:a,skipped:!0},{status:200});let g=Buffer.from(`${p}:${m}`).toString("base64"),f=function(e){let s=String(e||"").trim();return s?(/^https?:\/\//i.test(s)?s:`https://${s}`).replace(/\/+$/,""):""}(x),P=`${f}/execute/Email/delete_pop?email=${encodeURIComponent(u)}&domain=${encodeURIComponent(d)}`;console.log(`ðŸ—‘ï¸ Tentando deletar email no cPanel: ${a}`);let j=await fetch(P,{method:"GET",headers:{Authorization:`Basic ${g}`,"Content-Type":"application/json"}}),h=j.headers.get("content-type");if(!h||!h.includes("application/json")){let e=await j.text();return console.error("âŒ cPanel retornou HTML ao inv\xe9s de JSON:",e.substring(0,200)),i.NextResponse.json({success:!1,message:"cPanel retornou resposta inv\xe1lida. Verifique CPANEL_DOMAIN.",hint:"CPANEL_DOMAIN deve ser algo como: https://seu-servidor.com:2083",email:a,skipped:!0},{status:200})}let v=await j.json();if(v.result?.status===1||1===v.status)return console.log(`âœ… Email deletado do cPanel: ${a}`),i.NextResponse.json({success:!0,message:"Email deletado com sucesso do cPanel",email:a});{let e=v.result?.errors||v.errors||[];if(e.some(e=>e.toLowerCase().includes("does not exist")||e.toLowerCase().includes("n\xe3o existe")))return console.log(`â„¹ï¸ Email j\xe1 n\xe3o existe no cPanel: ${a}`),i.NextResponse.json({success:!0,message:"Email n\xe3o existe no cPanel (j\xe1 foi removido)",email:a});return console.error("âŒ Erro ao deletar email no cPanel:",e),i.NextResponse.json({success:!1,message:"Erro ao deletar email no cPanel",errors:e,email:a},{status:400})}}catch(e){return console.error("Erro na API de exclus\xe3o de email:",e),i.NextResponse.json({success:!1,error:e.message||"Erro desconhecido",skipped:!0},{status:500})}}let p=new r.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/cpanel/delete-email/route",pathname:"/api/cpanel/delete-email",filename:"route",bundlePath:"app/api/cpanel/delete-email/route"},resolvedPagePath:"C:\\Users\\User\\Downloads\\valle-360-main\\valle-360-main\\src\\app\\api\\cpanel\\delete-email\\route.ts",nextConfigOutput:"standalone",userland:o}),{requestAsyncStorage:m,staticGenerationAsyncStorage:x,serverHooks:g}=p,f="/api/cpanel/delete-email/route";function P(){return(0,a.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:x})}}};var s=require("../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),o=s.X(0,[89276,55972,54128,20958],()=>t(73644));module.exports=o})();