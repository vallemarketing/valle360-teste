(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5802],{80437:function(e,r,t){Promise.resolve().then(t.bind(t,10813))},42488:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(79205).Z)("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]])},98420:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(79205).Z)("building-2",[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]])},96215:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(79205).Z)("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]])},10407:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(79205).Z)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},95252:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(79205).Z)("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},96362:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(79205).Z)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]])},89345:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(79205).Z)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]])},83774:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(79205).Z)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},82718:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(79205).Z)("message-circle",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]])},13041:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(79205).Z)("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]])},73247:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(79205).Z)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},3085:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(79205).Z)("trending-down",[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]])},70525:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(79205).Z)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]])},92369:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(79205).Z)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},10813:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return j}});var a=t(57437),s=t(2265),l=t(5526),n=t(26892),o=t(92369),i=t(42488),c=t(3085),d=t(95252),u=t(73247),m=t(98420),x=t(70525),h=t(89345),p=t(13041),v=t(83774),y=t(82718),b=t(96215),f=t(96362),g=t(10407);function j(){let[e,r]=(0,s.useState)([]),[t,j]=(0,s.useState)(!0),[N,w]=(0,s.useState)(""),[k,C]=(0,s.useState)("all"),[Z,I]=(0,s.useState)("");(0,s.useEffect)(()=>{M(),S()},[]);let S=async()=>{let{data:{user:e}}=await l.supabase.auth.getUser();if(e){let{data:r}=await l.supabase.from("user_profiles").select("role").eq("user_id",e.id).single();r&&I(r.role)}},M=async()=>{try{var e;j(!0);let{data:t}=await l.supabase.auth.getSession(),a=null===(e=t.session)||void 0===e?void 0:e.access_token,s=await fetch("/api/collaborator/clients",{headers:a?{Authorization:"Bearer ".concat(a)}:{},cache:"no-store"}),n=await s.json().catch(()=>null);if(!s.ok||!(null==n?void 0:n.success))throw Error((null==n?void 0:n.error)||"Falha ao carregar clientes");let o=(Array.isArray(null==n?void 0:n.clients)?n.clients:[]).map(e=>{var r,t,a;return{id:String((null==e?void 0:e.id)||""),name:String((null==e?void 0:e.name)||"Contato"),company:String((null==e?void 0:e.company)||"Cliente"),logo:String((null==e?void 0:e.logo)||"https://api.dicebear.com/7.x/initials/svg?seed=".concat(encodeURIComponent(String((null==e?void 0:e.company)||"Cliente")))),plan:String((null==e?void 0:e.plan)||"—"),status:(null==e?void 0:e.status)||"active",lastInteraction:new Date(String((null==e?void 0:e.lastInteractionAt)||new Date().toISOString())),revenue:(null==e?void 0:e.revenue)!=null?Number(e.revenue):null,revenueKnown:!!(null==e?void 0:e.revenueKnown),performance:{trend:(null==e?void 0:null===(r=e.performance)||void 0===r?void 0:r.trend)||"stable",value:(null==e?void 0:null===(t=e.performance)||void 0===t?void 0:t.value)!=null?Number(e.performance.value):null,score:(null==e?void 0:null===(a=e.performance)||void 0===a?void 0:a.score)!=null?Number(e.performance.score):null},email:String((null==e?void 0:e.email)||""),phone:String((null==e?void 0:e.phone)||""),location:String((null==e?void 0:e.location)||"—"),website:(null==e?void 0:e.website)?String(e.website):null}});r(o)}catch(e){console.error("Erro ao carregar clientes:",e),r([])}finally{j(!1)}},E=e.filter(e=>{let r=e.name.toLowerCase().includes(N.toLowerCase())||e.company.toLowerCase().includes(N.toLowerCase()),t="all"===k||e.status===k;return r&&t}),_=e=>{switch(e){case"active":return{bg:"var(--success-50)",text:"var(--success-700)",border:"var(--success-200)"};case"at_risk":return{bg:"var(--warning-50)",text:"var(--warning-700)",border:"var(--warning-200)"};case"inactive":return{bg:"var(--text-tertiary)",text:"var(--text-secondary)",border:"var(--border-light)"}}},R=e=>{switch(e){case"active":return"Ativo";case"at_risk":return"Em Risco";case"inactive":return"Inativo"}},A=["admin","financeiro","super_admin"].includes(Z);return t?(0,a.jsx)("div",{className:"min-h-[calc(100vh-73px)] flex items-center justify-center",style:{backgroundColor:"var(--bg-secondary)"},children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 mx-auto",style:{borderColor:"var(--primary-500)"}}),(0,a.jsx)("p",{className:"mt-4",style:{color:"var(--text-secondary)"},children:"Carregando clientes..."})]})}):(0,a.jsx)("div",{className:"min-h-[calc(100vh-73px)] p-6",style:{backgroundColor:"var(--bg-secondary)"},children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-2",style:{color:"var(--text-primary)"},children:"Meus Clientes"}),(0,a.jsx)("p",{className:"text-sm",style:{color:"var(--text-secondary)"},children:"Gerencie e acompanhe seus clientes atribu\xeddos"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-".concat(A?"4":"3"," gap-4"),children:[(0,a.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"rounded-xl p-6",style:{backgroundColor:"var(--bg-primary)",borderWidth:"1px",borderColor:"var(--border-light)"},children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"text-sm",style:{color:"var(--text-secondary)"},children:"Total de Clientes"}),(0,a.jsx)(o.Z,{className:"w-5 h-5",style:{color:"var(--primary-500)"}})]}),(0,a.jsx)("p",{className:"text-3xl font-bold",style:{color:"var(--text-primary)"},children:e.length})]}),(0,a.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"rounded-xl p-6",style:{backgroundColor:"var(--bg-primary)",borderWidth:"1px",borderColor:"var(--border-light)"},children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"text-sm",style:{color:"var(--text-secondary)"},children:"Ativos"}),(0,a.jsx)(i.Z,{className:"w-5 h-5",style:{color:"var(--success-500)"}})]}),(0,a.jsx)("p",{className:"text-3xl font-bold",style:{color:"var(--text-primary)"},children:e.filter(e=>"active"===e.status).length})]}),(0,a.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"rounded-xl p-6",style:{backgroundColor:"var(--bg-primary)",borderWidth:"1px",borderColor:"var(--border-light)"},children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"text-sm",style:{color:"var(--text-secondary)"},children:"Em Risco"}),(0,a.jsx)(c.Z,{className:"w-5 h-5",style:{color:"var(--warning-500)"}})]}),(0,a.jsx)("p",{className:"text-3xl font-bold",style:{color:"var(--text-primary)"},children:e.filter(e=>"at_risk"===e.status).length})]}),A&&(0,a.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"rounded-xl p-6",style:{backgroundColor:"var(--bg-primary)",borderWidth:"1px",borderColor:"var(--border-light)"},children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"text-sm",style:{color:"var(--text-secondary)"},children:"Receita Total"}),(0,a.jsx)(d.Z,{className:"w-5 h-5",style:{color:"var(--success-500)"}})]}),(0,a.jsxs)("p",{className:"text-3xl font-bold",style:{color:"var(--text-primary)"},children:["R$ ",e.reduce((e,r)=>e+Number(r.revenue||0),0).toLocaleString("pt-BR")]})]})]}),(0,a.jsx)("div",{className:"rounded-xl p-4",style:{backgroundColor:"var(--bg-primary)",borderWidth:"1px",borderColor:"var(--border-light)"},children:(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(u.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5",style:{color:"var(--text-tertiary)"}}),(0,a.jsx)("input",{type:"text",value:N,onChange:e=>w(e.target.value),placeholder:"Buscar por nome ou empresa...",className:"w-full pl-10 pr-4 py-3 rounded-xl border focus:outline-none focus:ring-2",style:{backgroundColor:"var(--bg-secondary)",borderColor:"var(--border-light)",color:"var(--text-primary)"}})]}),(0,a.jsxs)("select",{value:k,onChange:e=>C(e.target.value),className:"px-4 py-3 rounded-xl border focus:outline-none focus:ring-2",style:{backgroundColor:"var(--bg-secondary)",borderColor:"var(--border-light)",color:"var(--text-primary)"},children:[(0,a.jsx)("option",{value:"all",children:"Todos os Status"}),(0,a.jsx)("option",{value:"active",children:"Ativos"}),(0,a.jsx)("option",{value:"at_risk",children:"Em Risco"}),(0,a.jsx)("option",{value:"inactive",children:"Inativos"})]})]})}),(0,a.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:E.map((e,r)=>(0,a.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*r},className:"rounded-xl p-6 border hover:shadow-lg transition-all cursor-pointer group",style:{backgroundColor:"var(--bg-primary)",borderColor:"var(--border-light)"},children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("img",{src:e.logo,alt:e.company,className:"w-16 h-16 rounded-xl object-cover"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-bold mb-1",style:{color:"var(--text-primary)"},children:e.name}),(0,a.jsxs)("p",{className:"text-sm flex items-center gap-1",style:{color:"var(--text-secondary)"},children:[(0,a.jsx)(m.Z,{className:"w-4 h-4"}),e.company]})]})]}),(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold",style:{backgroundColor:_(e.status).bg,color:_(e.status).text,borderWidth:"1px",borderColor:_(e.status).border},children:R(e.status)})]}),(0,a.jsxs)("div",{className:"grid grid-cols-".concat(A?"2":"1"," gap-4 mb-4 pb-4 border-b"),style:{borderColor:"var(--border-light)"},children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs mb-1",style:{color:"var(--text-tertiary)"},children:"Plano"}),(0,a.jsx)("p",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:e.plan})]}),A&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs mb-1",style:{color:"var(--text-tertiary)"},children:"Receita Mensal"}),(0,a.jsx)("p",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:e.revenueKnown?"R$ ".concat(Number(e.revenue||0).toLocaleString("pt-BR")):"—"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs mb-1",style:{color:"var(--text-tertiary)"},children:"\xdaltima Intera\xe7\xe3o"}),(0,a.jsxs)("p",{className:"text-sm",style:{color:"var(--text-secondary)"},children:[Math.floor((Date.now()-e.lastInteraction.getTime())/864e5),"d atr\xe1s"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs mb-1",style:{color:"var(--text-tertiary)"},children:"Performance"}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[null==e.performance.value&&null==e.performance.score&&(0,a.jsx)("span",{className:"text-sm",style:{color:"var(--text-secondary)"},children:"—"}),"up"===e.performance.trend&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.Z,{className:"w-4 h-4",style:{color:"var(--success-500)"}}),(0,a.jsx)("span",{className:"text-sm font-semibold",style:{color:"var(--success-600)"},children:null!=e.performance.value?"+".concat(e.performance.value,"%"):"↑"})]}),"down"===e.performance.trend&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.Z,{className:"w-4 h-4",style:{color:"var(--error-500)"}}),(0,a.jsx)("span",{className:"text-sm font-semibold",style:{color:"var(--error-600)"},children:null!=e.performance.value?"".concat(e.performance.value,"%"):"↓"})]}),"stable"===e.performance.trend&&(0,a.jsx)("span",{className:"text-sm",style:{color:"var(--text-secondary)"},children:"Est\xe1vel"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",style:{color:"var(--text-secondary)"},children:[(0,a.jsx)(h.Z,{className:"w-4 h-4"}),e.email]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",style:{color:"var(--text-secondary)"},children:[(0,a.jsx)(p.Z,{className:"w-4 h-4"}),e.phone]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",style:{color:"var(--text-secondary)"},children:[(0,a.jsx)(v.Z,{className:"w-4 h-4"}),e.location]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("button",{onClick:()=>window.location.href="/colaborador/mensagens",className:"flex-1 px-4 py-2 rounded-lg flex items-center justify-center gap-2 text-sm font-medium transition-all hover:scale-105",style:{backgroundColor:"var(--bg-secondary)",color:"var(--text-primary)"},children:[(0,a.jsx)(y.Z,{className:"w-4 h-4"}),"Mensagem"]}),(0,a.jsxs)("button",{onClick:()=>window.location.href="/colaborador/kanban",className:"flex-1 px-4 py-2 rounded-lg flex items-center justify-center gap-2 text-sm font-medium transition-all hover:scale-105",style:{backgroundColor:"var(--bg-secondary)",color:"var(--text-primary)"},children:[(0,a.jsx)(b.Z,{className:"w-4 h-4"}),"Relat\xf3rio"]}),(0,a.jsx)("button",{onClick:()=>{e.website?window.open(e.website,"_blank"):window.location.href="/colaborador/kanban"},className:"px-4 py-2 rounded-lg flex items-center justify-center transition-all hover:scale-105",style:{backgroundColor:"var(--primary-50)",color:"var(--primary-700)"},children:e.website?(0,a.jsx)(f.Z,{className:"w-5 h-5"}):(0,a.jsx)(g.Z,{className:"w-5 h-5"})})]})]},e.id))}),0===E.length&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(o.Z,{className:"w-16 h-16 mx-auto mb-4",style:{color:"var(--text-tertiary)"}}),(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:"Nenhum cliente encontrado"}),(0,a.jsx)("p",{className:"text-sm",style:{color:"var(--text-secondary)"},children:"Tente ajustar os filtros ou a busca"})]})]})})}},5526:function(e,r,t){"use strict";t.r(r),t.d(r,{supabase:function(){return n}});var a=t(62724);let s="https://ikjgsqtykkhqimypacro.supabase.co",l="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlramdzcXR5a2tocWlteXBhY3JvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMyMTE4OTksImV4cCI6MjA3ODc4Nzg5OX0.vgVCpFIt-5ajFhcXg65dqrEw915pqW8fGZ8xgJxrnxI";s&&l||console.error("❌ ERRO CR\xcdTICO: Vari\xe1veis de ambiente NEXT_PUBLIC_SUPABASE_URL ou NEXT_PUBLIC_SUPABASE_ANON_KEY n\xe3o encontradas!");let n=(0,a.eI)(s||"https://setup-missing.supabase.co",l||"setup-missing",{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}})}},function(e){e.O(0,[2882,4609,2724,2971,2117,1744],function(){return e(e.s=80437)}),_N_E=e.O()}]);