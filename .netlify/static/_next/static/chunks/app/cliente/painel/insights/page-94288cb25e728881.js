(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7627],{53651:function(e,t,a){Promise.resolve().then(a.bind(a,14991))},32660:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(79205).Z)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},10407:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(79205).Z)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},41671:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(79205).Z)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},96362:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(79205).Z)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]])},25846:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(79205).Z)("lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]])},51817:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(79205).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},82023:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(79205).Z)("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]])},37157:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(79205).Z)("thumbs-down",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]])},70525:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(79205).Z)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]])},76865:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(79205).Z)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},11239:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(79205).Z)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]])},27648:function(e,t,a){"use strict";a.d(t,{default:function(){return s.a}});var r=a(72972),s=a.n(r)},14991:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return v}});var r=a(57437),s=a(26892),l=a(27648),i=a(2265),n=a(25846),o=a(70525),d=a(76865),c=a(11239),x=a(32660),h=a(82023),m=a(51817),u=a(96362),p=a(41671),b=a(10407),g=a(37157),f=a(93448);let y={oportunidade:{icon:n.Z,color:"text-emerald-600",bgColor:"bg-emerald-500",label:"Oportunidade"},melhoria:{icon:o.Z,color:"text-[#1672d6]",bgColor:"bg-[#1672d6]",label:"Melhoria"},alerta:{icon:d.Z,color:"text-primary",bgColor:"bg-primary",label:"Alerta"},tendencia:{icon:c.Z,color:"text-purple-600",bgColor:"bg-purple-500",label:"Tend\xeancia"}},j={alta:{color:"bg-red-500/10 text-red-600",label:"Alta"},media:{color:"bg-yellow-500/10 text-yellow-600",label:"M\xe9dia"},baixa:{color:"bg-gray-500/10 text-gray-600",label:"Baixa"}},w={novo:{color:"bg-[#1672d6]/10 text-[#1672d6]",label:"Novo"},em_analise:{color:"bg-yellow-500/10 text-yellow-600",label:"Em An\xe1lise"},implementado:{color:"bg-emerald-500/10 text-emerald-600",label:"Implementado"},ignorado:{color:"bg-gray-500/10 text-gray-600",label:"Ignorado"}};function v(){let[e,t]=(0,i.useState)("all"),[a,n]=(0,i.useState)(!0),[o,c]=(0,i.useState)(!1),[v,k]=(0,i.useState)(null),[N,Z]=(0,i.useState)(null),[z,M]=(0,i.useState)([]),[A,C]=(0,i.useState)(null),E=async()=>{n(!0),k(null);try{let e=await fetch("/api/client/insights"),t=await e.json().catch(()=>null);if(!e.ok)throw Error((null==t?void 0:t.error)||"Falha ao carregar insights");if((null==t?void 0:t.warning)==="missing_table_client_ai_insights"){Z(String((null==t?void 0:t.instruction)||"Banco ainda n\xe3o preparado para Insights IA.")),M([]);return}M(Array.isArray(null==t?void 0:t.insights)?t.insights:[])}catch(e){k(String((null==e?void 0:e.message)||"Erro ao carregar"))}finally{n(!1)}};(0,i.useEffect)(()=>{E()},[]);let I=(0,i.useMemo)(()=>z.filter(t=>"all"===e||t.status===e),[z,e]),S=(0,i.useMemo)(()=>({total:z.length,implementados:z.filter(e=>"implementado"===e.status).length,alta:z.filter(e=>"alta"===e.priority&&"novo"===e.status).length}),[z]),_=(0,i.useMemo)(()=>{let e=z.find(e=>"novo"===e.status&&"alta"===e.priority)||z[0];if(!e)return null;let t=z.filter(e=>"novo"===e.status).length;return{count:z.length,countNew:t,urgentTitle:e.title}},[z]),q=async()=>{c(!0),Z(null),k(null);try{let e=await fetch("/api/client/insights",{method:"POST"}),t=await e.json().catch(()=>null);if(!e.ok)throw Error((null==t?void 0:t.error)||"Falha ao gerar insights");(null==t?void 0:t.skipped)?Z("J\xe1 existem insights gerados hoje (".concat(t.existingCount,").")):Z("Insights gerados com sucesso: ".concat(Number((null==t?void 0:t.created)||0),".")),await E()}catch(e){k(String((null==e?void 0:e.message)||"Erro ao gerar"))}finally{c(!1)}},T=async(e,t)=>{C(e),k(null);try{let a=await fetch("/api/client/insights",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,status:t})}),r=await a.json().catch(()=>null);if(!a.ok)throw Error((null==r?void 0:r.error)||"Falha ao atualizar status");M(a=>a.map(a=>a.id===e?{...a,status:t}:a))}catch(e){k(String((null==e?void 0:e.message)||"Erro ao atualizar"))}finally{C(null)}};return(0,r.jsxs)("div",{className:"p-4 lg:p-6 space-y-6 max-w-7xl mx-auto",children:[(0,r.jsxs)(s.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,r.jsx)(l.default,{href:"/cliente/painel",className:"p-2 rounded-lg bg-[#001533]/5 hover:bg-[#001533]/10 transition-colors",children:(0,r.jsx)(x.Z,{className:"size-5 text-[#001533] dark:text-white"})}),(0,r.jsx)("div",{className:"p-2 rounded-lg bg-gradient-to-br from-emerald-500 to-emerald-600",children:(0,r.jsx)(h.Z,{className:"size-5 text-white"})}),(0,r.jsx)("h1",{className:"text-3xl font-bold text-[#001533] dark:text-white",children:"Insights IA"})]}),(0,r.jsx)("p",{className:"text-[#001533]/60 dark:text-white/60 ml-12",children:"Recomenda\xe7\xf5es personalizadas da Val para seu neg\xf3cio (com fontes)"})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:()=>void E(),disabled:a||o,className:(0,f.cn)("px-4 py-3 rounded-xl font-semibold transition-colors","border-2 border-[#001533]/10 dark:border-white/10","text-[#001533] dark:text-white hover:bg-[#001533]/5 dark:hover:bg-white/5","disabled:opacity-50 disabled:cursor-not-allowed"),children:"Atualizar"}),(0,r.jsx)("button",{onClick:()=>void q(),disabled:a||o,className:(0,f.cn)("px-4 py-3 rounded-xl font-semibold transition-colors","bg-[#1672d6] text-white hover:bg-[#1260b5]","disabled:opacity-50 disabled:cursor-not-allowed"),children:o?(0,r.jsxs)("span",{className:"inline-flex items-center gap-2",children:[(0,r.jsx)(m.Z,{className:"size-4 animate-spin"})," Gerando…"]}):"Gerar insights (hoje)"})]})]}),(N||v)&&(0,r.jsxs)("div",{className:(0,f.cn)("rounded-xl border p-4 text-sm flex items-start gap-2",v?"border-red-200 bg-red-50 text-red-700":"border-[#001533]/10 bg-[#001533]/5 text-[#001533]"),children:[(0,r.jsx)(d.Z,{className:"size-4 mt-0.5"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium",children:v?"Aten\xe7\xe3o":"Info"}),(0,r.jsx)("p",{className:"mt-1 opacity-80",children:v||N})]})]}),(0,r.jsxs)(s.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:(0,f.cn)("grid grid-cols-3 gap-4",a&&"opacity-70"),children:[(0,r.jsxs)("div",{className:"rounded-xl border-2 border-[#001533]/10 dark:border-white/10 bg-white dark:bg-[#001533]/50 p-4 text-center",children:[(0,r.jsx)("p",{className:"text-3xl font-bold text-[#001533] dark:text-white",children:S.total}),(0,r.jsx)("p",{className:"text-sm text-[#001533]/60 dark:text-white/60",children:"Total de Insights"})]}),(0,r.jsxs)("div",{className:"rounded-xl border-2 border-[#001533]/10 dark:border-white/10 bg-white dark:bg-[#001533]/50 p-4 text-center",children:[(0,r.jsx)("p",{className:"text-3xl font-bold text-emerald-600",children:S.implementados}),(0,r.jsx)("p",{className:"text-sm text-[#001533]/60 dark:text-white/60",children:"Implementados"})]}),(0,r.jsxs)("div",{className:"rounded-xl border-2 border-[#001533]/10 dark:border-white/10 bg-white dark:bg-[#001533]/50 p-4 text-center",children:[(0,r.jsx)("p",{className:"text-3xl font-bold text-[#1672d6]",children:S.alta}),(0,r.jsx)("p",{className:"text-sm text-[#001533]/60 dark:text-white/60",children:"Alta prioridade (novos)"})]})]}),(0,r.jsxs)(s.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"flex gap-2 overflow-x-auto pb-2",children:[(0,r.jsxs)("button",{onClick:()=>t("all"),className:(0,f.cn)("px-4 py-2 rounded-lg font-medium whitespace-nowrap transition-colors","all"===e?"bg-[#1672d6] text-white":"bg-[#001533]/5 dark:bg-white/5 text-[#001533] dark:text-white hover:bg-[#001533]/10 dark:hover:bg-white/10"),children:["Todos (",z.length,")"]}),Object.entries(w).map(a=>{let[s,l]=a,i=z.filter(e=>e.status===s).length;return(0,r.jsxs)("button",{onClick:()=>t(s),className:(0,f.cn)("px-4 py-2 rounded-lg font-medium whitespace-nowrap transition-colors",e===s?"bg-[#1672d6] text-white":"bg-[#001533]/5 dark:bg-white/5 text-[#001533] dark:text-white hover:bg-[#001533]/10 dark:hover:bg-white/10"),children:[l.label," (",i,")"]},s)})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[I.map((e,t)=>{let a=y[e.type],l=j[e.priority],i=w[e.status],n=a.icon,o=A===e.id,d=Array.isArray(e.sources)?e.sources.filter(Boolean):[];return(0,r.jsx)(s.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2+.03*t},className:(0,f.cn)("rounded-2xl border-2 bg-white dark:bg-[#001533]/50 overflow-hidden","alta"===e.priority?"border-red-500/30":"border-[#001533]/10 dark:border-white/10"),children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsx)("div",{className:"flex flex-col md:flex-row md:items-start justify-between gap-4",children:(0,r.jsxs)("div",{className:"flex items-start gap-4",children:[(0,r.jsx)("div",{className:(0,f.cn)("p-3 rounded-xl",a.bgColor),children:(0,r.jsx)(n,{className:"size-6 text-white"})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-2 mb-2",children:[(0,r.jsx)("span",{className:(0,f.cn)("px-2 py-0.5 rounded-full text-xs font-bold",i.color),children:i.label}),(0,r.jsxs)("span",{className:(0,f.cn)("px-2 py-0.5 rounded-full text-xs font-bold",l.color),children:["Prioridade ",l.label]}),(0,r.jsx)("span",{className:(0,f.cn)("px-2 py-0.5 rounded-full text-xs font-bold",a.color,"bg-current/10"),children:a.label})]}),(0,r.jsx)("h3",{className:"text-lg font-bold text-[#001533] dark:text-white mb-2",children:e.title}),(0,r.jsx)("p",{className:"text-[#001533]/70 dark:text-white/70",children:e.description})]})]})}),(0,r.jsxs)("div",{className:"mt-4 pt-4 border-t border-[#001533]/10 dark:border-white/10 grid md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs font-semibold text-[#001533]/60 dark:text-white/60 uppercase mb-1",children:"Impacto Estimado"}),(0,r.jsx)("p",{className:"font-bold text-[#1672d6]",children:e.impact||"—"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs font-semibold text-[#001533]/60 dark:text-white/60 uppercase mb-1",children:"A\xe7\xe3o Recomendada"}),(0,r.jsx)("p",{className:"text-[#001533] dark:text-white",children:e.action||"—"})]})]}),d.length>0&&(0,r.jsxs)("div",{className:"mt-4 pt-4 border-t border-[#001533]/10 dark:border-white/10",children:[(0,r.jsxs)("p",{className:"text-xs font-semibold text-[#001533]/60 dark:text-white/60 uppercase mb-2",children:["Fontes ",e.provider?"(".concat(e.provider,")"):""]}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:d.slice(0,8).map(e=>(0,r.jsxs)("a",{href:e,target:"_blank",rel:"noreferrer",className:"flex items-center justify-between gap-2 rounded-xl border border-[#001533]/10 dark:border-white/10 bg-white/60 dark:bg-[#001533]/30 px-3 py-2 hover:border-[#1672d6]/30 transition-colors",children:[(0,r.jsx)("span",{className:"text-xs text-[#1672d6] underline break-all",children:function(e){try{return new URL(e).hostname}catch(t){return e}}(e)}),(0,r.jsx)(u.Z,{className:"size-4 text-[#001533]/40 dark:text-white/40"})]},e))})]}),"novo"===e.status&&(0,r.jsxs)("div",{className:"mt-4 flex flex-col md:flex-row gap-3",children:[(0,r.jsxs)("button",{onClick:()=>void T(e.id,"implementado"),disabled:o,className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 rounded-xl bg-[#1672d6] text-white font-semibold hover:bg-[#1672d6]/90 transition-colors disabled:opacity-50",children:[o?(0,r.jsx)(m.Z,{className:"size-5 animate-spin"}):(0,r.jsx)(p.Z,{className:"size-5"}),"Implementar"]}),(0,r.jsxs)("button",{onClick:()=>void T(e.id,"em_analise"),disabled:o,className:"flex items-center justify-center gap-2 px-4 py-3 rounded-xl border-2 border-[#001533]/10 text-[#001533] dark:text-white hover:bg-[#001533]/5 transition-colors disabled:opacity-50",children:[(0,r.jsx)(b.Z,{className:"size-5"}),"Em an\xe1lise"]}),(0,r.jsxs)("button",{onClick:()=>void T(e.id,"ignorado"),disabled:o,className:"flex items-center justify-center gap-2 px-4 py-3 rounded-xl border-2 border-[#001533]/10 text-[#001533] dark:text-white hover:bg-[#001533]/5 transition-colors disabled:opacity-50",children:[(0,r.jsx)(g.Z,{className:"size-5"}),"Ignorar"]})]})]})},e.id)}),!a&&0===I.length&&(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)(h.Z,{className:"size-12 text-[#001533]/20 dark:text-white/20 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-[#001533]/60 dark:text-white/60",children:"Nenhum insight encontrado."}),(0,r.jsx)("button",{onClick:()=>void q(),className:"mt-4 px-4 py-3 rounded-xl bg-[#1672d6] text-white font-semibold hover:bg-[#1260b5] transition-colors",children:"Gerar insights (hoje)"})]})]}),(0,r.jsx)(s.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"rounded-2xl bg-gradient-to-r from-[#001533] to-[#1672d6] p-6",children:(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("div",{className:"p-3 rounded-xl bg-white/20",children:(0,r.jsx)(h.Z,{className:"size-8 text-white"})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h3",{className:"text-lg font-bold text-white",children:"\uD83D\uDC9C Resumo da Val"}),(0,r.jsx)("p",{className:"text-white/80 mt-1",children:_?"Hoje eu tenho ".concat(_.count," insights para voc\xea (").concat(_.countNew,' novos). O mais importante agora: "').concat(_.urgentTitle,'". Quer que eu detalhe e transforme isso em um plano de a\xe7\xe3o?'):"Gere seus insights do dia e eu te ajudo a transformar em um plano de a\xe7\xe3o."})]}),(0,r.jsx)(l.default,{href:"/cliente/ia",className:"px-6 py-3 rounded-xl bg-white text-[#001533] font-semibold hover:bg-white/90 transition-colors whitespace-nowrap",children:"Conversar"})]})})]})}},93448:function(e,t,a){"use strict";a.d(t,{cn:function(){return l},x:function(){return i}});var r=a(61994),s=a(53335);function l(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.m6)((0,r.W)(t))}function i(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}}},function(e){e.O(0,[2882,6137,2972,2971,2117,1744],function(){return e(e.s=53651)}),_N_E=e.O()}]);