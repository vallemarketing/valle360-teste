(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2209],{97531:function(e,s,t){Promise.resolve().then(t.bind(t,509))},42488:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(79205).Z)("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]])},32660:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(79205).Z)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},17580:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(79205).Z)("arrow-up-right",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]])},40370:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(79205).Z)("chart-pie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]])},3577:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(79205).Z)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]])},82431:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(79205).Z)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},509:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return k}});var a=t(57437),i=t(26892),r=t(27648),n=t(2265),l=t(32660),c=t(70525),d=t(3577),o=t(31047),m=t(82431),x=t(42208),h=t(96215),u=t(58896),p=t(28921),g=t(95252),f=t(17580),j=t(40370),v=t(42488),N=t(93448),b=t(2818);function y(e,s){return s?Math.round((e-s)/s*100):0}function w(e){return Number.isFinite(e)?e>=1e6?"".concat((e/1e6).toFixed(1),"M"):e>=1e3?"".concat((e/1e3).toFixed(1),"K"):String(Math.round(e)):"—"}function k(){let[e,s]=(0,n.useState)([]),[t,k]=(0,n.useState)(null),[Z,A]=(0,n.useState)(!1),[z,M]=(0,n.useState)(!0),[_,E]=(0,n.useState)(null),S=async()=>{M(!0),E(null);try{let e=await fetch("/api/client/social/metrics?days=365",{cache:"no-store"}),t=await e.json().catch(()=>null);if(!e.ok)throw Error((null==t?void 0:t.error)||"Falha ao carregar m\xe9tricas");s(Array.isArray(null==t?void 0:t.daily)?t.daily:[]);try{let e=await fetch("/api/client/performance?days=30",{cache:"no-store"}),s=await e.json().catch(()=>null);e.ok&&(null==s?void 0:s.success)&&(null==s?void 0:s.ads)?(A(!!s.ads.available),k(s.ads.totals||null)):(A(!1),k(null))}catch(e){A(!1),k(null)}}catch(e){s([]),E((null==e?void 0:e.message)||"Erro ao carregar m\xe9tricas")}finally{M(!1)}};(0,n.useEffect)(()=>{S()},[]);let C=(0,n.useMemo)(()=>{let s=e.slice(-30);return{impressions:s.reduce((e,s)=>e+(Number(s.impressions)||0),0),reach:s.reduce((e,s)=>e+(Number(s.reach)||0),0),engaged:s.reduce((e,s)=>e+(Number(s.engaged)||0),0),profile_views:s.reduce((e,s)=>e+(Number(s.profile_views)||0),0)}},[e]),F=(0,n.useMemo)(()=>{let s=e.slice(-14),t=s.slice(0,7),a=s.slice(7),i=(e,s)=>e.reduce((e,t)=>e+(Number(t[s])||0),0);return{impressions:y(i(a,"impressions"),i(t,"impressions")),reach:y(i(a,"reach"),i(t,"reach")),engaged:y(i(a,"engaged"),i(t,"engaged")),profile_views:y(i(a,"profile_views"),i(t,"profile_views"))}},[e]),I=(0,n.useMemo)(()=>{let s=new Map;for(let t of e){let e=new Date(String(t.date));if(Number.isNaN(e.getTime()))continue;let a="".concat(e.getUTCFullYear(),"-").concat(String(e.getUTCMonth()+1).padStart(2,"0")),i=e.toLocaleDateString("pt-BR",{month:"short"}),r=s.get(a)||{label:i,impressions:0,reach:0,engaged:0,profile_views:0};r.impressions+=Number(t.impressions||0)||0,r.reach+=Number(t.reach||0)||0,r.engaged+=Number(t.engaged||0)||0,r.profile_views+=Number(t.profile_views||0)||0,s.set(a,r)}return Array.from(s.keys()).sort().slice(-12).map(e=>({month:s.get(e).label,...s.get(e)}))},[e]),O=Math.max(1,...I.map(e=>e.impressions));return(0,a.jsxs)("div",{className:"p-4 lg:p-6 space-y-6 max-w-7xl mx-auto",children:[(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,a.jsx)(r.default,{href:"/cliente/painel",className:"p-2 rounded-lg bg-[#001533]/5 hover:bg-[#001533]/10 transition-colors",children:(0,a.jsx)(l.Z,{className:"size-5 text-[#001533] dark:text-white"})}),(0,a.jsx)("div",{className:"p-2 rounded-lg bg-gradient-to-br from-[#1672d6] to-[#1260b5]",children:(0,a.jsx)(c.Z,{className:"size-5 text-white"})}),(0,a.jsx)("h1",{className:"text-3xl font-bold text-[#001533] dark:text-white",children:"Desempenho"})]}),(0,a.jsx)("p",{className:"text-[#001533]/60 dark:text-white/60 ml-12",children:"M\xe9tricas de performance e ROI das suas campanhas"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("button",{className:"flex items-center gap-2 px-4 py-2 rounded-lg border-2 border-[#001533]/10 text-[#001533] dark:text-white hover:bg-[#001533]/5 transition-colors",children:[(0,a.jsx)(d.Z,{className:"size-4"}),"Filtrar"]}),(0,a.jsxs)("button",{className:"flex items-center gap-2 px-4 py-2 rounded-lg border-2 border-[#001533]/10 text-[#001533] dark:text-white hover:bg-[#001533]/5 transition-colors",children:[(0,a.jsx)(o.Z,{className:"size-4"}),"\xdaltimos 30 dias"]}),(0,a.jsxs)("button",{onClick:S,className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-[#1672d6] text-white hover:bg-[#1672d6]/90 transition-colors",children:[(0,a.jsx)(m.Z,{className:(0,N.cn)("size-4",z?"animate-spin":"")}),"Atualizar"]})]})]}),(0,a.jsx)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:(0,a.jsxs)(b.oy,{children:[(0,a.jsx)(b.Ai,{title:"Impress\xf5es (30d)",value:w(C.impressions),change:F.impressions,icon:(0,a.jsx)(x.Z,{className:"size-5 text-[#1672d6]"})}),(0,a.jsx)(b.Ai,{title:"Alcance (30d)",value:w(C.reach),change:F.reach,icon:(0,a.jsx)(h.Z,{className:"size-5 text-[#1672d6]"})}),(0,a.jsx)(b.Ai,{title:"Engajamento (30d)",value:w(C.engaged),change:F.engaged,icon:(0,a.jsx)(u.Z,{className:"size-5 text-[#1672d6]"})}),(0,a.jsx)(b.Ai,{title:"Visitas ao perfil (30d)",value:w(C.profile_views),change:F.profile_views,icon:(0,a.jsx)(p.Z,{className:"size-5 text-[#1672d6]"}),variant:"primary"})]})}),(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.15},className:"rounded-2xl border-2 border-[#001533]/10 dark:border-white/10 bg-white dark:bg-[#001533]/50 p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 rounded-lg bg-[#1672d6]/10",children:(0,a.jsx)(g.Z,{className:"size-5 text-[#1672d6]"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-[#001533] dark:text-white",children:"Ads (30d)"}),(0,a.jsx)("p",{className:"text-sm text-[#001533]/60 dark:text-white/60",children:Z?"M\xe9tricas consolidadas de an\xfancios":"Integra\xe7\xe3o de Ads n\xe3o conectada (ou sem dados)"})]})]}),(0,a.jsxs)(r.default,{href:"/admin/integracoes",className:"text-sm text-[#1672d6] font-medium hover:underline flex items-center gap-1",children:["Conectar Ads ",(0,a.jsx)(f.Z,{className:"size-4"})]})]}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsxs)(b.oy,{children:[(0,a.jsx)(b.Ai,{title:"Investimento",value:Z&&t?"R$ ".concat(t.total_spend.toFixed(0)):"—",change:0,icon:(0,a.jsx)(g.Z,{className:"size-5 text-[#1672d6]"})}),(0,a.jsx)(b.Ai,{title:"Cliques",value:Z&&t?w(t.total_clicks):"—",change:0,icon:(0,a.jsx)(p.Z,{className:"size-5 text-[#1672d6]"})}),(0,a.jsx)(b.Ai,{title:"Convers\xf5es",value:Z&&t?w(t.total_conversions):"—",change:0,icon:(0,a.jsx)(u.Z,{className:"size-5 text-[#1672d6]"})}),(0,a.jsx)(b.Ai,{title:"ROAS",value:Z&&t?t.avg_roas.toFixed(2):"—",change:0,icon:(0,a.jsx)(j.Z,{className:"size-5 text-[#1672d6]"}),variant:"primary"})]})})]}),(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"rounded-2xl border-2 border-[#001533]/10 dark:border-white/10 bg-white dark:bg-[#001533]/50 p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 rounded-lg bg-[#1672d6]/10",children:(0,a.jsx)(v.Z,{className:"size-5 text-[#1672d6]"})}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-[#001533] dark:text-white",children:"Evolu\xe7\xe3o (\xfaltimos 12 meses)"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-sm",children:[(0,a.jsxs)("span",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"w-3 h-3 rounded-full bg-[#1672d6]"}),"Impress\xf5es"]}),(0,a.jsxs)("span",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"w-3 h-3 rounded-full bg-emerald-500"}),"Alcance"]}),(0,a.jsxs)("span",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"w-3 h-3 rounded-full bg-purple-500"}),"Engajamento"]})]})]}),(0,a.jsx)("div",{className:"h-64 flex items-end gap-2",children:I.map((e,s)=>(0,a.jsxs)("div",{className:"flex-1 flex flex-col items-center gap-2",children:[(0,a.jsx)("div",{className:"w-full flex flex-col items-center gap-1",children:(0,a.jsx)(i.E.div,{initial:{height:0},animate:{height:"".concat(e.impressions/O*100,"%")},transition:{delay:.05*s,duration:.5},className:"w-full bg-[#1672d6]/20 rounded-t-md relative group cursor-pointer hover:bg-[#1672d6]/30 transition-colors",style:{minHeight:20},children:(0,a.jsx)("div",{className:"absolute -top-8 left-1/2 -translate-x-1/2 opacity-0 group-hover:opacity-100 transition-opacity bg-[#001533] text-white text-xs px-2 py-1 rounded whitespace-nowrap",children:w(e.impressions)})})}),(0,a.jsx)("span",{className:"text-xs text-[#001533]/60 dark:text-white/60",children:e.month})]},e.month))})]}),(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"rounded-2xl border-2 border-[#001533]/10 dark:border-white/10 bg-white dark:bg-[#001533]/50 overflow-hidden",children:[(0,a.jsx)("div",{className:"p-6 border-b border-[#001533]/10 dark:border-white/10",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 rounded-lg bg-[#1672d6]/10",children:(0,a.jsx)(h.Z,{className:"size-5 text-[#1672d6]"})}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-[#001533] dark:text-white",children:"Status das m\xe9tricas"})]}),(0,a.jsxs)(r.default,{href:"/cliente/redes",className:"text-sm text-[#1672d6] font-medium hover:underline flex items-center gap-1",children:["Conectar redes ",(0,a.jsx)(f.Z,{className:"size-4"})]})]})}),(0,a.jsxs)("div",{className:"p-6 space-y-2 text-sm text-[#001533]/70 dark:text-white/70",children:[z?(0,a.jsx)("p",{children:"Carregando m\xe9tricas..."}):_?(0,a.jsx)("p",{className:"text-red-600 dark:text-red-400",children:_}):0===e.length?(0,a.jsxs)("p",{children:["Sem dados ainda. Conecte suas redes em ",(0,a.jsx)("span",{className:"font-medium",children:"Cliente → Redes"})," para come\xe7ar a coletar m\xe9tricas."]}):(0,a.jsx)("p",{children:"M\xe9tricas carregadas com sucesso. Os n\xfameros acima s\xe3o agregados de Instagram/Facebook (quando conectados)."}),(0,a.jsx)("p",{className:"text-xs text-[#001533]/50 dark:text-white/50",children:"Observa\xe7\xe3o: dados de “campanhas/ROI” exigem integra\xe7\xf5es de Ads/Analytics. Aqui mostramos m\xe9tricas org\xe2nicas das redes conectadas."})]})]})]})}}},function(e){e.O(0,[2882,6137,2972,3145,3281,5165,4900,8819,2971,2117,1744],function(){return e(e.s=97531)}),_N_E=e.O()}]);