(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2936],{91359:function(e,r,a){Promise.resolve().then(a.bind(a,46369))},94766:function(e,r,a){"use strict";a.d(r,{Z:function(){return t}});let t=(0,a(79205).Z)("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]])},98420:function(e,r,a){"use strict";a.d(r,{Z:function(){return t}});let t=(0,a(79205).Z)("building-2",[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]])},30401:function(e,r,a){"use strict";a.d(r,{Z:function(){return t}});let t=(0,a(79205).Z)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},10407:function(e,r,a){"use strict";a.d(r,{Z:function(){return t}});let t=(0,a(79205).Z)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},91723:function(e,r,a){"use strict";a.d(r,{Z:function(){return t}});let t=(0,a(79205).Z)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},48736:function(e,r,a){"use strict";a.d(r,{Z:function(){return t}});let t=(0,a(79205).Z)("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},65621:function(e,r,a){"use strict";a.d(r,{Z:function(){return t}});let t=(0,a(79205).Z)("history",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]])},82431:function(e,r,a){"use strict";a.d(r,{Z:function(){return t}});let t=(0,a(79205).Z)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},73247:function(e,r,a){"use strict";a.d(r,{Z:function(){return t}});let t=(0,a(79205).Z)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},82023:function(e,r,a){"use strict";a.d(r,{Z:function(){return t}});let t=(0,a(79205).Z)("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]])},38866:function(e,r,a){"use strict";a.d(r,{Z:function(){return t}});let t=(0,a(79205).Z)("toggle-left",[["circle",{cx:"9",cy:"12",r:"3",key:"u3jwor"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]])},95805:function(e,r,a){"use strict";a.d(r,{Z:function(){return t}});let t=(0,a(79205).Z)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},32489:function(e,r,a){"use strict";a.d(r,{Z:function(){return t}});let t=(0,a(79205).Z)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},46369:function(e,r,a){"use strict";a.r(r),a.d(r,{default:function(){return _}});var t=a(57437),s=a(2265),n=a(26892),i=a(82431),c=a(38866),d=a(94766),l=a(95805),o=a(91723),u=a(48736),x=a(73247),m=a(10407),g=a(65621),h=a(30401),f=a(32489),b=a(82023),y=a(98420),p=a(93448),v=a(5526),j=a(45879);function _(){let[e,r]=(0,s.useState)("clients"),[a,_]=(0,s.useState)([]),[w,N]=(0,s.useState)([]),[k,Z]=(0,s.useState)([]),[q,S]=(0,s.useState)(null),[M,E]=(0,s.useState)([]),[C,I]=(0,s.useState)([]),[O,A]=(0,s.useState)([]),[D,L]=(0,s.useState)(""),[U,B]=(0,s.useState)(!0),[R,z]=(0,s.useState)(!1),[F,X]=(0,s.useState)(!1);(0,s.useEffect)(()=>{H()},[]);let H=async()=>{B(!0);try{let[e,r,a]=await Promise.all([(0,j.Cq)(),(0,j.UV)(),(0,j.oY)()]);_(e),N(r),I(a);let{data:t}=await v.supabase.from("clients").select("id, company_name, fantasy_name, cnpj, status").order("company_name");Z(t||[])}catch(e){console.error("Erro ao carregar dados:",e)}finally{B(!1)}},P=async e=>{S(e),E(await (0,j.zx)(e.id)),A(await (0,j.a8)(e.id))},J=async(e,r)=>{if(q){z(!0);try{let{data:{user:a}}=await v.supabase.auth.getUser();if(!a)return;(await (0,j.hX)(q.id,e,r,a.id,r?"Habilitado manualmente":"Desabilitado manualmente")).success&&await P(q)}catch(e){console.error("Erro ao alterar feature:",e)}finally{z(!1)}}},V=async e=>{z(!0);try{let{data:{user:r}}=await v.supabase.auth.getUser();if(!r)return;(await (0,j.o$)(e,r.id,"Aprovado")).success&&(await H(),q&&await P(q))}catch(e){console.error("Erro ao aprovar:",e)}finally{z(!1)}},T=async(e,r)=>{z(!0);try{let{data:{user:a}}=await v.supabase.auth.getUser();if(!a)return;(await (0,j.r5)(e,a.id,r||"N\xe3o aprovado")).success&&await H()}catch(e){console.error("Erro ao rejeitar:",e)}finally{z(!1)}},Y=k.filter(e=>{var r,a,t;return(null===(r=e.company_name)||void 0===r?void 0:r.toLowerCase().includes(D.toLowerCase()))||(null===(a=e.fantasy_name)||void 0===a?void 0:a.toLowerCase().includes(D.toLowerCase()))||(null===(t=e.cnpj)||void 0===t?void 0:t.includes(D))});return U?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",style:{backgroundColor:"var(--bg-secondary)"},children:(0,t.jsx)(i.Z,{className:"w-8 h-8 animate-spin text-[#1672d6]"})}):(0,t.jsx)("div",{className:"min-h-screen p-6",style:{backgroundColor:"var(--bg-secondary)"},children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("div",{className:"w-14 h-14 rounded-2xl bg-gradient-to-br from-[#1672d6] to-[#001533] flex items-center justify-center",children:(0,t.jsx)(c.Z,{className:"w-7 h-7 text-white"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-[#001533] dark:text-white",children:"Feature Flags"}),(0,t.jsx)("p",{className:"text-gray-500",children:"Controle de funcionalidades por cliente"})]})]}),C.length>0&&(0,t.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2 bg-amber-100 text-amber-700 rounded-xl",children:[(0,t.jsx)(d.Z,{className:"w-5 h-5"}),(0,t.jsxs)("span",{className:"font-medium",children:[C.length," solicita\xe7\xf5es pendentes"]})]})]}),(0,t.jsx)("div",{className:"flex gap-2 border-b border-gray-200 dark:border-gray-700",children:[{id:"clients",label:"Por Cliente",icon:l.Z},{id:"requests",label:"Solicita\xe7\xf5es",icon:o.Z,badge:C.length},{id:"services",label:"Servi\xe7os x Features",icon:u.Z}].map(a=>(0,t.jsxs)("button",{onClick:()=>r(a.id),className:(0,p.cn)("flex items-center gap-2 px-4 py-3 font-medium transition-colors border-b-2 -mb-px",e===a.id?"border-[#1672d6] text-[#1672d6]":"border-transparent text-gray-500 hover:text-gray-700"),children:[(0,t.jsx)(a.icon,{className:"w-4 h-4"}),a.label,a.badge&&a.badge>0&&(0,t.jsx)("span",{className:"ml-1 px-2 py-0.5 text-xs bg-primary text-white rounded-full",children:a.badge})]},a.id))}),"clients"===e&&(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-6",children:[(0,t.jsxs)("div",{className:"col-span-1 bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[(0,t.jsx)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(x.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,t.jsx)("input",{type:"text",placeholder:"Buscar cliente...",value:D,onChange:e=>L(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-200 dark:border-gray-600 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-[#1672d6]"})]})}),(0,t.jsx)("div",{className:"max-h-[600px] overflow-y-auto",children:Y.map(e=>{var r;return(0,t.jsxs)("button",{onClick:()=>P(e),className:(0,p.cn)("w-full flex items-center gap-3 p-4 text-left transition-colors border-b border-gray-100 dark:border-gray-700",(null==q?void 0:q.id)===e.id?"bg-[#1672d6]/10":"hover:bg-gray-50 dark:hover:bg-gray-700"),children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-[#1672d6] to-[#001533] flex items-center justify-center text-white font-bold",children:(null===(r=e.company_name)||void 0===r?void 0:r.charAt(0))||"C"}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"font-medium text-gray-800 dark:text-white truncate",children:e.fantasy_name||e.company_name}),(0,t.jsx)("p",{className:"text-xs text-gray-500 truncate",children:e.cnpj})]}),(0,t.jsx)(m.Z,{className:"w-4 h-4 text-gray-400"})]},e.id)})})]}),(0,t.jsx)("div",{className:"col-span-2",children:q?(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-700",children:[(0,t.jsxs)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-bold text-gray-800 dark:text-white",children:q.fantasy_name||q.company_name}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:q.cnpj})]}),(0,t.jsxs)("button",{onClick:()=>X(!F),className:(0,p.cn)("flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm transition-colors",F?"bg-[#1672d6] text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:[(0,t.jsx)(g.Z,{className:"w-4 h-4"}),"Hist\xf3rico"]})]}),F?(0,t.jsxs)("div",{className:"p-4 max-h-[500px] overflow-y-auto",children:[(0,t.jsx)("h3",{className:"font-medium text-gray-700 dark:text-gray-300 mb-3",children:"\xdaltimas altera\xe7\xf5es"}),(0,t.jsx)("div",{className:"space-y-2",children:O.map(e=>(0,t.jsxs)("div",{className:"flex items-start gap-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[(0,t.jsx)("div",{className:(0,p.cn)("w-8 h-8 rounded-lg flex items-center justify-center","enabled"===e.action||"request_approved"===e.action?"bg-green-100 text-green-600":"disabled"===e.action||"request_rejected"===e.action?"bg-red-100 text-red-600":"bg-blue-100 text-blue-600"),children:"enabled"===e.action||"request_approved"===e.action?(0,t.jsx)(h.Z,{className:"w-4 h-4"}):"disabled"===e.action||"request_rejected"===e.action?(0,t.jsx)(f.Z,{className:"w-4 h-4"}):(0,t.jsx)(o.Z,{className:"w-4 h-4"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-800 dark:text-white",children:e.feature_code}),(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:["enabled"===e.action&&"Habilitado","disabled"===e.action&&"Desabilitado","request_created"===e.action&&"Solicita\xe7\xe3o criada","request_approved"===e.action&&"Solicita\xe7\xe3o aprovada","request_rejected"===e.action&&"Solicita\xe7\xe3o rejeitada"," • ",new Date(e.created_at).toLocaleDateString("pt-BR")]}),e.reason&&(0,t.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:e.reason})]})]},e.id))})]}):(0,t.jsx)("div",{className:"p-4 space-y-3",children:M.map(e=>{let{feature:r,status:a,enabled_by:s}=e;return(0,t.jsxs)("div",{className:(0,p.cn)("flex items-center justify-between p-4 rounded-xl border transition-colors","enabled"===a?"bg-green-50 border-green-200 dark:bg-green-900/20 dark:border-green-800":"pending"===a?"bg-yellow-50 border-yellow-200 dark:bg-yellow-900/20 dark:border-yellow-800":"bg-gray-50 border-gray-200 dark:bg-gray-700 dark:border-gray-600"),children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:(0,p.cn)("w-10 h-10 rounded-xl flex items-center justify-center","enabled"===a?"bg-green-100 text-green-600":"pending"===a?"bg-yellow-100 text-yellow-600":"bg-gray-200 text-gray-500"),children:(0,t.jsx)(b.Z,{className:"w-5 h-5"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-gray-800 dark:text-white",children:r.name}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:r.description}),"enabled"===a&&s&&(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 mt-1 px-2 py-0.5 bg-green-100 text-green-700 text-xs rounded-full",children:["contract"===s&&"Por contrato","manual"===s&&"Manual","request"===s&&"Por solicita\xe7\xe3o"]}),"pending"===a&&(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 mt-1 px-2 py-0.5 bg-yellow-100 text-yellow-700 text-xs rounded-full",children:[(0,t.jsx)(o.Z,{className:"w-3 h-3"}),"Solicita\xe7\xe3o pendente"]})]})]}),(0,t.jsx)("button",{onClick:()=>J(r.code,"enabled"!==a),disabled:R,className:(0,p.cn)("relative w-14 h-7 rounded-full transition-colors","enabled"===a?"bg-green-500":"bg-gray-300"),children:(0,t.jsx)(n.E.div,{animate:{x:"enabled"===a?28:4},className:"absolute top-1 w-5 h-5 bg-white rounded-full shadow"})})]},r.id)})})]}):(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-700 p-12 text-center",children:[(0,t.jsx)(y.Z,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-600 dark:text-gray-400",children:"Selecione um cliente"}),(0,t.jsx)("p",{className:"text-sm text-gray-400",children:"Escolha um cliente na lista para gerenciar suas funcionalidades"})]})})]}),"requests"===e&&(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-700",children:[(0,t.jsxs)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:[(0,t.jsx)("h2",{className:"text-lg font-bold text-gray-800 dark:text-white",children:"Solicita\xe7\xf5es Pendentes"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Solicita\xe7\xf5es de libera\xe7\xe3o de features feitas pelo comercial"})]}),0===C.length?(0,t.jsxs)("div",{className:"p-12 text-center",children:[(0,t.jsx)(h.Z,{className:"w-16 h-16 mx-auto text-green-300 mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-600 dark:text-gray-400",children:"Nenhuma solicita\xe7\xe3o pendente"}),(0,t.jsx)("p",{className:"text-sm text-gray-400",children:"Todas as solicita\xe7\xf5es foram processadas"})]}):(0,t.jsx)("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:C.map(e=>{var r;return(0,t.jsx)("div",{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex items-start gap-4",children:[(0,t.jsx)("div",{className:"w-12 h-12 rounded-xl bg-amber-100 flex items-center justify-center",children:(0,t.jsx)(o.Z,{className:"w-6 h-6 text-primary"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-gray-800 dark:text-white",children:(null===(r=e.feature)||void 0===r?void 0:r.name)||"Feature"}),(0,t.jsxs)("p",{className:"text-sm text-gray-500",children:["Cliente ID: ",e.client_id]}),(0,t.jsxs)("p",{className:"text-sm text-gray-500",children:["Solicitado por: ",e.requested_by_name]}),e.justification&&(0,t.jsxs)("p",{className:"text-sm text-gray-600 mt-2 p-2 bg-gray-50 rounded-lg",children:['"',e.justification,'"']}),(0,t.jsx)("p",{className:"text-xs text-gray-400 mt-2",children:new Date(e.created_at).toLocaleDateString("pt-BR",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})})]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)("button",{onClick:()=>T(e.id,""),disabled:R,className:"flex items-center gap-2 px-4 py-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 transition-colors",children:[(0,t.jsx)(f.Z,{className:"w-4 h-4"}),"Rejeitar"]}),(0,t.jsxs)("button",{onClick:()=>V(e.id),disabled:R,className:"flex items-center gap-2 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors",children:[(0,t.jsx)(h.Z,{className:"w-4 h-4"}),"Aprovar"]})]})]})},e.id)})})]}),"services"===e&&(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-700",children:[(0,t.jsxs)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:[(0,t.jsx)("h2",{className:"text-lg font-bold text-gray-800 dark:text-white",children:"Matriz Servi\xe7os x Features"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Quais features cada servi\xe7o libera automaticamente"})]}),(0,t.jsx)("div",{className:"p-4 overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"text-left p-3 bg-gray-50 dark:bg-gray-700 rounded-tl-lg font-medium text-gray-600 dark:text-gray-300",children:"Servi\xe7o"}),a.map(e=>(0,t.jsx)("th",{className:"p-3 bg-gray-50 dark:bg-gray-700 text-center font-medium text-gray-600 dark:text-gray-300 text-xs",children:(0,t.jsx)("div",{className:"flex flex-col items-center gap-1",children:(0,t.jsx)("span",{children:e.name})})},e.id))]})}),(0,t.jsx)("tbody",{children:w.map(e=>(0,t.jsxs)("tr",{className:"border-t border-gray-100 dark:border-gray-700",children:[(0,t.jsx)("td",{className:"p-3",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-gray-800 dark:text-white",children:e.name}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:e.description})]})}),a.map(r=>{var a;let s=null===(a=e.features)||void 0===a?void 0:a.some(e=>e.id===r.id);return(0,t.jsx)("td",{className:"p-3 text-center",children:s?(0,t.jsx)("div",{className:"w-6 h-6 mx-auto rounded-full bg-green-100 flex items-center justify-center",children:(0,t.jsx)(h.Z,{className:"w-4 h-4 text-green-600"})}):(0,t.jsx)("div",{className:"w-6 h-6 mx-auto rounded-full bg-gray-100 flex items-center justify-center",children:(0,t.jsx)(f.Z,{className:"w-4 h-4 text-gray-400"})})},r.id)})]},e.id))})]})})]})]})})}},45879:function(e,r,a){"use strict";a.d(r,{Cq:function(){return n},U6:function(){return s},UV:function(){return u},a8:function(){return x},hX:function(){return c},o$:function(){return l},oY:function(){return d},r5:function(){return o},zx:function(){return i}});var t=a(5526);async function s(e,r){try{let{data:a,error:s}=await t.supabase.rpc("client_has_feature",{p_client_id:e,p_feature_code:r});if(s)return console.error("Erro ao verificar feature:",s),!1;return!0===a}catch(e){return console.error("Erro ao verificar feature:",e),!1}}async function n(){let{data:e,error:r}=await t.supabase.from("features").select("*").eq("is_active",!0).order("sort_order");return r?(console.error("Erro ao buscar features:",r),[]):e||[]}async function i(e){let{data:r,error:a}=await t.supabase.from("features").select("*").eq("is_active",!0).order("sort_order");if(a||!r)return console.error("Erro ao buscar features:",a),[];let{data:s,error:n}=await t.supabase.from("client_features").select("*").eq("client_id",e);n&&console.error("Erro ao buscar features do cliente:",n);let{data:i,error:c}=await t.supabase.from("feature_requests").select("feature_id").eq("client_id",e).eq("status","pending");c&&console.error("Erro ao buscar solicita\xe7\xf5es:",c);let d=new Map((s||[]).map(e=>[e.feature_id,e])),l=new Set((i||[]).map(e=>e.feature_id));return r.map(e=>{let r=d.get(e.id),a=l.has(e.id),t="disabled";return(null==r?void 0:r.is_enabled)?(!r.expires_at||new Date(r.expires_at)>new Date)&&(t="enabled"):a&&(t="pending"),{feature:e,status:t,enabled_by:null==r?void 0:r.enabled_by,enabled_at:(null==r?void 0:r.enabled_at)||void 0,expires_at:(null==r?void 0:r.expires_at)||void 0}})}async function c(e,r,a,s,n){try{let{data:i,error:c}=await t.supabase.from("features").select("id").eq("code",r).single();if(c||!i)return{success:!1,error:"Feature n\xe3o encontrada"};let{error:d}=await t.supabase.from("client_features").upsert({client_id:e,feature_id:i.id,is_enabled:a,enabled_by:"manual",enabled_by_user_id:s,enabled_at:a?new Date().toISOString():null,notes:n},{onConflict:"client_id,feature_id"});if(d)return{success:!1,error:d.message};return await t.supabase.from("feature_logs").insert({client_id:e,feature_id:i.id,feature_code:r,action:a?"enabled":"disabled",changed_by_user_id:s,reason:n||"Altera\xe7\xe3o manual"}),{success:!0}}catch(e){return console.error("Erro ao toggle feature:",e),{success:!1,error:"Erro interno"}}}async function d(){let{data:e,error:r}=await t.supabase.from("feature_requests").select("\n      *,\n      feature:features(*)\n    ").eq("status","pending").order("created_at",{ascending:!1});return r?(console.error("Erro ao buscar solicita\xe7\xf5es:",r),[]):e||[]}async function l(e,r,a){try{let{data:s,error:n}=await t.supabase.from("feature_requests").select("client_id, feature_id").eq("id",e).single();if(n||!s)return{success:!1,error:"Solicita\xe7\xe3o n\xe3o encontrada"};let{error:i}=await t.supabase.from("feature_requests").update({status:"approved",reviewed_by_user_id:r,reviewed_at:new Date().toISOString(),review_notes:a}).eq("id",e);if(i)return{success:!1,error:i.message};let{error:c}=await t.supabase.from("client_features").upsert({client_id:s.client_id,feature_id:s.feature_id,is_enabled:!0,enabled_by:"request",enabled_by_user_id:r,enabled_at:new Date().toISOString(),notes:"Aprovado via solicita\xe7\xe3o. ".concat(a||"")},{onConflict:"client_id,feature_id"});if(c)return{success:!1,error:c.message};return await t.supabase.from("feature_logs").insert({client_id:s.client_id,feature_id:s.feature_id,action:"request_approved",changed_by_user_id:r,reason:a||"Solicita\xe7\xe3o aprovada"}),{success:!0}}catch(e){return console.error("Erro ao aprovar solicita\xe7\xe3o:",e),{success:!1,error:"Erro interno"}}}async function o(e,r,a){try{let{data:s,error:n}=await t.supabase.from("feature_requests").select("client_id, feature_id").eq("id",e).single();if(n||!s)return{success:!1,error:"Solicita\xe7\xe3o n\xe3o encontrada"};let{error:i}=await t.supabase.from("feature_requests").update({status:"rejected",reviewed_by_user_id:r,reviewed_at:new Date().toISOString(),review_notes:a}).eq("id",e);if(i)return{success:!1,error:i.message};return await t.supabase.from("feature_logs").insert({client_id:s.client_id,feature_id:s.feature_id,action:"request_rejected",changed_by_user_id:r,reason:a}),{success:!0}}catch(e){return console.error("Erro ao rejeitar solicita\xe7\xe3o:",e),{success:!1,error:"Erro interno"}}}async function u(){let{data:e,error:r}=await t.supabase.from("services").select("\n      *,\n      service_features(\n        feature:features(*)\n      )\n    ").eq("is_active",!0).order("sort_order");return r?(console.error("Erro ao buscar servi\xe7os:",r),[]):(e||[]).map(e=>{var r;return{...e,features:(null===(r=e.service_features)||void 0===r?void 0:r.map(e=>e.feature).filter(Boolean))||[]}})}async function x(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,{data:a,error:s}=await t.supabase.from("feature_logs").select("*").eq("client_id",e).order("created_at",{ascending:!1}).limit(r);return s?(console.error("Erro ao buscar logs:",s),[]):a||[]}},5526:function(e,r,a){"use strict";a.r(r),a.d(r,{supabase:function(){return i}});var t=a(62724);let s="https://ikjgsqtykkhqimypacro.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlramdzcXR5a2tocWlteXBhY3JvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMyMTE4OTksImV4cCI6MjA3ODc4Nzg5OX0.vgVCpFIt-5ajFhcXg65dqrEw915pqW8fGZ8xgJxrnxI";s&&n||console.error("❌ ERRO CR\xcdTICO: Vari\xe1veis de ambiente NEXT_PUBLIC_SUPABASE_URL ou NEXT_PUBLIC_SUPABASE_ANON_KEY n\xe3o encontradas!");let i=(0,t.eI)(s||"https://setup-missing.supabase.co",n||"setup-missing",{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}})},93448:function(e,r,a){"use strict";a.d(r,{cn:function(){return n},x:function(){return i}});var t=a(61994),s=a(53335);function n(){for(var e=arguments.length,r=Array(e),a=0;a<e;a++)r[a]=arguments[a];return(0,s.m6)((0,t.W)(r))}function i(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}}},function(e){e.O(0,[2882,6137,4609,2724,2971,2117,1744],function(){return e(e.s=91359)}),_N_E=e.O()}]);