"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8290],{88290:function(e,a,t){t.r(a),t.d(a,{default:function(){return eE}});var l=t(57437),r=t(2265),s=t(99376),i=t(10795),n=t(93662),o=t(79820),d=t(69174),c=t(12381),u=t(40279),m=t(41905),g=t(42208),x=t(88893),p=t(18930),h=t(53417),b=t(76980),v=t(30401),f=t(32489),y=t(99397),j=t(73247),N=t(59892),w=t(5526),_=t(92369);function k(e){let{selectedUserId:a,onSelect:t,label:s="Respons\xe1vel",placeholder:i="Selecione um respons\xe1vel"}=e,[n,o]=(0,r.useState)([]),[d,c]=(0,r.useState)([]),[m,g]=(0,r.useState)(!1),[x,p]=(0,r.useState)(""),[h,b]=(0,r.useState)(null),[v,y]=(0,r.useState)(!0);(0,r.useEffect)(()=>{N()},[]),(0,r.useEffect)(()=>{a&&n.length>0&&b(n.find(e=>e.user_id===a)||null)},[a,n]),(0,r.useEffect)(()=>{x?c(n.filter(e=>e.full_name.toLowerCase().includes(x.toLowerCase())||e.email.toLowerCase().includes(x.toLowerCase())||(e.department||"").toLowerCase().includes(x.toLowerCase())||(e.area_of_expertise||"").toLowerCase().includes(x.toLowerCase())||(e.areas||[]).some(e=>e.toLowerCase().includes(x.toLowerCase())))):c(n)},[x,n]);let N=async()=>{try{y(!0);let{data:e,error:a}=await w.supabase.from("employees").select("user_id, full_name, email, department, area_of_expertise, areas, is_active").eq("is_active",!0).order("full_name");if(a)throw a;o(e||[]),c(e||[])}catch(e){console.error("Erro ao carregar usu\xe1rios:",e)}finally{y(!1)}},k=e=>{b(e),t(e.user_id),g(!1),p("")},C=e=>[e.department,e.area_of_expertise].filter(Boolean).join(" • ").trim()||"Colaborador",S=()=>"bg-gray-600",D=e=>e.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2);return(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 block",children:s}),h?(0,l.jsxs)("div",{className:"flex items-center gap-2 p-2 border rounded-md bg-gray-50 dark:bg-gray-800",children:[(0,l.jsx)("div",{className:"w-8 h-8 rounded-full ".concat(S()," flex items-center justify-center text-xs text-white font-medium"),children:D(h.full_name)}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:h.full_name}),(0,l.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:C(h)})]}),(0,l.jsx)("button",{type:"button",onClick:()=>{b(null),t(void 0)},className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded",children:(0,l.jsx)(f.Z,{className:"w-4 h-4 text-gray-500"})})]}):(0,l.jsxs)("button",{type:"button",onClick:()=>g(!m),className:"w-full flex items-center gap-2 p-2 border rounded-md bg-white dark:bg-gray-800 text-left hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[(0,l.jsx)(_.Z,{className:"w-4 h-4 text-gray-400"}),(0,l.jsx)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:i})]}),m&&(0,l.jsxs)("div",{className:"absolute z-50 mt-2 w-full bg-white dark:bg-gray-800 border rounded-lg shadow-lg max-h-80 overflow-hidden",children:[(0,l.jsx)("div",{className:"p-2 border-b",children:(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(j.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,l.jsx)(u.II,{type:"text",placeholder:"Buscar por nome, email ou cargo...",value:x,onChange:e=>p(e.target.value),className:"pl-9",autoFocus:!0})]})}),(0,l.jsx)("div",{className:"overflow-y-auto max-h-64",children:v?(0,l.jsx)("div",{className:"p-4 text-center text-sm text-gray-500",children:"Carregando..."}):0===d.length?(0,l.jsx)("div",{className:"p-4 text-center text-sm text-gray-500",children:"Nenhum usu\xe1rio encontrado"}):d.map(e=>(0,l.jsxs)("button",{type:"button",onClick:()=>k(e),className:"w-full flex items-center gap-3 p-3 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[(0,l.jsx)("div",{className:"w-10 h-10 rounded-full ".concat(S()," flex items-center justify-center text-sm text-white font-medium flex-shrink-0"),children:D(e.full_name)}),(0,l.jsxs)("div",{className:"flex-1 text-left",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e.full_name}),(0,l.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:e.email}),(0,l.jsx)("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:C(e)})]})]},e.user_id))})]}),m&&(0,l.jsx)("div",{className:"fixed inset-0 z-40",onClick:()=>g(!1)})]})}var C=t(17168),S=t(64319),D=t(44743),E=t(59304),I=t(32846),q=t(61474),z=t(23993);function T(e){let{task:a,isOpen:t,onClose:s,onUpdate:i}=e,[n,d]=(0,r.useState)("comments"),[m,g]=(0,r.useState)([]),[x,p]=(0,r.useState)(""),[b,v]=(0,r.useState)(!1),[y,j]=(0,r.useState)(""),[N,_]=(0,r.useState)([]),[T,A]=(0,r.useState)(!1),[Z,P]=(0,r.useState)(""),[M,F]=(0,r.useState)(null),L=(0,r.useRef)(null),[R,O]=(0,r.useState)(new Map),[K,V]=(0,r.useState)(!1),[B,U]=(0,r.useState)(!1),[H,G]=(0,r.useState)("designer_grafico"),[Y,J]=(0,r.useState)(void 0),[$,W]=(0,r.useState)(""),[Q,X]=(0,r.useState)("");(0,r.useEffect)(()=>{t&&(et(),d("comments"),ee(),ea())},[t,null==a?void 0:a.id]);let ee=async()=>{try{var e;let{data:a}=await w.supabase.auth.getUser(),t=(null==a?void 0:null===(e=a.user)||void 0===e?void 0:e.id)?String(a.user.id):"";j(t)}catch(e){j("")}},ea=async()=>{try{let{data:e,error:a}=await w.supabase.from("employees").select("user_id, full_name, email, is_active").eq("is_active",!0).order("full_name").limit(500);if(a)throw a;let t=(e||[]).map(e=>({userId:String(e.user_id),label:String(e.full_name||"Usu\xe1rio"),email:e.email?String(e.email):void 0})).filter(e=>!!e.userId);_(t)}catch(e){console.error("Erro ao carregar candidatos de mention (employees):",e),_([])}},et=async()=>{try{let{data:e,error:t}=await w.supabase.from("kanban_task_comments").select("id, task_id, user_id, comment, created_at").eq("task_id",a.id).order("created_at",{ascending:!0});if(t)throw t;let l=Array.from(new Set((e||[]).map(e=>e.user_id))).filter(Boolean),r=new Map;if(l.length>0){let e=await (0,E.m)(w.supabase,l);l.forEach(a=>{var t;let l=null===(t=e.get(a))||void 0===t?void 0:t.full_name;l&&r.set(a,l)})}let s=(e||[]).map(e=>({...e,user_name:r.get(e.user_id)||"Usu\xe1rio"}));g(s);try{let a=Array.from(new Set((e||[]).flatMap(e=>(0,q.MN)(String(e.comment||"")))));if(a.length>0){let e=await (0,E.m)(w.supabase,a);O(e)}}catch(e){}}catch(e){console.error("Erro ao carregar coment\xe1rios:",e)}},el=(0,r.useMemo)(()=>(0,z.X)(N,Z),[N,Z]),er=()=>{let e=L.current;if(!e)return;let a=String(e.value||""),t="number"==typeof e.selectionStart?e.selectionStart:a.length,l=(0,q.XI)(a,t);if(!l.active){A(!1),P(""),F(null);return}A(!0),P(l.query),F({start:l.startIndex,end:l.endIndex})},es=e=>{let a=L.current;if(!a||!M)return;let t=String(a.value||""),{nextValue:l,nextCaretIndex:r}=(0,q.CE)({value:t,startIndex:M.start,endIndex:M.end,userId:e.userId,trailingSpace:!0});p(l),A(!1),P(""),F(null),requestAnimationFrame(()=>{try{a.focus(),a.setSelectionRange(r,r)}catch(e){}})},ei=async e=>{if(e.preventDefault(),x.trim()){v(!0);try{let{data:e}=await w.supabase.auth.getUser(),t=null==e?void 0:e.user;if(!t)throw Error("Usu\xe1rio n\xe3o autenticado");let{data:l,error:r}=await w.supabase.from("kanban_task_comments").insert({task_id:a.id,user_id:t.id,comment:x.trim()}).select("id").single();if(r)throw r;if(null==l?void 0:l.id)try{await fetch("/api/mentions/process",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({entityType:"kanban_task_comment",entityId:l.id,taskId:a.id})})}catch(e){}p(""),await et(),i()}catch(e){console.error("Erro ao comentar:",e),alert((null==e?void 0:e.message)||"Erro ao comentar")}finally{v(!1)}}},en=async()=>{let e=x.trim();if(e){v(!0);try{let{data:t}=await w.supabase.auth.getUser(),l=null==t?void 0:t.user;if(!l)throw Error("Usu\xe1rio n\xe3o autenticado");let{data:r,error:s}=await w.supabase.from("kanban_task_comments").insert({task_id:a.id,user_id:l.id,comment:e}).select("id").single();if(s)throw s;if(null==r?void 0:r.id)try{await fetch("/api/mentions/process",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({entityType:"kanban_task_comment",entityId:r.id,taskId:a.id})})}catch(e){}p(""),await et(),i();let n=await fetch("/api/kanban/handoff",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"message_origin",taskId:a.id,message:e})}),o=await n.json();if(!n.ok||!(null==o?void 0:o.success)){alert((null==o?void 0:o.error)||"Coment\xe1rio salvo, mas n\xe3o consegui notificar o solicitante.");return}alert("Mensagem enviada ao solicitante.")}catch(e){console.error("Erro ao perguntar ao solicitante:",e),alert((null==e?void 0:e.message)||"Erro ao perguntar ao solicitante")}finally{v(!1)}}},eo=async()=>{try{let e=await fetch("/api/kanban/handoff",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"forward",sourceTaskId:a.id,targetAreaKey:H,targetUserId:Y,note:$||void 0})}),t=await e.json();if(!e.ok||!(null==t?void 0:t.success)){alert((null==t?void 0:t.error)||"Erro ao encaminhar");return}alert("Encaminhado com sucesso."),V(!1),W(""),J(void 0),i()}catch(e){alert((null==e?void 0:e.message)||"Erro ao encaminhar")}},ed=async()=>{try{let e=await fetch("/api/kanban/handoff",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"return",taskId:a.id,note:Q||void 0})}),t=await e.json();if(!e.ok||!(null==t?void 0:t.success)){alert((null==t?void 0:t.error)||"Erro ao enviar para o Head");return}alert("Enviado para o Head com sucesso."),U(!1),X(""),i()}catch(e){alert((null==e?void 0:e.message)||"Erro ao enviar para o Head")}};return t?(0,l.jsxs)("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4",children:[(0,l.jsxs)(o.Zb,{className:"w-full max-w-3xl max-h-[90vh] overflow-hidden flex flex-col",children:[(0,l.jsxs)(o.Ol,{className:"border-b",children:[(0,l.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,l.jsxs)("div",{className:"min-w-0",children:[(0,l.jsx)(o.ll,{className:"text-xl",children:a.title}),a.description&&(0,l.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2 whitespace-pre-wrap",children:a.description})]}),(0,l.jsx)(c.z,{variant:"ghost",size:"sm",onClick:s,children:(0,l.jsx)(f.Z,{className:"w-5 h-5"})})]}),(0,l.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,l.jsx)(c.z,{variant:"outline",onClick:()=>V(!0),children:"Encaminhar"}),(0,l.jsx)(c.z,{className:"bg-primary hover:bg-[#1260b5]",onClick:()=>U(!0),children:"Enviar para Head"})]})]}),(0,l.jsxs)(o.aY,{className:"flex-1 overflow-y-auto p-4",children:[(0,l.jsx)(C.mQ,{value:n,onValueChange:e=>d(e),children:(0,l.jsx)(C.dr,{children:(0,l.jsx)(C.SP,{value:"comments",children:(0,l.jsxs)("span",{className:"inline-flex items-center gap-2",children:[(0,l.jsx)(h.Z,{className:"w-4 h-4"}),"Coment\xe1rios"]})})})}),(0,l.jsxs)("div",{className:"mt-4 space-y-4",children:[(0,l.jsx)("div",{className:"space-y-3",children:0===m.length?(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Nenhum coment\xe1rio ainda"}):m.map(e=>(0,l.jsxs)("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e.user_name||"Usu\xe1rio"}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:new Date(e.created_at).toLocaleString("pt-BR")})]}),(0,l.jsx)("p",{className:"text-sm text-gray-700 dark:text-gray-300 mt-2 whitespace-pre-wrap",children:(0,l.jsx)(I.d,{text:e.comment,profilesById:R,highlightUserId:y||void 0})})]},e.id))}),(0,l.jsxs)("form",{onSubmit:ei,className:"flex gap-2 items-start",children:[(0,l.jsxs)("div",{className:"relative flex-1",children:[(0,l.jsx)(u.II,{ref:L,value:x,onChange:e=>{p(e.target.value),requestAnimationFrame(()=>er())},onKeyUp:()=>er(),onClick:()=>er(),onBlur:()=>{setTimeout(()=>A(!1),150)},placeholder:"Escreva um coment\xe1rio... (use @ para mencionar)",disabled:b}),T&&el.length>0&&(0,l.jsx)("div",{className:"absolute left-0 right-0 bottom-full mb-2 z-50 rounded-lg border bg-white dark:bg-gray-900 shadow-lg overflow-hidden",children:(0,l.jsx)("div",{className:"max-h-56 overflow-y-auto",children:el.map(e=>(0,l.jsxs)("button",{type:"button",onMouseDown:e=>e.preventDefault(),onClick:()=>es(e),className:"w-full px-3 py-2 text-left hover:bg-gray-50 dark:hover:bg-gray-800",children:[(0,l.jsxs)("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[e.label,e.userId===y?" (voc\xea)":""]}),e.email&&(0,l.jsx)("div",{className:"text-xs text-gray-500",children:e.email})]},e.userId))})})]}),(0,l.jsx)(c.z,{type:"submit",disabled:b||!x.trim(),title:"Comentar",children:(0,l.jsx)(D.Z,{className:"w-4 h-4"})}),(0,l.jsx)(c.z,{type:"button",variant:"outline",disabled:b||!x.trim(),onClick:en,title:"Enviar esta mensagem tamb\xe9m para o solicitante (Head/origem)",children:"Perguntar ao solicitante"})]})]})]})]}),K&&(0,l.jsx)("div",{className:"fixed inset-0 z-[60] bg-black/50 flex items-center justify-center p-4",children:(0,l.jsxs)(o.Zb,{className:"w-full max-w-lg",children:[(0,l.jsx)(o.Ol,{children:(0,l.jsx)(o.ll,{children:"Encaminhar para outra \xe1rea"})}),(0,l.jsxs)(o.aY,{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"\xc1rea destino"}),(0,l.jsx)("select",{value:H,onChange:e=>G(e.target.value),className:"mt-1 w-full px-3 py-2 border rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white",children:S.Nd.map(e=>(0,l.jsx)("option",{value:e.areaKey,children:e.label},e.areaKey))})]}),(0,l.jsx)(k,{selectedUserId:Y,onSelect:e=>J(e),label:"Colaborador (opcional)",placeholder:"Selecione quem vai executar (opcional)"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Nota"}),(0,l.jsx)(u.II,{value:$,onChange:e=>W(e.target.value),placeholder:"Contexto para a \xe1rea (opcional)"})]}),(0,l.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,l.jsx)(c.z,{variant:"outline",onClick:()=>V(!1),children:"Cancelar"}),(0,l.jsx)(c.z,{className:"bg-primary hover:bg-[#1260b5]",onClick:eo,children:"Encaminhar"})]})]})]})}),B&&(0,l.jsx)("div",{className:"fixed inset-0 z-[60] bg-black/50 flex items-center justify-center p-4",children:(0,l.jsxs)(o.Zb,{className:"w-full max-w-lg",children:[(0,l.jsx)(o.Ol,{children:(0,l.jsx)(o.ll,{children:"Enviar para o Head"})}),(0,l.jsxs)(o.aY,{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Nota de retorno"}),(0,l.jsx)(u.II,{value:Q,onChange:e=>X(e.target.value),placeholder:"Resumo do que foi feito / pend\xeancias"})]}),(0,l.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,l.jsx)(c.z,{variant:"outline",onClick:()=>U(!1),children:"Cancelar"}),(0,l.jsx)(c.z,{className:"bg-primary hover:bg-[#1260b5]",onClick:ed,children:"Enviar"})]})]})]})})]}):null}var A=t(3577),Z=t(62720),P=t(49322),M=t(31047);function F(e){let{onFiltersChange:a,availableTags:t}=e,[s,i]=(0,r.useState)(!1),[n,o]=(0,r.useState)([]),[u,m]=(0,r.useState)({assignees:[],tags:[],priorities:[],dueDateFilter:"all"});(0,r.useEffect)(()=>{g()},[]),(0,r.useEffect)(()=>{a(u)},[u]);let g=async()=>{try{let e=[],a=await w.supabase.from("user_profiles").select("id, user_id, full_name").eq("is_active",!0).order("full_name");if(a.error){let a=await w.supabase.from("user_profiles").select("id, full_name").eq("is_active",!0).order("full_name");if(a.error)throw a.error;e=a.data||[]}else e=a.data||[];let t=(e||[]).map(e=>{let a=(null==e?void 0:e.user_id)?String(e.user_id):(null==e?void 0:e.id)?String(e.id):null;return a?{id:a,full_name:String((null==e?void 0:e.full_name)||"Usu\xe1rio")}:null}).filter(Boolean);o(t)}catch(e){console.error("Erro ao carregar usu\xe1rios:",e)}},x=e=>{m(a=>({...a,assignees:a.assignees.includes(e)?a.assignees.filter(a=>a!==e):[...a.assignees,e]}))},p=e=>{m(a=>({...a,tags:a.tags.includes(e)?a.tags.filter(a=>a!==e):[...a.tags,e]}))},h=e=>{m(a=>({...a,priorities:a.priorities.includes(e)?a.priorities.filter(a=>a!==e):[...a.priorities,e]}))},b=e=>{m(a=>({...a,dueDateFilter:e}))},v=()=>{m({assignees:[],tags:[],priorities:[],dueDateFilter:"all"})};return(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsxs)(c.z,{variant:"outline",onClick:()=>i(!s),className:"".concat(u.assignees.length>0||u.tags.length>0||u.priorities.length>0||"all"!==u.dueDateFilter?"border-primary text-primary":""),children:[(0,l.jsx)(A.Z,{className:"w-4 h-4 mr-2"}),"Filtros",(u.assignees.length>0||u.tags.length>0||u.priorities.length>0||"all"!==u.dueDateFilter)&&(0,l.jsx)(d.C,{className:"ml-2 bg-primary text-white",children:u.assignees.length+u.tags.length+u.priorities.length+("all"!==u.dueDateFilter?1:0)})]}),(u.assignees.length>0||u.tags.length>0||u.priorities.length>0||"all"!==u.dueDateFilter)&&(0,l.jsxs)(c.z,{variant:"ghost",size:"sm",onClick:v,children:[(0,l.jsx)(f.Z,{className:"w-4 h-4 mr-1"}),"Limpar filtros"]})]}),s&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"fixed inset-0 z-40",onClick:()=>i(!1)}),(0,l.jsxs)("div",{className:"absolute top-full mt-2 left-0 z-50 w-96 bg-white dark:bg-gray-800 border rounded-lg shadow-xl p-4 space-y-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Filtros"}),(0,l.jsx)("button",{onClick:()=>i(!1),className:"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",children:(0,l.jsx)(f.Z,{className:"w-5 h-5"})})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[(0,l.jsx)(_.Z,{className:"w-4 h-4"}),"Respons\xe1veis"]}),(0,l.jsx)("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:n.map(e=>(0,l.jsxs)("label",{className:"flex items-center gap-2 p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded cursor-pointer",children:[(0,l.jsx)("input",{type:"checkbox",checked:u.assignees.includes(e.id),onChange:()=>x(e.id),className:"rounded text-primary focus:ring-primary"}),(0,l.jsx)("span",{className:"text-sm text-gray-900 dark:text-white",children:e.full_name})]},e.id))})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[(0,l.jsx)(Z.Z,{className:"w-4 h-4"}),"Tags"]}),0===t.length?(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Nenhuma tag dispon\xedvel"}):(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:t.map(e=>(0,l.jsx)("button",{onClick:()=>p(e),className:"px-3 py-1 rounded-full text-sm transition-colors ".concat(u.tags.includes(e)?"bg-primary text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:e},e))})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[(0,l.jsx)(P.Z,{className:"w-4 h-4"}),"Prioridade"]}),(0,l.jsx)("div",{className:"grid grid-cols-2 gap-2",children:[{value:"urgent",label:"Urgente",color:"bg-red-600"},{value:"high",label:"Alta",color:"bg-red-100 text-red-700"},{value:"medium",label:"M\xe9dia",color:"bg-yellow-100 text-yellow-700"},{value:"low",label:"Baixa",color:"bg-gray-100 text-gray-700"}].map(e=>(0,l.jsx)("button",{onClick:()=>h(e.value),className:"p-2 rounded-lg border text-sm font-medium transition-colors ".concat(u.priorities.includes(e.value)?"border-primary bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700"),children:(0,l.jsx)(d.C,{className:e.color,children:e.label})},e.value))})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[(0,l.jsx)(M.Z,{className:"w-4 h-4"}),"Data de Vencimento"]}),(0,l.jsx)("div",{className:"space-y-1",children:[{value:"all",label:"Todas"},{value:"overdue",label:"Vencidas"},{value:"today",label:"Hoje"},{value:"this_week",label:"Esta semana"},{value:"this_month",label:"Este m\xeas"},{value:"no_date",label:"Sem data"}].map(e=>(0,l.jsxs)("label",{className:"flex items-center gap-2 p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded cursor-pointer",children:[(0,l.jsx)("input",{type:"radio",name:"dueDate",checked:u.dueDateFilter===e.value,onChange:()=>b(e.value),className:"text-primary focus:ring-primary"}),(0,l.jsx)("span",{className:"text-sm text-gray-900 dark:text-white",children:e.label})]},e.value))})]})]}),(0,l.jsxs)("div",{className:"pt-3 border-t flex gap-2",children:[(0,l.jsx)(c.z,{variant:"outline",onClick:v,className:"flex-1",children:"Limpar"}),(0,l.jsx)(c.z,{onClick:()=>i(!1),className:"flex-1 bg-primary hover:bg-[#1260b5]",children:"Aplicar"})]})]})]})]})}var L=t(37806),R=t(1740),O=t(15868),K=t(94766);function V(e){let{onNotificationClick:a}=e,[t,s]=(0,r.useState)(!1),[i,n]=(0,r.useState)([]),[o,u]=(0,r.useState)(0),[m,g]=(0,r.useState)(!0);(0,r.useEffect)(()=>{x()},[]);let x=async()=>{try{g(!0);let e=await fetch("/api/notifications?limit=20"),a=await e.json();if(!(null==a?void 0:a.success))return;let t=(a.notifications||[]).map(e=>{var a,t,l;return{id:e.id,type:e.type,title:e.title,message:e.message,is_read:!!e.read,created_at:e.created_at,task_id:(null===(a=e.metadata)||void 0===a?void 0:a.task_id)||void 0,triggered_by_name:(null===(t=e.metadata)||void 0===t?void 0:t.triggered_by_name)||(null===(l=e.metadata)||void 0===l?void 0:l.from_name)||void 0}});n(t),u(Number(a.unreadCount||0))}catch(e){console.error("Erro ao carregar notifica\xe7\xf5es:",e)}finally{g(!1)}},p=async e=>{try{await fetch("/api/notifications",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"mark_read",notificationId:e})}),await x()}catch(e){console.error("Erro ao marcar como lida:",e)}},b=async()=>{try{await fetch("/api/notifications",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"mark_all_read"})}),await x()}catch(e){console.error("Erro ao marcar todas como lidas:",e)}},y=async e=>{try{await p(e)}catch(e){console.error("Erro ao deletar notifica\xe7\xe3o:",e)}},j=async e=>{e.is_read||await p(e.id),a&&e.task_id&&(a(e.task_id),s(!1))},N=e=>{switch(e){case"mention":case"comment":return(0,l.jsx)(h.Z,{className:"w-4 h-4"});case"assignment":return(0,l.jsx)(L.Z,{className:"w-4 h-4"});case"move":return(0,l.jsx)(R.Z,{className:"w-4 h-4"});case"update":return(0,l.jsx)(O.Z,{className:"w-4 h-4"});default:return(0,l.jsx)(K.Z,{className:"w-4 h-4"})}},w=e=>{let a=new Date(e),t=new Date().getTime()-a.getTime(),l=Math.floor(t/6e4),r=Math.floor(t/36e5),s=Math.floor(t/864e5);return l<1?"Agora":l<60?"".concat(l,"m"):r<24?"".concat(r,"h"):s<7?"".concat(s,"d"):a.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})};return(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsxs)(c.z,{variant:"ghost",size:"sm",onClick:()=>s(!t),className:"relative",children:[(0,l.jsx)(K.Z,{className:"w-5 h-5"}),o>0&&(0,l.jsx)(d.C,{className:"absolute -top-1 -right-1 h-5 min-w-5 flex items-center justify-center p-0 bg-red-600 text-white text-xs",children:o>9?"9+":o})]}),t&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"fixed inset-0 z-40",onClick:()=>s(!1)}),(0,l.jsxs)("div",{className:"absolute top-full right-0 mt-2 z-50 w-96 bg-white dark:bg-gray-800 border rounded-lg shadow-xl",children:[(0,l.jsxs)("div",{className:"p-4 border-b flex items-center justify-between",children:[(0,l.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Notifica\xe7\xf5es"}),o>0&&(0,l.jsx)(c.z,{variant:"ghost",size:"sm",onClick:b,className:"text-xs text-primary hover:text-amber-700",children:"Marcar todas como lidas"})]}),(0,l.jsx)("div",{className:"max-h-96 overflow-y-auto",children:m?(0,l.jsxs)("div",{className:"p-8 text-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),(0,l.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"Carregando..."})]}):0===i.length?(0,l.jsxs)("div",{className:"p-8 text-center",children:[(0,l.jsx)(K.Z,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Nenhuma notifica\xe7\xe3o"})]}):i.map(e=>(0,l.jsx)("div",{className:"p-4 border-b last:border-b-0 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors cursor-pointer group ".concat(e.is_read?"":"bg-amber-50 dark:bg-amber-900/10"),onClick:()=>j(e),children:(0,l.jsxs)("div",{className:"flex gap-3",children:[(0,l.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ".concat(e.is_read?"bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-400":"bg-amber-100 dark:bg-amber-900/30 text-primary"),children:N(e.type)}),(0,l.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,l.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e.title}),(0,l.jsx)("span",{className:"text-xs text-gray-500 flex-shrink-0",children:w(e.created_at)})]}),(0,l.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:e.message}),e.task_id&&(0,l.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1 italic",children:"Abrir tarefa relacionada"}),e.triggered_by_name&&(0,l.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1",children:["Por ",e.triggered_by_name]})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[!e.is_read&&(0,l.jsx)(c.z,{variant:"ghost",size:"sm",onClick:a=>{a.stopPropagation(),p(e.id)},className:"h-6 w-6 p-0",title:"Marcar como lida",children:(0,l.jsx)(v.Z,{className:"w-3 h-3"})}),(0,l.jsx)(c.z,{variant:"ghost",size:"sm",onClick:a=>{a.stopPropagation(),y(e.id)},className:"h-6 w-6 p-0 text-red-600",title:"Deletar",children:(0,l.jsx)(f.Z,{className:"w-3 h-3"})})]})]})},e.id))}),i.length>0&&(0,l.jsx)("div",{className:"p-3 border-t bg-gray-50 dark:bg-gray-900",children:(0,l.jsx)(c.z,{variant:"ghost",onClick:()=>s(!1),className:"w-full text-sm",children:"Fechar"})})]})]})]})}var B=t(26892),U=t(57586),H=t(92934),G=t(11239),Y=t(91723),J=t(76865),$=t(96215),W=t(31810),Q=t(20265),X=t(15051),ee=t(10407),ea=t(70525),et=t(78867),el=t(93448);function er(e){return String(e||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim()}function es(e,a){let t=er(e||""),l=er(a);return t===l||t.includes(l)}function ei(e){let a=er(e||"");return"finalizado"===a||a.includes("finaliz")||"done"===a||a.includes("conclu")}function en(e){let{columns:a,area:t,boardId:s}=e,[i,n]=(0,r.useState)(null),[o,u]=(0,r.useState)([]),[m,x]=(0,r.useState)(""),[p,b]=(0,r.useState)(""),[v,y]=(0,r.useState)(!1),[j,N]=(0,r.useState)(!1),[w,_]=(0,r.useState)(0),[k,C]=(0,r.useState)([]),S=Date.now(),E=new Date,I=(0,r.useMemo)(()=>a.reduce((e,a)=>e+a.cards.length,0),[a]),q=(0,r.useMemo)(()=>a.filter(e=>ei(e.stageKey||e.id)).reduce((e,a)=>e+a.cards.length,0),[a]),z=(0,r.useMemo)(()=>a.filter(e=>{let a=e.stageKey||e.id;return!(ei(a)||es(a,"bloqueado")||es(a,"demanda"))}).flatMap(e=>e.cards.map(a=>({...a,stageKey:e.stageKey||e.id}))),[a]),T=(0,r.useMemo)(()=>a.filter(e=>es(e.stageKey||e.id,"demanda")).flatMap(e=>e.cards.map(a=>({...a,stageKey:e.stageKey||e.id}))),[a]),A=(0,r.useMemo)(()=>a.filter(e=>!ei(e.stageKey||e.id)).flatMap(e=>e.cards.map(a=>({...a,stageKey:e.stageKey||e.id}))).filter(e=>!!e.dueDate&&e.dueDate.getTime()<S),[a,S]),Z=(0,r.useMemo)(()=>[...new Set(a.flatMap(e=>e.cards.flatMap(e=>e.assignees)).filter(Boolean))],[a]),P=I>0?Math.round(q/I*100):0;(0,r.useEffect)(()=>{(async()=>{if(s)try{var e,a,t;let l=await fetch("/api/kanban/insights?boardId=".concat(encodeURIComponent(s))),r=await l.json().catch(()=>null);if(!l.ok||!(null==r?void 0:r.success))return;_(Number((null==r?void 0:null===(e=r.risk)||void 0===e?void 0:e.count)||(null==r?void 0:null===(a=r.metrics)||void 0===a?void 0:a.at_risk)||0)),C(((null==r?void 0:null===(t=r.risk)||void 0===t?void 0:t.top)||[]).map(e=>({id:String(e.id),title:String(e.title||""),score:Number(e.score||0),reasons:Array.isArray(e.reasons)?e.reasons.map(e=>String(e)):[]})))}catch(e){}})()},[s]);let M=(0,r.useMemo)(()=>{let e=a.filter(e=>!ei(e.stageKey||e.id)&&!es(e.stageKey||e.id,"bloqueado"));return 0===e.length?null:e.reduce((e,a)=>a.cards.length>e.cards.length?a:e,e[0])},[a]),F=e=>{switch(e){case"overdue":u(A);break;case"pending":u(T);break;case"inProgress":u(z)}n(e)};async function L(e){y(!0),N(!1),b(""),x(e.collaborator||"");try{let a=await fetch("/api/kanban/insights",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"generate_message",boardId:s||"",messageType:e.messageType,collaboratorId:e.collaborator||void 0,taskIds:(e.cards||[]).map(e=>e.id)})}),t=await a.json().catch(()=>null);if(!a.ok||!(null==t?void 0:t.success))throw Error((null==t?void 0:t.error)||"Falha ao gerar mensagem");b(String(t.message||"").trim())}catch(e){b((null==e?void 0:e.message)?"Erro ao gerar mensagem: ".concat(e.message):"Erro ao gerar mensagem")}finally{y(!1)}}let R=async e=>{x(e),n("praise"),await L({messageType:"praise",collaborator:e})},O=async(e,a)=>{x(e),u(a),n("charge"),await L({messageType:"charge",collaborator:e,cards:a})},K=()=>{N(!0),setTimeout(()=>{n(null),N(!1),b(""),x("")},2e3)},V=()=>{navigator.clipboard.writeText(p),alert("✅ Mensagem copiada!")},er=[{id:"completion",title:"Taxa de Conclus\xe3o",value:"".concat(P,"%"),icon:H.Z,color:"#10b981",clickable:!1},{id:"in_progress",title:"Em Andamento",value:z.length.toString(),subtitle:"cards ativos",icon:G.Z,color:"#f97316",clickable:!0,onClick:()=>F("inProgress")},{id:"pending",title:"Aguardando",value:T.length.toString(),subtitle:"na fila",icon:Y.Z,color:"#6366f1",clickable:!0,onClick:()=>F("pending")},{id:"overdue",title:"Atrasados",value:A.length.toString(),subtitle:A.length>0?"aten\xe7\xe3o!":"nenhum",icon:J.Z,color:A.length>0?"#ef4444":"#10b981",alert:A.length>0,clickable:A.length>0,onClick:()=>F("overdue")},{id:"risk",title:"Em risco",value:String(w||0),subtitle:w>0?"priorizar":"ok",icon:J.Z,color:w>0?"#f97316":"#10b981",alert:w>0,clickable:!1}];return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"bg-white rounded-xl border shadow-sm p-4 mb-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsxs)("h3",{className:"font-semibold text-gray-900 flex items-center gap-2",children:[(0,l.jsx)($.Z,{className:"w-5 h-5 text-blue-500"}),"Insights do Kanban"]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded",children:t}),(0,l.jsxs)("div",{className:"flex gap-1",children:[(0,l.jsxs)(c.z,{size:"sm",variant:"outline",className:"text-xs text-emerald-600 border-emerald-500/30 hover:bg-emerald-500/10",onClick:()=>{Z.length>0&&R(Z[0])},children:[(0,l.jsx)(W.Z,{className:"w-3 h-3 mr-1"}),"Elogiar"]}),(0,l.jsxs)(c.z,{size:"sm",variant:"outline",className:"text-xs text-primary border-primary/30 hover:bg-primary/10",onClick:()=>{A.length>0&&A[0].assignees.length>0&&O(A[0].assignees[0],A.filter(e=>e.assignees.includes(A[0].assignees[0])))},children:[(0,l.jsx)(h.Z,{className:"w-3 h-3 mr-1"}),"Cobrar"]})]})]})]}),(0,l.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-4",children:er.map((e,a)=>{let t=e.icon;return(0,l.jsxs)(B.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1*a},onClick:e.clickable?e.onClick:void 0,className:(0,el.cn)("p-3 rounded-xl border transition-all",e.alert?"border-red-200 bg-red-50":"border-gray-100 bg-gray-50",e.clickable&&"cursor-pointer hover:shadow-md hover:scale-[1.02]"),children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,l.jsx)("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center",style:{backgroundColor:"".concat(e.color,"20")},children:(0,l.jsx)(t,{className:"w-4 h-4",style:{color:e.color}})}),(0,l.jsx)("span",{className:"text-xs text-gray-500",children:e.title}),e.clickable&&(0,l.jsx)(g.Z,{className:"w-3 h-3 text-gray-400 ml-auto"})]}),(0,l.jsxs)("div",{className:"flex items-end justify-between",children:[(0,l.jsx)("span",{className:"text-2xl font-bold",style:{color:e.color},children:e.value}),e.change&&(0,l.jsxs)("span",{className:"text-xs flex items-center gap-0.5 ".concat(e.positive?"text-green-600":"text-red-600"),children:[e.positive?(0,l.jsx)(Q.Z,{className:"w-3 h-3"}):(0,l.jsx)(X.Z,{className:"w-3 h-3"}),e.change]}),e.subtitle&&(0,l.jsx)("span",{className:"text-xs text-gray-400",children:e.subtitle})]})]},e.id)})}),(0,l.jsxs)("div",{className:"space-y-2",children:[M&&M.cards.length>3&&(0,l.jsxs)("div",{className:"flex items-start gap-2 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:[(0,l.jsx)(J.Z,{className:"w-4 h-4 text-amber-600 mt-0.5"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium text-amber-800",children:"Gargalo identificado"}),(0,l.jsxs)("p",{className:"text-xs text-amber-700",children:["A fase ",(0,l.jsx)("strong",{children:M.title})," tem ",M.cards.length," cards acumulados. Considere redistribuir tarefas ou adicionar recursos."]})]})]}),A.length>0&&(0,l.jsxs)("div",{className:"flex items-start gap-2 p-3 bg-red-50 border border-red-200 rounded-lg cursor-pointer hover:bg-red-100 transition-colors",onClick:()=>F("overdue"),children:[(0,l.jsx)(Y.Z,{className:"w-4 h-4 text-red-600 mt-0.5"}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsxs)("p",{className:"text-sm font-medium text-red-800",children:[A.length," ",1===A.length?"card atrasado":"cards atrasados"]}),(0,l.jsxs)("p",{className:"text-xs text-red-700",children:[A.slice(0,3).map(e=>e.title).join(", "),A.length>3&&" e mais ".concat(A.length-3)]})]}),(0,l.jsx)(ee.Z,{className:"w-4 h-4 text-red-400"})]}),P>=70&&0===A.length&&(0,l.jsxs)("div",{className:"flex items-start gap-2 p-3 bg-green-50 border border-green-200 rounded-lg",children:[(0,l.jsx)(ea.Z,{className:"w-4 h-4 text-green-600 mt-0.5"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium text-green-800",children:"Excelente performance!"}),(0,l.jsxs)("p",{className:"text-xs text-green-700",children:["Sua taxa de conclus\xe3o est\xe1 em ",P,"% e n\xe3o h\xe1 cards atrasados. Continue assim!"]})]})]}),w>0&&k.length>0&&(0,l.jsxs)("div",{className:"p-3 bg-amber-50 border border-amber-200 rounded-lg",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-amber-800",children:"Itens em risco"}),(0,l.jsx)("ul",{className:"mt-1 space-y-1",children:k.slice(0,3).map(e=>{var a;return(0,l.jsxs)("li",{className:"text-xs text-amber-700",children:[(0,l.jsx)("strong",{children:e.score})," — ",e.title,(null===(a=e.reasons)||void 0===a?void 0:a.length)?" (".concat(e.reasons[0],")"):""]},e.id)})}),k.length>3&&(0,l.jsxs)("p",{className:"text-xs text-amber-700 mt-1",children:["+",k.length-3," outros"]})]})]}),(0,l.jsxs)("div",{className:"mt-4 pt-4 border-t",children:[(0,l.jsx)("p",{className:"text-xs text-gray-500 mb-2",children:"Distribui\xe7\xe3o por fase"}),(0,l.jsx)("div",{className:"flex h-3 rounded-full overflow-hidden bg-gray-100",children:a.map((e,a)=>{let t=I>0?e.cards.length/I*100:0;return 0===t?null:(0,l.jsx)(B.E.div,{initial:{width:0},animate:{width:"".concat(t,"%")},transition:{delay:.1*a,duration:.5},className:"h-full",style:{backgroundColor:e.color},title:"".concat(e.title,": ").concat(e.cards.length," cards (").concat(Math.round(t),"%)")},e.id)})}),(0,l.jsx)("div",{className:"flex flex-wrap gap-3 mt-2",children:a.map(e=>(0,l.jsxs)("div",{className:"flex items-center gap-1 text-xs",children:[(0,l.jsx)("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:e.color}}),(0,l.jsx)("span",{className:"text-gray-600",children:e.title}),(0,l.jsxs)("span",{className:"text-gray-400",children:["(",e.cards.length,")"]})]},e.id))})]}),Z.length>0&&(0,l.jsxs)("div",{className:"mt-4 pt-4 border-t",children:[(0,l.jsx)("p",{className:"text-xs text-gray-500 mb-2",children:"Colaboradores Ativos"}),(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:Z.map(e=>{let t=a.flatMap(a=>a.cards.filter(a=>a.assignees.includes(e))),r=t.some(e=>e.dueDate&&new Date(e.dueDate)<E);return(0,l.jsxs)("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-lg border",children:[(0,l.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-500 flex items-center justify-center text-white font-medium text-sm",children:e.charAt(0)}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-800",children:e}),(0,l.jsxs)("p",{className:"text-xs text-gray-500",children:[t.length," cards"]})]}),(0,l.jsxs)("div",{className:"flex gap-1 ml-2",children:[(0,l.jsx)(c.z,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 text-emerald-600 hover:bg-emerald-50",onClick:()=>R(e),title:"Elogiar",children:(0,l.jsx)(W.Z,{className:"w-3.5 h-3.5"})}),r&&(0,l.jsx)(c.z,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 text-primary hover:bg-primary/10",onClick:()=>O(e,t.filter(e=>e.dueDate&&new Date(e.dueDate)<E)),title:"Cobrar",children:(0,l.jsx)(h.Z,{className:"w-3.5 h-3.5"})})]})]},e)})})]})]}),(0,l.jsx)(U.M,{children:("overdue"===i||"pending"===i||"inProgress"===i)&&(0,l.jsx)(B.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4",onClick:()=>n(null),children:(0,l.jsxs)(B.E.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},onClick:e=>e.stopPropagation(),className:"bg-white rounded-2xl w-full max-w-lg shadow-2xl max-h-[80vh] overflow-hidden",children:[(0,l.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:(0,el.cn)("p-3 rounded-xl","overdue"===i?"bg-red-100":"pending"===i?"bg-indigo-100":"bg-amber-100"),children:"overdue"===i?(0,l.jsx)(J.Z,{className:"w-6 h-6 text-red-600"}):"pending"===i?(0,l.jsx)(Y.Z,{className:"w-6 h-6 text-indigo-600"}):(0,l.jsx)(G.Z,{className:"w-6 h-6 text-primary"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"overdue"===i?"Cards Atrasados":"pending"===i?"Cards Aguardando":"Cards em Andamento"}),(0,l.jsxs)("p",{className:"text-sm text-gray-500",children:[o.length," demandas"]})]})]}),(0,l.jsx)(c.z,{variant:"ghost",size:"icon",onClick:()=>n(null),children:(0,l.jsx)(f.Z,{className:"w-5 h-5"})})]})}),(0,l.jsx)("div",{className:"p-6 overflow-auto max-h-[50vh] space-y-3",children:o.map(e=>(0,l.jsxs)("div",{className:(0,el.cn)("p-4 rounded-xl border transition-all hover:shadow-md","overdue"===i?"bg-red-50 border-red-200":"pending"===i?"bg-indigo-50 border-indigo-200":"bg-amber-50 border-amber-200"),children:[(0,l.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,l.jsx)("h4",{className:"font-medium text-gray-900",children:e.title}),(0,l.jsx)(d.C,{className:(0,el.cn)("text-white text-xs","hot"===e.temperature?"bg-red-500":"warm"===e.temperature?"bg-amber-500":"bg-blue-500"),children:"hot"===e.temperature?"Quente":"warm"===e.temperature?"Morno":"Frio"})]}),e.clientName&&(0,l.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:["Cliente: ",e.clientName]}),(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[e.assignees.map((e,a)=>(0,l.jsx)("div",{className:"w-6 h-6 rounded-full bg-blue-500 flex items-center justify-center text-white text-xs font-medium",title:e,children:e.charAt(0)},a)),(0,l.jsx)("span",{className:"text-xs text-gray-500",children:e.assignees.join(", ")})]}),(0,l.jsx)("div",{className:"flex gap-1",children:e.assignees.map(a=>(0,l.jsxs)(r.Fragment,{children:[(0,l.jsxs)(c.z,{size:"sm",variant:"ghost",className:"h-7 px-2 text-xs text-emerald-600",onClick:()=>R(a),children:[(0,l.jsx)(W.Z,{className:"w-3 h-3 mr-1"}),"Elogiar"]}),"overdue"===i&&(0,l.jsxs)(c.z,{size:"sm",variant:"ghost",className:"h-7 px-2 text-xs text-primary",onClick:()=>O(a,[e]),children:[(0,l.jsx)(h.Z,{className:"w-3 h-3 mr-1"}),"Cobrar"]})]},a))})]})]},e.id))})]})})}),(0,l.jsx)(U.M,{children:"praise"===i&&(0,l.jsx)(B.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4",onClick:()=>!v&&n(null),children:(0,l.jsxs)(B.E.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},onClick:e=>e.stopPropagation(),className:"bg-white rounded-2xl w-full max-w-lg shadow-2xl",children:[(0,l.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"p-3 rounded-xl bg-emerald-100",children:(0,l.jsx)(W.Z,{className:"w-6 h-6 text-emerald-600"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Elogiar Colaborador"}),(0,l.jsxs)("p",{className:"text-sm text-gray-500",children:["Mensagem para ",m]})]})]})}),(0,l.jsx)("div",{className:"p-6",children:v?(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center py-8",children:[(0,l.jsx)("div",{className:"w-12 h-12 border-4 border-emerald-500/30 border-t-emerald-500 rounded-full animate-spin mb-4"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Gerando mensagem com IA..."})]}):j?(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center py-8",children:[(0,l.jsx)(H.Z,{className:"w-16 h-16 text-emerald-500 mb-4"}),(0,l.jsx)("p",{className:"text-xl font-bold text-gray-900",children:"Mensagem Enviada!"}),(0,l.jsx)("p",{className:"text-gray-500 mt-2",children:"O colaborador ser\xe1 notificado."})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"p-4 rounded-xl bg-emerald-50 border border-emerald-200 mb-4",children:(0,l.jsx)("p",{className:"whitespace-pre-line text-gray-700",children:p})}),(0,l.jsxs)("div",{className:"flex gap-3",children:[(0,l.jsxs)(c.z,{variant:"outline",className:"flex-1",onClick:V,children:[(0,l.jsx)(et.Z,{className:"w-4 h-4 mr-2"}),"Copiar"]}),(0,l.jsxs)(c.z,{className:"flex-1 bg-emerald-600 hover:bg-emerald-700",onClick:K,children:[(0,l.jsx)(D.Z,{className:"w-4 h-4 mr-2"}),"Enviar"]})]})]})})]})})}),(0,l.jsx)(U.M,{children:"charge"===i&&(0,l.jsx)(B.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4",onClick:()=>!v&&n(null),children:(0,l.jsxs)(B.E.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},onClick:e=>e.stopPropagation(),className:"bg-white rounded-2xl w-full max-w-lg shadow-2xl",children:[(0,l.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"p-3 rounded-xl bg-amber-100",children:(0,l.jsx)(h.Z,{className:"w-6 h-6 text-primary"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Cobrar Colaborador"}),(0,l.jsxs)("p",{className:"text-sm text-gray-500",children:["Mensagem para ",m]})]})]})}),(0,l.jsx)("div",{className:"p-6",children:v?(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center py-8",children:[(0,l.jsx)("div",{className:"w-12 h-12 border-4 border-primary/30 border-t-primary rounded-full animate-spin mb-4"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Gerando mensagem com IA..."})]}):j?(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center py-8",children:[(0,l.jsx)(H.Z,{className:"w-16 h-16 text-primary mb-4"}),(0,l.jsx)("p",{className:"text-xl font-bold text-gray-900",children:"Mensagem Enviada!"}),(0,l.jsx)("p",{className:"text-gray-500 mt-2",children:"O colaborador ser\xe1 notificado."})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"p-4 rounded-xl bg-amber-50 border border-amber-200 mb-4",children:(0,l.jsx)("p",{className:"whitespace-pre-line text-gray-700",children:p})}),(0,l.jsxs)("div",{className:"flex gap-3",children:[(0,l.jsxs)(c.z,{variant:"outline",className:"flex-1",onClick:V,children:[(0,l.jsx)(et.Z,{className:"w-4 h-4 mr-2"}),"Copiar"]}),(0,l.jsxs)(c.z,{className:"flex-1 bg-primary hover:bg-[#1260b5]",onClick:K,children:[(0,l.jsx)(D.Z,{className:"w-4 h-4 mr-2"}),"Enviar"]})]})]})})]})})})]})}var eo=t(72768),ed=t(76858),ec=t(70933),eu=t(51817);let em={"Web Designer":[{id:"site_type",label:"Tipo de Site",type:"select",options:[{value:"landing",label:"Landing Page"},{value:"institutional",label:"Institucional"},{value:"ecommerce",label:"E-commerce"},{value:"blog",label:"Blog"},{value:"portfolio",label:"Portf\xf3lio"},{value:"webapp",label:"Web App"}]},{id:"pages_count",label:"Quantidade de P\xe1ginas",type:"number",placeholder:"Ex: 5"},{id:"functionalities",label:"Funcionalidades",type:"multiselect",options:[{value:"form",label:"Formul\xe1rio de Contato"},{value:"chat",label:"Chat/WhatsApp"},{value:"gallery",label:"Galeria de Fotos"},{value:"blog",label:"Blog Integrado"},{value:"payment",label:"Pagamento Online"},{value:"login",label:"\xc1rea de Login"}]},{id:"has_domain",label:"Tem dom\xednio?",type:"checkbox"},{id:"has_hosting",label:"Tem hospedagem?",type:"checkbox"}],"Social Media":[{id:"platforms",label:"Plataformas",type:"multiselect",required:!0,options:[{value:"instagram",label:"Instagram"},{value:"facebook",label:"Facebook"},{value:"linkedin",label:"LinkedIn"},{value:"tiktok",label:"TikTok"},{value:"youtube",label:"YouTube"},{value:"twitter",label:"Twitter/X"}]},{id:"content_format",label:"Formato",type:"multiselect",options:[{value:"reels",label:"Reels"},{value:"carousel",label:"Carrossel"},{value:"stories",label:"Stories"},{value:"feed",label:"Post Feed"},{value:"video_long",label:"V\xeddeo Longo"},{value:"live",label:"Live"}]},{id:"publish_date",label:"Data de Publica\xe7\xe3o",type:"date"},{id:"publish_time",label:"Hor\xe1rio de Publica\xe7\xe3o",type:"text",placeholder:"Ex: 18:00"},{id:"caption",label:"Legenda/Copy",type:"textarea"}],Tráfego:[{id:"ads_platform",label:"Plataforma de Ads",type:"multiselect",required:!0,options:[{value:"google",label:"Google Ads"},{value:"meta",label:"Meta Ads (Facebook/Instagram)"},{value:"tiktok",label:"TikTok Ads"},{value:"linkedin",label:"LinkedIn Ads"},{value:"youtube",label:"YouTube Ads"}]},{id:"budget",label:"Or\xe7amento (R$)",type:"number",placeholder:"Ex: 5000"},{id:"objective",label:"Objetivo",type:"select",options:[{value:"awareness",label:"Reconhecimento"},{value:"traffic",label:"Tr\xe1fego"},{value:"engagement",label:"Engajamento"},{value:"leads",label:"Gera\xe7\xe3o de Leads"},{value:"conversions",label:"Convers\xf5es"},{value:"sales",label:"Vendas"}]},{id:"target_audience",label:"P\xfablico-Alvo",type:"textarea",placeholder:"Descreva o p\xfablico-alvo..."},{id:"campaign_period",label:"Per\xedodo da Campanha",type:"text",placeholder:"Ex: 01/01 a 31/01"}],"Video Maker":[{id:"video_duration",label:"Dura\xe7\xe3o",type:"select",options:[{value:"15s",label:"At\xe9 15 segundos"},{value:"30s",label:"30 segundos"},{value:"60s",label:"1 minuto"},{value:"3min",label:"At\xe9 3 minutos"},{value:"5min",label:"At\xe9 5 minutos"},{value:"10min+",label:"Mais de 10 minutos"}]},{id:"video_format",label:"Formato",type:"select",options:[{value:"vertical",label:"Vertical (9:16)"},{value:"horizontal",label:"Horizontal (16:9)"},{value:"square",label:"Quadrado (1:1)"}]},{id:"has_soundtrack",label:"Trilha Sonora",type:"checkbox"},{id:"has_subtitles",label:"Legendas",type:"checkbox"},{id:"resolution",label:"Resolu\xe7\xe3o",type:"select",options:[{value:"hd",label:"HD (720p)"},{value:"fullhd",label:"Full HD (1080p)"},{value:"4k",label:"4K"}]},{id:"style",label:"Estilo do V\xeddeo",type:"text",placeholder:"Ex: Motion Graphics, Filmagem, etc."}],Designer:[{id:"art_type",label:"Tipo de Arte",type:"select",options:[{value:"social",label:"Post para Redes Sociais"},{value:"banner",label:"Banner"},{value:"logo",label:"Logo/Identidade Visual"},{value:"flyer",label:"Flyer/Panfleto"},{value:"presentation",label:"Apresenta\xe7\xe3o"},{value:"ebook",label:"E-book/Material Rico"},{value:"packaging",label:"Embalagem"}]},{id:"dimensions",label:"Dimens\xf5es",type:"text",placeholder:"Ex: 1080x1080px"},{id:"file_format",label:"Formato de Arquivo",type:"multiselect",options:[{value:"png",label:"PNG"},{value:"jpg",label:"JPG"},{value:"pdf",label:"PDF"},{value:"psd",label:"PSD (Edit\xe1vel)"},{value:"ai",label:"AI (Edit\xe1vel)"},{value:"svg",label:"SVG"}]},{id:"color_palette",label:"Paleta de Cores",type:"text",placeholder:"Cores principais..."}],"Head Marketing":[{id:"campaign_name",label:"Nome da Campanha",type:"text",required:!0},{id:"campaign_type",label:"Tipo de Campanha",type:"select",options:[{value:"launch",label:"Lan\xe7amento"},{value:"seasonal",label:"Sazonal"},{value:"institutional",label:"Institucional"},{value:"promotion",label:"Promo\xe7\xe3o"},{value:"branding",label:"Branding"}]},{id:"teams_involved",label:"Equipes Envolvidas",type:"multiselect",options:[{value:"social",label:"Social Media"},{value:"design",label:"Design"},{value:"video",label:"Video Maker"},{value:"trafego",label:"Tr\xe1fego"},{value:"web",label:"Web Designer"}]},{id:"total_budget",label:"Or\xe7amento Total",type:"number"},{id:"expected_results",label:"Resultados Esperados",type:"textarea"}],Comercial:[{id:"proposal_value",label:"Valor da Proposta (R$)",type:"number",required:!0},{id:"services_included",label:"Servi\xe7os Inclusos",type:"multiselect",options:[{value:"social",label:"Gest\xe3o de Redes Sociais"},{value:"trafego",label:"Tr\xe1fego Pago"},{value:"site",label:"Cria\xe7\xe3o de Site"},{value:"design",label:"Design Gr\xe1fico"},{value:"video",label:"Produ\xe7\xe3o de V\xeddeo"},{value:"consultoria",label:"Consultoria"}]},{id:"contract_duration",label:"Dura\xe7\xe3o do Contrato",type:"select",options:[{value:"3",label:"3 meses"},{value:"6",label:"6 meses"},{value:"12",label:"12 meses"},{value:"project",label:"Por Projeto"}]},{id:"payment_conditions",label:"Condi\xe7\xf5es de Pagamento",type:"text"},{id:"decision_maker",label:"Decisor",type:"text"}],RH:[{id:"job_title",label:"Cargo/Vaga",type:"text",required:!0},{id:"candidate_name",label:"Nome do Candidato",type:"text"},{id:"selection_stage",label:"Etapa da Sele\xe7\xe3o",type:"select",options:[{value:"screening",label:"Triagem de Curr\xedculo"},{value:"interview1",label:"Primeira Entrevista"},{value:"technical",label:"Teste T\xe9cnico"},{value:"interview2",label:"Entrevista Final"},{value:"offer",label:"Proposta"},{value:"hired",label:"Contratado"}]},{id:"salary_range",label:"Faixa Salarial",type:"text",placeholder:"Ex: R$ 3.000 - R$ 4.000"},{id:"benefits",label:"Benef\xedcios",type:"textarea"},{id:"start_date",label:"Previs\xe3o de In\xedcio",type:"date"}],Financeiro:[{id:"document_type",label:"Tipo de Documento",type:"select",options:[{value:"invoice",label:"Nota Fiscal"},{value:"boleto",label:"Boleto"},{value:"receipt",label:"Recibo"},{value:"contract",label:"Contrato"}]},{id:"value",label:"Valor (R$)",type:"number",required:!0},{id:"due_date",label:"Vencimento",type:"date",required:!0},{id:"category",label:"Categoria",type:"select",options:[{value:"servicos",label:"Servi\xe7os"},{value:"software",label:"Software/Assinaturas"},{value:"marketing",label:"Marketing"},{value:"pessoal",label:"Pessoal"},{value:"infraestrutura",label:"Infraestrutura"}]}]},eg={default:[{id:"demandas",title:"Demandas",color:"#6366f1",fields:[{id:"title",label:"T\xedtulo da Demanda",type:"text",required:!0,placeholder:"Ex: Cria\xe7\xe3o de Landing Page"},{id:"description",label:"Descri\xe7\xe3o",type:"textarea",placeholder:"Descreva os detalhes da demanda..."},{id:"client_id",label:"Cliente",type:"select",required:!0,placeholder:"Selecione o cliente"},{id:"priority",label:"Prioridade",type:"select",required:!0,options:[{value:"low",label:"\uD83D\uDFE2 Baixa"},{value:"medium",label:"\uD83D\uDFE1 M\xe9dia"},{value:"high",label:"\uD83D\uDFE0 Alta"},{value:"urgent",label:"\uD83D\uDD34 Urgente"}]},{id:"due_date",label:"Data de Entrega Prevista",type:"date",required:!0}]},{id:"em_progresso",title:"Em Progresso",color:"#f97316",fields:[{id:"briefing_link",label:"Link do Briefing",type:"url",placeholder:"https://..."},{id:"references",label:"Refer\xeancias de Site",type:"textarea",placeholder:"Links ou descri\xe7\xe3o das refer\xeancias..."},{id:"assigned_to",label:"Respons\xe1vel",type:"select",required:!0},{id:"started_at",label:"Data de In\xedcio",type:"date"},{id:"notes",label:"Observa\xe7\xf5es",type:"textarea",placeholder:"Anota\xe7\xf5es sobre o andamento..."}]},{id:"revisao",title:"Revis\xe3o",color:"#eab308",fields:[{id:"material_link",label:"Link do Material",type:"url",required:!0,placeholder:"Link do arquivo para revis\xe3o"},{id:"checklist_quality",label:"Checklist de Qualidade",type:"multiselect",options:[{value:"ortografia",label:"Ortografia verificada"},{value:"design",label:"Design conforme briefing"},{value:"responsivo",label:"Responsivo/Adaptado"},{value:"links",label:"Links funcionando"},{value:"imagens",label:"Imagens otimizadas"}]},{id:"adjustment_points",label:"Pontos de Ajuste",type:"textarea",placeholder:"Liste os pontos que precisam de ajuste..."},{id:"reviewer",label:"Revisor",type:"select"}]},{id:"aprovacao",title:"Aprova\xe7\xe3o Cliente",color:"#06b6d4",fields:[{id:"client_link",label:"Link Enviado ao Cliente",type:"url",required:!0},{id:"sent_at",label:"Data de Envio",type:"date"},{id:"approval_status",label:"Status da Aprova\xe7\xe3o",type:"select",options:[{value:"pending",label:"⏳ Aguardando"},{value:"approved",label:"✅ Aprovado"},{value:"changes_requested",label:"\uD83D\uDD04 Altera\xe7\xf5es Solicitadas"},{value:"rejected",label:"❌ Rejeitado"}]},{id:"client_feedback",label:"Feedback do Cliente",type:"textarea",placeholder:"Coment\xe1rios do cliente..."}]},{id:"concluido",title:"Conclu\xeddo",color:"#10b981",fields:[{id:"completed_at",label:"Data de Conclus\xe3o",type:"date",required:!0},{id:"final_files",label:"Arquivos Finais",type:"url",placeholder:"Link para os arquivos finais"},{id:"delivery_notes",label:"Notas de Entrega",type:"textarea"},{id:"client_satisfaction",label:"Satisfa\xe7\xe3o do Cliente",type:"select",options:[{value:"5",label:"⭐⭐⭐⭐⭐ Excelente"},{value:"4",label:"⭐⭐⭐⭐ Bom"},{value:"3",label:"⭐⭐⭐ Regular"},{value:"2",label:"⭐⭐ Ruim"},{value:"1",label:"⭐ P\xe9ssimo"}]}]}],contas_pagar:[{id:"pendente",title:"Pendente",color:"#ef4444",fields:[{id:"supplier",label:"Fornecedor",type:"text",required:!0},{id:"value",label:"Valor (R$)",type:"number",required:!0},{id:"due_date",label:"Vencimento",type:"date",required:!0},{id:"category",label:"Categoria",type:"select",options:[{value:"servicos",label:"Servi\xe7os"},{value:"software",label:"Software/Assinaturas"},{value:"marketing",label:"Marketing/Ads"},{value:"pessoal",label:"Pessoal"},{value:"infraestrutura",label:"Infraestrutura"},{value:"impostos",label:"Impostos"},{value:"outros",label:"Outros"}]},{id:"cost_center",label:"Centro de Custo",type:"select",options:[{value:"operacional",label:"Operacional"},{value:"administrativo",label:"Administrativo"},{value:"comercial",label:"Comercial"},{value:"marketing",label:"Marketing"}]},{id:"description",label:"Descri\xe7\xe3o",type:"textarea"}]},{id:"agendado",title:"Agendado",color:"#f97316",fields:[{id:"payment_date",label:"Data do Pagamento",type:"date",required:!0},{id:"payment_method",label:"Forma de Pagamento",type:"select",options:[{value:"pix",label:"PIX"},{value:"boleto",label:"Boleto"},{value:"transferencia",label:"Transfer\xeancia"},{value:"cartao",label:"Cart\xe3o"},{value:"debito",label:"D\xe9bito Autom\xe1tico"}]},{id:"bank_account",label:"Conta Banc\xe1ria",type:"select"}]},{id:"pago",title:"Pago",color:"#10b981",fields:[{id:"paid_at",label:"Data do Pagamento",type:"date",required:!0},{id:"paid_value",label:"Valor Pago (R$)",type:"number",required:!0},{id:"receipt",label:"Comprovante",type:"url"}]},{id:"arquivado",title:"Arquivado",color:"#6b7280",fields:[]}],contas_receber:[{id:"a_faturar",title:"A Faturar",color:"#8b5cf6",fields:[{id:"client_id",label:"Cliente",type:"select",required:!0},{id:"value",label:"Valor (R$)",type:"number",required:!0},{id:"service",label:"Servi\xe7o",type:"text",required:!0},{id:"reference_month",label:"M\xeas de Refer\xeancia",type:"text",placeholder:"Ex: Janeiro/2025"},{id:"description",label:"Descri\xe7\xe3o",type:"textarea"}]},{id:"faturado",title:"Faturado",color:"#06b6d4",fields:[{id:"invoice_number",label:"N\xfamero da NF",type:"text",required:!0},{id:"invoice_date",label:"Data da Emiss\xe3o",type:"date",required:!0},{id:"due_date",label:"Vencimento",type:"date",required:!0},{id:"invoice_link",label:"Link da NF",type:"url"},{id:"billing_status",label:"Status da Cobran\xe7a",type:"select",options:[{value:"sent",label:"Enviado"},{value:"viewed",label:"Visualizado"},{value:"reminded",label:"Lembrete Enviado"}]}]},{id:"recebido",title:"Recebido",color:"#10b981",fields:[{id:"received_at",label:"Data do Recebimento",type:"date",required:!0},{id:"received_value",label:"Valor Recebido (R$)",type:"number",required:!0},{id:"payment_method",label:"Forma de Recebimento",type:"select",options:[{value:"pix",label:"PIX"},{value:"boleto",label:"Boleto"},{value:"transferencia",label:"Transfer\xeancia"},{value:"cartao",label:"Cart\xe3o"}]}]},{id:"arquivado",title:"Arquivado",color:"#6b7280",fields:[]}]};function ex(e){let{isOpen:a,onClose:t,onConfirm:s,cardTitle:i,fromPhase:n,toPhase:o,area:d,clients:c=[],employees:u=[],existingData:m={},fieldsOverride:g}=e,[x,p]=(0,r.useState)({}),[h,b]=(0,r.useState)({}),[v,y]=(0,r.useState)(!1),j=null!=g?g:function(e,a){let t=(eg[e]||eg.default).find(e=>e.id===a);if(!t)return[];let l=em[e]||[];return"demandas"===a||"em_progresso"===a?[...t.fields,...l]:t.fields}(d,o.id);(0,r.useEffect)(()=>{a&&(p(m),b({}))},[a,m]);let N=(e,a)=>{p(t=>({...t,[e]:a})),h[e]&&b(a=>{let t={...a};return delete t[e],t})},w=(e,a,t)=>{let l=x[e]||[];N(e,t?[...l,a]:l.filter(e=>e!==a))},_=()=>{let e={};return j.forEach(a=>{a.required&&!x[a.id]&&(e[a.id]="".concat(a.label," \xe9 obrigat\xf3rio"))}),b(e),0===Object.keys(e).length},C=async()=>{if(_()){y(!0);try{await s(x)}finally{y(!1)}}},S=e=>{var a,t;let r=x[e.id]||"",s=h[e.id],i="w-full px-3 py-2 rounded-lg border transition-colors ".concat(s?"border-red-500 bg-red-50":"border-gray-300 focus:border-blue-500"," focus:outline-none focus:ring-2 focus:ring-blue-200");switch(e.type){case"text":case"url":case"number":return(0,l.jsx)("input",{type:"url"===e.type?"url":e.type,value:r,onChange:a=>N(e.id,"number"===e.type?Number(a.target.value):a.target.value),placeholder:e.placeholder,className:i});case"textarea":return(0,l.jsx)("textarea",{value:r,onChange:a=>N(e.id,a.target.value),placeholder:e.placeholder,rows:3,className:i});case"date":return(0,l.jsx)("input",{type:"date",value:r,onChange:a=>N(e.id,a.target.value),className:i});case"select":if("client_id"===e.id){if(!(null==c?void 0:c.length))return(0,l.jsx)("input",{type:"text",value:r,onChange:a=>N(e.id,a.target.value),placeholder:e.placeholder||"ID do cliente (opcional)",className:i});return(0,l.jsxs)("select",{value:r,onChange:a=>N(e.id,a.target.value),className:i,children:[(0,l.jsx)("option",{value:"",children:"Selecione o cliente..."}),c.map(e=>(0,l.jsx)("option",{value:e.id,children:e.name},e.id))]})}if("assigned_to"===e.id||"reviewer"===e.id)return(0,l.jsx)(k,{selectedUserId:r||void 0,onSelect:a=>N(e.id,a),label:e.label,placeholder:e.placeholder||"Selecione um respons\xe1vel"});return(0,l.jsxs)("select",{value:r,onChange:a=>N(e.id,a.target.value),className:i,children:[(0,l.jsx)("option",{value:"",children:"Selecione..."}),null===(a=e.options)||void 0===a?void 0:a.map(e=>(0,l.jsx)("option",{value:e.value,children:e.label},e.value))]});case"multiselect":let n=r||[];return(0,l.jsx)("div",{className:"space-y-2 p-3 bg-gray-50 rounded-lg max-h-40 overflow-y-auto",children:null===(t=e.options)||void 0===t?void 0:t.map(a=>(0,l.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer hover:bg-gray-100 p-1 rounded",children:[(0,l.jsx)("input",{type:"checkbox",checked:n.includes(a.value),onChange:t=>w(e.id,a.value,t.target.checked),className:"w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,l.jsx)("span",{className:"text-sm text-gray-700",children:a.label})]},a.value))});case"checkbox":return(0,l.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,l.jsx)("input",{type:"checkbox",checked:!!r,onChange:a=>N(e.id,a.target.checked),className:"w-5 h-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,l.jsx)("span",{className:"text-sm text-gray-700",children:"Sim"})]});default:return null}};return a?(0,l.jsx)(U.M,{children:(0,l.jsx)(B.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:t,children:(0,l.jsxs)(B.E.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},onClick:e=>e.stopPropagation(),className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col",children:[(0,l.jsxs)("div",{className:"p-6 border-b bg-gradient-to-r from-gray-50 to-white",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Mover Card"}),(0,l.jsx)("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,l.jsx)(f.Z,{className:"w-5 h-5 text-gray-500"})})]}),(0,l.jsxs)("div",{className:"bg-white rounded-xl p-4 border shadow-sm",children:[(0,l.jsx)("p",{className:"font-semibold text-gray-900 mb-3",children:i}),(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"px-3 py-1.5 rounded-lg text-white text-sm font-medium",style:{backgroundColor:n.color},children:n.title}),(0,l.jsx)(ed.Z,{className:"w-5 h-5 text-gray-400"}),(0,l.jsx)("div",{className:"px-3 py-1.5 rounded-lg text-white text-sm font-medium",style:{backgroundColor:o.color},children:o.title})]})]})]}),(0,l.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:0===j.length?(0,l.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,l.jsx)(ec.Z,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),(0,l.jsx)("p",{children:"Nenhuma informa\xe7\xe3o adicional necess\xe1ria para esta fase."})]}):(0,l.jsxs)("div",{className:"space-y-5",children:[(0,l.jsxs)("p",{className:"text-sm text-gray-600 bg-blue-50 p-3 rounded-lg flex items-center gap-2",children:[(0,l.jsx)(P.Z,{className:"w-4 h-4 text-blue-500"}),"Preencha as informa\xe7\xf5es necess\xe1rias para a fase ",(0,l.jsx)("strong",{children:o.title})]}),j.map(e=>(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:[e.label,e.required&&(0,l.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),S(e),e.helpText&&(0,l.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:e.helpText}),h[e.id]&&(0,l.jsxs)("p",{className:"text-xs text-red-500 mt-1 flex items-center gap-1",children:[(0,l.jsx)(P.Z,{className:"w-3 h-3"}),h[e.id]]})]},e.id))]})}),(0,l.jsxs)("div",{className:"p-6 border-t bg-gray-50 flex items-center justify-end gap-3",children:[(0,l.jsx)("button",{onClick:t,disabled:v,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancelar"}),(0,l.jsx)("button",{onClick:C,disabled:v,className:"px-6 py-2 text-white rounded-lg transition-colors flex items-center gap-2",style:{backgroundColor:o.color},children:v?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(eu.Z,{className:"w-4 h-4 animate-spin"}),"Movendo..."]}):(0,l.jsxs)(l.Fragment,{children:["Confirmar",(0,l.jsx)(ed.Z,{className:"w-4 h-4"})]})})]})]})})}):null}function ep(e){var a;let t=e.areaKey?String(e.areaKey):"",l=e.stageKey?String(e.stageKey):"";if(!t||!l)return"outros";let r=S.Nd.find(e=>e.areaKey===t),s=null==r?void 0:null===(a=r.columns)||void 0===a?void 0:a.find(e=>e.stageKey===l);return(null==s?void 0:s.stageGroup)||"outros"}function eh(e){return Array.from(new Set(e))}let eb={demanda:[{id:"title",label:"T\xedtulo",type:"text",required:!0,placeholder:"Ex: Ajuste de Landing Page"},{id:"description",label:"Descri\xe7\xe3o",type:"textarea",placeholder:"Contexto, objetivo, detalhes..."},{id:"priority",label:"Prioridade",type:"select",options:[{value:"low",label:"\uD83D\uDFE2 Baixa"},{value:"medium",label:"\uD83D\uDFE1 M\xe9dia"},{value:"high",label:"\uD83D\uDFE0 Alta"},{value:"urgent",label:"\uD83D\uDD34 Urgente"}]},{id:"due_date",label:"Data prevista",type:"date"},{id:"assigned_to",label:"Respons\xe1vel",type:"select"}],escopo:[{id:"description",label:"Escopo/Descri\xe7\xe3o",type:"textarea",required:!0,placeholder:"Defina claramente o escopo..."},{id:"briefing_link",label:"Link do Briefing",type:"url",placeholder:"https://..."},{id:"references",label:"Refer\xeancias",type:"textarea",placeholder:"Links e exemplos..."},{id:"assigned_to",label:"Respons\xe1vel",type:"select"},{id:"due_date",label:"Data prevista",type:"date"}],planejamento:[{id:"assigned_to",label:"Respons\xe1vel",type:"select",required:!0},{id:"started_at",label:"In\xedcio",type:"date"},{id:"notes",label:"Observa\xe7\xf5es",type:"textarea"}],producao:[{id:"assigned_to",label:"Respons\xe1vel",type:"select",required:!0},{id:"due_date",label:"Entrega prevista",type:"date"},{id:"notes",label:"Observa\xe7\xf5es",type:"textarea"}],revisao_interna:[{id:"material_link",label:"Link do Material",type:"url",required:!0,placeholder:"Link do arquivo para revis\xe3o"},{id:"checklist_quality",label:"Checklist de Qualidade",type:"multiselect",options:[{value:"ortografia",label:"Ortografia verificada"},{value:"design",label:"Design conforme briefing"},{value:"responsivo",label:"Responsivo/Adaptado"},{value:"links",label:"Links funcionando"},{value:"imagens",label:"Imagens otimizadas"}]},{id:"adjustment_points",label:"Pontos de Ajuste",type:"textarea"},{id:"reviewer",label:"Revisor",type:"select"}],aprovacao:[{id:"client_link",label:"Link enviado ao cliente",type:"url",required:!0},{id:"sent_at",label:"Data de envio",type:"date"},{id:"approval_status",label:"Status da aprova\xe7\xe3o",type:"select",options:[{value:"pending",label:"⏳ Aguardando"},{value:"approved",label:"✅ Aprovado"},{value:"changes_requested",label:"\uD83D\uDD04 Altera\xe7\xf5es solicitadas"},{value:"rejected",label:"❌ Rejeitado"}]},{id:"client_feedback",label:"Feedback do cliente",type:"textarea"}],ajustes:[{id:"adjustment_points",label:"Pontos de Ajuste",type:"textarea",required:!0,placeholder:"Liste o que precisa ser ajustado..."},{id:"material_link",label:"Link do Material",type:"url",placeholder:"Link atualizado para revis\xe3o"}],publicacao_entrega:[{id:"publish_date",label:"Data de publica\xe7\xe3o/entrega",type:"date"},{id:"publish_time",label:"Hor\xe1rio",type:"text",placeholder:"Ex: 18:00"},{id:"delivery_notes",label:"Notas de entrega",type:"textarea"}],finalizado:[{id:"completed_at",label:"Data de conclus\xe3o",type:"date",required:!0},{id:"final_files",label:"Arquivos finais (link)",type:"url",placeholder:"https://..."},{id:"delivery_notes",label:"Notas finais",type:"textarea"}],bloqueado:[{id:"block_reason",label:"Motivo do bloqueio",type:"textarea",required:!0,placeholder:"Explique o bloqueio e o que falta..."}],outros:[{id:"description",label:"Descri\xe7\xe3o",type:"textarea"}]};var ev=t(14438);let ef=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;function ey(e){return String(e||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim()}function ej(e,a){let t=String(a||"").trim();if(!t)return null;if(ef.test(t))return e&&0!==e.length?e.some(e=>e.id===t)?t:null:t;let l=ey(t),r=e.find(e=>ey(e.stage_key)===l);if((null==r?void 0:r.id)&&ef.test(r.id))return r.id;let s=e.find(e=>{let a=ey(e.name);return a===l||a.includes(l)||l.includes(a)});if((null==s?void 0:s.id)&&ef.test(s.id))return s.id;let i=e.find(e=>e_(e)===t);return(null==i?void 0:i.id)&&ef.test(i.id)?i.id:null}function eN(e,a,t){if(!t)return null;let l=String(t.id||"").trim();if(!l)return null;if(!ef.test(l)){let a=ej(e,l);if(a)return a}if(e.some(e=>e.id===l))return l;let r=a.find(e=>e.id===l)||null,s=(null==r?void 0:r.column_id)?String(r.column_id):"";return s&&e.some(e=>e.id===s)?s:null}function ew(e,a){let t=String(null!=a?a:"").trim();return t?ef.test(t)?t:ej(e,t):null}function e_(e){let a=String((null==e?void 0:e.stage_key)||"").toLowerCase(),t=String((null==e?void 0:e.name)||"").toLowerCase(),l=a||t;return t.includes("backlog")?"backlog":t.includes("a fazer")?"todo":t.includes("em progresso")?"in_progress":t.includes("revis")?"in_review":t.includes("conclu")?"done":t.includes("bloque")?"blocked":t.includes("cancel")?"cancelled":"finalizado"===l||l.includes("final")?"done":"bloqueado"===l||l.includes("bloque")?"blocked":"aprovacao"===l||l.includes("aprov")||l.includes("revisao")?"in_review":"demanda"===l||l.includes("lead_demanda")||l.includes("lead")?"todo":"in_progress"}function ek(e){var a;let{task:t,onDelete:r,onEdit:s,onView:i}=e,{attributes:u,listeners:v,setNodeRef:f,transform:y,transition:j,isDragging:w}=(0,n.nB)({id:t.id}),_={transform:N.ux.Transform.toString(y),transition:j,opacity:w?.5:1};return(0,l.jsx)("div",{ref:f,style:_,...u,className:"mb-3",children:(0,l.jsxs)(o.Zb,{className:"cursor-grab active:cursor-grabbing hover:shadow-lg transition-shadow group",children:[(0,l.jsx)(o.Ol,{className:"pb-3 pt-3",children:(0,l.jsxs)("div",{className:"flex items-start gap-2",children:[(0,l.jsx)("div",{...v,className:"cursor-grab active:cursor-grabbing mt-1",children:(0,l.jsx)(m.Z,{className:"w-4 h-4 text-gray-400 group-hover:text-gray-600 transition-colors"})}),(0,l.jsxs)("div",{className:"flex-1",onClick:()=>i(t),style:{cursor:"pointer"},children:[(0,l.jsx)(o.ll,{className:"text-sm font-medium text-gray-900 dark:text-white",children:t.title}),t.description&&(0,l.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1 line-clamp-2",children:t.description}),(0,l.jsxs)("div",{className:"flex items-center gap-2 mt-2 flex-wrap",children:[(0,l.jsx)(d.C,{className:(e=>{switch(e){case"urgent":return"bg-red-600 text-white";case"high":return"bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-200";case"medium":return"bg-yellow-100 text-yellow-700 dark:bg-yellow-900 dark:text-yellow-200";default:return"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-200"}})(t.priority),children:(e=>{switch(e){case"urgent":return"Urgente";case"high":return"Alta";case"medium":return"M\xe9dia";default:return"Baixa"}})(t.priority)}),null===(a=t.tags)||void 0===a?void 0:a.map(e=>(0,l.jsx)(d.C,{variant:"outline",className:"text-xs",children:e},e))]})]}),(0,l.jsxs)("div",{className:"flex gap-1",children:[(0,l.jsx)(c.z,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 opacity-0 group-hover:opacity-100",onClick:()=>i(t),title:"Ver detalhes",children:(0,l.jsx)(g.Z,{className:"w-3 h-3"})}),(0,l.jsx)(c.z,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 opacity-0 group-hover:opacity-100",onClick:()=>s(t),children:(0,l.jsx)(x.Z,{className:"w-3 h-3"})}),(0,l.jsx)(c.z,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 opacity-0 group-hover:opacity-100 text-red-600",onClick:()=>r(t.id),children:(0,l.jsx)(p.Z,{className:"w-3 h-3"})})]})]})}),(0,l.jsx)(o.aY,{className:"pt-0",children:(0,l.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-600 dark:text-gray-400",children:[(0,l.jsx)("div",{className:"flex items-center gap-2",children:t.assignee_name&&(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(0,l.jsx)("div",{className:"w-6 h-6 rounded-full bg-gradient-to-br from-[#1672d6] to-[#001533] flex items-center justify-center text-xs text-white font-medium",children:t.assignee_name.charAt(0)}),(0,l.jsx)("span",{children:t.assignee_name})]})}),(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[t.comments_count&&t.comments_count>0&&(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(0,l.jsx)(h.Z,{className:"w-3 h-3"}),(0,l.jsx)("span",{children:t.comments_count})]}),t.attachments_count&&t.attachments_count>0&&(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(0,l.jsx)(b.Z,{className:"w-3 h-3"}),(0,l.jsx)("span",{children:t.attachments_count})]})]})]})})]})})}function eC(e){let{column:a,children:t}=e,{setNodeRef:r}=(0,i.Zj)({id:a.id});return(0,l.jsx)("div",{ref:r,className:"flex-1 min-h-[400px] p-3 bg-gray-50 dark:bg-gray-900 rounded-lg",children:t})}function eS(e){let{column:a,taskCount:t,onEdit:s,onDelete:i,canDelete:n}=e,[o,m]=(0,r.useState)(!1),[g,h]=(0,r.useState)(a.name),b=()=>{g.trim()&&g!==a.name&&s(a.id,g.trim()),m(!1)},y=()=>{h(a.name),m(!1)};return(0,l.jsx)("div",{className:"flex items-center justify-between p-3 bg-gray-100 dark:bg-gray-800 rounded-lg border-l-4 mb-3 group",style:{borderLeftColor:a.color},children:o?(0,l.jsxs)("div",{className:"flex items-center gap-2 flex-1",children:[(0,l.jsx)(u.II,{value:g,onChange:e=>h(e.target.value),onKeyDown:e=>{"Enter"===e.key&&b(),"Escape"===e.key&&y()},className:"h-8 text-sm font-semibold",autoFocus:!0}),(0,l.jsx)(c.z,{size:"sm",variant:"ghost",onClick:b,className:"h-8 w-8 p-0",children:(0,l.jsx)(v.Z,{className:"w-4 h-4 text-green-600"})}),(0,l.jsx)(c.z,{size:"sm",variant:"ghost",onClick:y,className:"h-8 w-8 p-0",children:(0,l.jsx)(f.Z,{className:"w-4 h-4 text-red-600"})})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white",children:a.name}),n&&(0,l.jsx)(c.z,{size:"sm",variant:"ghost",onClick:()=>m(!0),className:"h-6 w-6 p-0 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,l.jsx)(x.Z,{className:"w-3 h-3"})})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(d.C,{variant:"outline",children:t}),n&&(0,l.jsx)(c.z,{size:"sm",variant:"ghost",onClick:()=>i(a.id),className:"h-6 w-6 p-0 opacity-0 group-hover:opacity-100 transition-opacity text-red-600",children:(0,l.jsx)(p.Z,{className:"w-3 h-3"})})]})]})})}function eD(e){var a;let{isOpen:t,onClose:s,onSave:i,task:n,columnId:d}=e,[m,g]=(0,r.useState)({});return((0,r.useEffect)(()=>{t&&g({title:(null==n?void 0:n.title)||"",description:(null==n?void 0:n.description)||"",priority:(null==n?void 0:n.priority)||"medium",tags:(null==n?void 0:n.tags)||[],column_id:(null==n?void 0:n.column_id)||d||"",assigned_to:null==n?void 0:n.assigned_to})},[t,null==n?void 0:n.id,d]),t)?(0,l.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,l.jsxs)(o.Zb,{className:"w-full max-w-lg",children:[(0,l.jsx)(o.Ol,{children:(0,l.jsx)(o.ll,{children:n?"Editar Tarefa":"Nova Tarefa"})}),(0,l.jsx)(o.aY,{children:(0,l.jsxs)("form",{onSubmit:e=>{e.preventDefault(),i({...m,column_id:m.column_id||d||""}),s()},className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"T\xedtulo"}),(0,l.jsx)(u.II,{value:m.title,onChange:e=>g({...m,title:e.target.value}),placeholder:"Digite o t\xedtulo da tarefa",required:!0})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Descri\xe7\xe3o"}),(0,l.jsx)("textarea",{value:m.description,onChange:e=>g({...m,description:e.target.value}),placeholder:"Digite a descri\xe7\xe3o (opcional)",className:"w-full px-3 py-2 border rounded-md min-h-[100px] bg-white dark:bg-gray-800 text-gray-900 dark:text-white"})]}),(0,l.jsx)(k,{selectedUserId:m.assigned_to,onSelect:e=>g({...m,assigned_to:e}),label:"Respons\xe1vel",placeholder:"Atribuir a algu\xe9m (opcional)"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Prioridade"}),(0,l.jsxs)("select",{value:m.priority,onChange:e=>g({...m,priority:e.target.value}),className:"w-full px-3 py-2 border rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white",children:[(0,l.jsx)("option",{value:"low",children:"Baixa"}),(0,l.jsx)("option",{value:"medium",children:"M\xe9dia"}),(0,l.jsx)("option",{value:"high",children:"Alta"}),(0,l.jsx)("option",{value:"urgent",children:"Urgente"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Tags (separadas por v\xedrgula)"}),(0,l.jsx)(u.II,{value:null===(a=m.tags)||void 0===a?void 0:a.join(", "),onChange:e=>g({...m,tags:e.target.value.split(",").map(e=>e.trim()).filter(e=>e)}),placeholder:"Ex: Marketing, Design, Urgente"})]}),(0,l.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,l.jsx)(c.z,{type:"button",variant:"outline",onClick:s,children:"Cancelar"}),(0,l.jsx)(c.z,{type:"submit",className:"bg-primary hover:bg-[#1260b5]",children:n?"Salvar":"Criar"})]})]})})]})}):null}function eE(){var e;let a=(0,s.usePathname)(),t=a.startsWith("/admin/kanban-app")||a.startsWith("/colaborador/kanban")?"area_only":"all",d=!a.startsWith("/colaborador/kanban"),m=a.startsWith("/colaborador/kanban"),[g,x]=(0,r.useState)(null),[p,h]=(0,r.useState)(null),[b,v]=(0,r.useState)([]),[f,N]=(0,r.useState)([]),[_,k]=(0,r.useState)([]),[C,S]=(0,r.useState)(null),[D,I]=(0,r.useState)(null),[q,z]=(0,r.useState)(!0),[A,Z]=(0,r.useState)(!1),[P,M]=(0,r.useState)(void 0),[L,R]=(0,r.useState)(""),[O,K]=(0,r.useState)(null),[B,U]=(0,r.useState)(""),[H,G]=(0,r.useState)({assignees:[],tags:[],priorities:[],dueDateFilter:"all"}),[Y,J]=(0,r.useState)(""),[$,W]=(0,r.useState)(null),[Q,X]=(0,r.useState)(null),[ee,ea]=(0,r.useState)(!1),[et,el]=(0,r.useState)(null),[er,es]=(0,r.useState)({}),ei=e=>{if(!e)return"";let a=new Date(e);if(Number.isNaN(a.getTime()))return"";let t=a.getFullYear(),l=String(a.getMonth()+1).padStart(2,"0"),r=String(a.getDate()).padStart(2,"0");return"".concat(t,"-").concat(l,"-").concat(r)},ed=e=>{let a=String(e||"").trim();if(!a)return null;let t=new Date("".concat(a,"T12:00:00.000Z"));return Number.isNaN(t.getTime())?null:t.toISOString()},ec=e=>{var a,t,l,r,s,i,n,o,d,c,u,m,g;let x=e.task,p=String(e.toColumn.stage_key||"").trim();if(!p)return!1;let h=String((null===(a=e.fromColumn)||void 0===a?void 0:a.stage_key)||"").trim(),b=(null==x?void 0:x.reference_links)||{},v=(null==b?void 0:b.stage_forms)||{},f=(null==v?void 0:v[p])||{};return es({...f,title:null!==(i=null!==(s=f.title)&&void 0!==s?s:x.title)&&void 0!==i?i:"",description:null!==(o=null!==(n=f.description)&&void 0!==n?n:x.description)&&void 0!==o?o:"",priority:null!==(c=null!==(d=f.priority)&&void 0!==d?d:x.priority)&&void 0!==c?c:"medium",due_date:null!==(u=f.due_date)&&void 0!==u?u:ei(x.due_date),assigned_to:null!==(g=null!==(m=f.assigned_to)&&void 0!==m?m:x.assigned_to)&&void 0!==g?g:""}),el({taskId:x.id,fromColumnId:String((null===(t=e.fromColumn)||void 0===t?void 0:t.id)||x.column_id||""),toColumnId:e.toColumnId,fromColumnTitle:(null===(l=e.fromColumn)||void 0===l?void 0:l.name)||h||"Atual",fromColumnColor:(null===(r=e.fromColumn)||void 0===r?void 0:r.color)||"#6B7280",toColumnTitle:e.toColumn.name,toColumnColor:e.toColumn.color,toStageKey:p}),ea(!0),!0},eu=async e=>{if(!(null==et?void 0:et.taskId)||!et.toColumnId)return;let a=b.find(e=>e.id===et.taskId)||null;if(!a)return;let t=f.find(e=>e.id===et.toColumnId)||null;if(t)try{let l=new Date().toISOString(),r=f.find(e=>e.id===String(a.column_id))||null,s="aprovacao"===String((null==t?void 0:t.stage_key)||"").toLowerCase()&&"aprovacao"!==String((null==r?void 0:r.stage_key)||"").toLowerCase(),i=(null==a?void 0:a.reference_links)||{},n=(null==i?void 0:i.client_approval)||{},o={...(null==i?void 0:i.stage_forms)||{},[et.toStageKey]:e},d={...i,stage_forms:o},c=s?{...d,client_approval:{...n,status:"pending",requested_at:n.requested_at||l,due_at:n.due_at||function(e,a){let t=new Date(e);return t.setHours(t.getHours()+a),t.toISOString()}(n.requested_at||l,Number((null==t?void 0:t.sla_hours)||48))}}:d,u=e_(t),m=b.filter(e=>e.column_id===et.toColumnId&&e.id!==et.taskId).length,g={column_id:et.toColumnId,position:m,status:u,updated_at:l,reference_links:c};"string"==typeof e.title&&e.title.trim()&&(g.title=e.title.trim()),"string"==typeof e.description&&(g.description=e.description),"string"==typeof e.priority&&e.priority&&(g.priority=e.priority),"string"==typeof e.assigned_to&&(g.assigned_to=e.assigned_to||null);let x=ed(e.due_date);x&&(g.due_date=x);let{error:p}=await w.supabase.from("kanban_tasks").update(g).eq("id",et.taskId);if(p)throw p;D&&await eT(D)}catch(a){let e=String((null==a?void 0:a.message)||"Falha ao mover tarefa");ev.Am.error(e),D&&await eT(D)}finally{ea(!1),el(null),es({})}},eg=async e=>{if(!(null==e?void 0:e.taskId)||!(null==e?void 0:e.toColumnId))return;let a=String(e.taskId),t=String(e.toColumnId);if(!ef.test(t))return;let l=b.find(e=>e.id===a)||null;if(!l)return;let r=new Date().toISOString(),s=f.find(e=>e.id===t)||null,i=e_(s),n=b.filter(e=>e.column_id===t&&e.id!==a).length,o=f.find(e=>e.id===String(l.column_id))||null,d="aprovacao"===String((null==s?void 0:s.stage_key)||"").toLowerCase()&&"aprovacao"!==String((null==o?void 0:o.stage_key)||"").toLowerCase(),c=(null==l?void 0:l.reference_links)||{},u=(null==c?void 0:c.client_approval)||{},m=d?{...c,client_approval:{...u,status:"pending",requested_at:u.requested_at||r,due_at:u.due_at||function(e,a){let t=new Date(e);return t.setHours(t.getHours()+a),t.toISOString()}(u.requested_at||r,Number((null==s?void 0:s.sla_hours)||48))}}:c,{error:g}=await w.supabase.from("kanban_tasks").update({column_id:t,position:n,status:i,updated_at:r,...d?{reference_links:m}:{}}).eq("id",a);if(g)throw g},ey=(0,r.useMemo)(()=>(f||[]).map(e=>{let a=(b||[]).filter(a=>a.column_id===e.id).map(a=>{var t,l,r;let s=a.reference_links||{},i=(null==s?void 0:null===(t=s.client)||void 0===t?void 0:t.company_name)||(null==s?void 0:null===(l=s.client)||void 0===l?void 0:l.name)||(null==s?void 0:null===(r=s.client_profile)||void 0===r?void 0:r.name)||void 0;return{id:a.id,title:a.title,clientName:i,assignees:[a.assigned_to].filter(Boolean),dueDate:a.due_date?new Date(String(a.due_date)):void 0,stageKey:e.stage_key||e.name||void 0}});return{id:e.id,stageKey:e.stage_key||e.name||void 0,title:e.name,color:e.color,cards:a,wipLimit:e.wip_limit||void 0}}),[f,b]),eE=(0,i.Dy)((0,i.VT)(i.we,{activationConstraint:{distance:8}}),(0,i.VT)(i.Lg,{coordinateGetter:n.is}));(0,r.useEffect)(()=>{(async()=>{let e=await eI();W(e),await eq(e),await ez()})()},[]),(0,r.useEffect)(()=>{D&&eT(D)},[D]);let eI=async()=>{if(!m)return null;try{var e,a,t;let{data:{user:l}}=await w.supabase.auth.getUser();if(!(null==l?void 0:l.id))return null;let{data:r}=await w.supabase.from("employees").select("department, area_of_expertise, areas").eq("user_id",l.id).maybeSingle();return(0,eo.EP)({department:null!==(e=null==r?void 0:r.department)&&void 0!==e?e:null,area_of_expertise:null!==(a=null==r?void 0:r.area_of_expertise)&&void 0!==a?a:null,areas:null!==(t=null==r?void 0:r.areas)&&void 0!==t?t:null})}catch(e){return null}},eq=async e=>{try{z(!0);let a=w.supabase.from("kanban_boards").select("id, name, description, area_key").order("name");"area_only"===t&&(a=a.not("area_key","is",null));let{data:l,error:r}=await a;if(r)throw r;if(k(l||[]),!l||0===l.length){S(null),N([]),v([]),I(null);return}let s=!!D&&l.some(e=>e.id===D),i=e?l.find(a=>String(a.area_key||"")===String(e)):null,n=s?D:m&&(null==i?void 0:i.id)?String(i.id):String(l[0].id);I(n),S(l.find(e=>e.id===n)||null)}catch(e){console.error("Erro ao carregar quadros:",e)}finally{z(!1)}},ez=async()=>{try{let{data:{user:e}}=await w.supabase.auth.getUser();if(!e)return;let a=await (0,E.T)(w.supabase,e.id);J((null==a?void 0:a.user_type)||"")}catch(e){console.error("Erro ao carregar usu\xe1rio:",e)}},eT=async e=>{try{z(!0),S(_.find(a=>a.id===e)||null);let{data:a,error:t}=await w.supabase.from("kanban_columns").select("*").eq("board_id",e).order("position");if(t)throw t;N(a||[]);let{data:l,error:r}=await w.supabase.from("kanban_tasks").select("*").eq("board_id",e).order("position");if(r)throw r;let s=Array.from(new Set((l||[]).map(e=>e.assigned_to).filter(Boolean))),i=new Map;if(s.length>0){let e=await (0,E.m)(w.supabase,s);s.forEach(a=>{var t;let l=null===(t=e.get(a))||void 0===t?void 0:t.full_name;l&&i.set(a,l)})}let n=(l||[]).map(e=>({...e,assignee_name:e.assigned_to?i.get(e.assigned_to):void 0}));v(n)}catch(e){console.error("Erro ao carregar dados do Kanban:",e)}finally{z(!1)}},eA=(0,r.useMemo)(()=>{let e=new Set;return b.forEach(a=>{var t;null===(t=a.tags)||void 0===t||t.forEach(a=>e.add(a))}),Array.from(e)},[b]),eZ=(0,r.useMemo)(()=>b.filter(e=>{var a,t,l;if(B){let l=B.toLowerCase();if(!(e.title.toLowerCase().includes(l)||(null===(a=e.description)||void 0===a?void 0:a.toLowerCase().includes(l))||(null===(t=e.tags)||void 0===t?void 0:t.some(e=>e.toLowerCase().includes(l)))))return!1}if(H.assignees.length>0&&(!e.assigned_to||!H.assignees.includes(e.assigned_to))||H.tags.length>0&&!(null===(l=e.tags)||void 0===l?void 0:l.some(e=>H.tags.includes(e)))||H.priorities.length>0&&!H.priorities.includes(e.priority))return!1;if("all"!==H.dueDateFilter){let a=new Date,t=e.due_date?new Date(e.due_date):null;switch(H.dueDateFilter){case"overdue":if(!t||t>=a)return!1;break;case"today":if(!t||t.toDateString()!==a.toDateString())return!1;break;case"this_week":if(!t)return!1;let l=new Date(a.getTime()+6048e5);if(t<a||t>l)return!1;break;case"this_month":if(!t||t.getMonth()!==a.getMonth()||t.getFullYear()!==a.getFullYear())return!1;break;case"no_date":if(t)return!1}}return!0}),[b,B,H]),eP=async e=>{x(null);let{active:a,over:t}=e,l=a.id,r=b.find(e=>e.id===l);if(r)try{var s,i;let e=new Date().toISOString(),a=(null==p?void 0:p.taskId)===l?p.fromColumnId:r.column_id,n=ew(f,a),o=null!==(i=null!==(s=eN(f,b,t))&&void 0!==s?s:r.column_id)&&void 0!==i?i:null,d=ew(f,o);if(!d){console.error("DnD: coluna destino inv\xe1lida (n\xe3o encontrada no board)",{overId:null==t?void 0:t.id,activeTaskColumnId:r.column_id}),D&&await eT(D);return}let c=f.find(e=>e.id===d)||null,u=e_(c);if(n&&d&&n!==d&&(null==c?void 0:c.stage_key)){let e=f.find(e=>e.id===n)||null;if(ec({task:r,fromColumn:e,toColumn:c,toColumnId:d}))return}if(null==c?void 0:c.stage_key){let e=function(e){if(!String(e.stageKey||"").trim())return[];let a=ep(e),t=[];return"demanda"!==a&&t.push("description"),["producao","revisao_interna","aprovacao","publicacao_entrega","finalizado"].includes(a)&&t.push("assigned_to"),eh(t)}({areaKey:null==C?void 0:C.area_key,stageKey:c.stage_key});if(e.length){let a=function(e,a){let t=[];for(let l of a)"description"===l?String(e.description||"").trim()||t.push("description"):"assigned_to"!==l||String(e.assigned_to||"").trim()||t.push("assigned_to");return t.length?{ok:!1,missing:eh(t)}:{ok:!0}}({description:r.description,assigned_to:r.assigned_to},e);if(!a.ok){let e=a.missing.map(e=>"description"===e?"Descri\xe7\xe3o":"assigned_to"===e?"Respons\xe1vel":e);ev.Am.error('Antes de mover para "'.concat(c.name,'", preencha: ').concat(e.join(", "))),D&&await eT(D),X({taskId:l,toColumnId:d}),M(r),R(String(r.column_id||"")),Z(!0);return}}}let m=(null==t?void 0:t.id)?String(t.id):null,g=m&&b.find(e=>e.id===m)||null,x=b.filter(e=>e.column_id===d&&e.id!==l),h=x.length;if(g&&g.column_id===d){let e=x.findIndex(e=>e.id===g.id);e>=0&&(h=e)}let v=[...x];v.splice(h,0,{...r,column_id:d});let y=v.findIndex(e=>e.id===l),j=n&&f.find(e=>e.id===n)||null,N="aprovacao"===String((null==c?void 0:c.stage_key)||"").toLowerCase()&&"aprovacao"!==String((null==j?void 0:j.stage_key)||"").toLowerCase(),_=(null==r?void 0:r.reference_links)||{},k=(null==_?void 0:_.client_approval)||{},S=N?{..._,client_approval:{...k,status:"pending",requested_at:k.requested_at||e,due_at:k.due_at||function(e,a){let t=new Date(e);return t.setHours(t.getHours()+a),t.toISOString()}(k.requested_at||e,Number((null==c?void 0:c.sla_hours)||48))}}:_,{error:E}=await w.supabase.from("kanban_tasks").update({column_id:d,position:y,status:u,updated_at:e,...N?{reference_links:S}:{}}).eq("id",l);if(E)throw E;for(let e=0;e<v.length;e++){let a=v[e];a.id!==l&&Number(a.position)!==e&&await w.supabase.from("kanban_tasks").update({position:e}).eq("id",a.id)}if(n&&n!==d&&ef.test(String(n))){let e=b.filter(e=>e.column_id===n&&e.id!==l).slice().sort((e,a)=>Number(e.position)-Number(a.position));for(let a=0;a<e.length;a++){let t=e[a];Number(t.position)!==a&&await w.supabase.from("kanban_tasks").update({position:a}).eq("id",t.id)}}}catch(e){console.error("Erro ao atualizar tarefa:",e),D&&eT(D)}finally{h(null)}},eM=async(e,a)=>{try{let{error:t}=await w.supabase.from("kanban_columns").update({name:a}).eq("id",e);if(t)throw t;N(t=>t.map(t=>t.id===e?{...t,name:a}:t))}catch(e){console.error("Erro ao atualizar coluna:",e)}},eF=async e=>{if(confirm("Tem certeza que deseja deletar esta coluna? Todas as tarefas ser\xe3o removidas."))try{let{error:a}=await w.supabase.from("kanban_columns").delete().eq("id",e);if(a)throw a;N(a=>a.filter(a=>a.id!==e)),v(a=>a.filter(a=>a.column_id!==e))}catch(e){console.error("Erro ao deletar coluna:",e),alert("Erro ao deletar coluna. Verifique suas permiss\xf5es.")}},eL=async e=>{try{let{data:{user:a}}=await w.supabase.auth.getUser();if(!a)throw Error("Usu\xe1rio n\xe3o autenticado");let t=new Date().toISOString();if(P){let{error:a}=await w.supabase.from("kanban_tasks").update({title:e.title,description:e.description,priority:e.priority,tags:e.tags,assigned_to:e.assigned_to,updated_at:t}).eq("id",P.id);if(a)throw a;if(D&&await eT(D),(null==Q?void 0:Q.taskId)===P.id&&(null==Q?void 0:Q.toColumnId))try{await eg({taskId:Q.taskId,toColumnId:Q.toColumnId}),D&&await eT(D),ev.Am.success("Movimenta\xe7\xe3o conclu\xedda.")}catch(e){ev.Am.error((null==e?void 0:e.message)||"N\xe3o foi poss\xedvel mover a tarefa ap\xf3s salvar.")}finally{X(null)}}else{if(!C)return;if(!e.column_id){console.error("Erro ao salvar tarefa: column_id ausente");return}let l=ej(f,e.column_id);if(!l){console.error("Erro ao salvar tarefa: column_id inv\xe1lido (n\xe3o-uuid)",e.column_id);return}let r=b.filter(e=>e.column_id===l).length,s=f.find(e=>e.id===l)||null,i=e_(s),{data:n,error:o}=await w.supabase.from("kanban_tasks").insert({board_id:C.id,column_id:l,title:e.title,description:e.description,priority:e.priority,status:i,tags:e.tags,position:r,assigned_to:e.assigned_to,created_by:a.id,updated_at:t}).select().single();if(o)throw o;n&&D&&await eT(D)}M(void 0)}catch(e){console.error("Erro ao salvar tarefa:",e)}},eR=async e=>{if(confirm("Tem certeza que deseja deletar esta tarefa?"))try{let{error:a}=await w.supabase.from("kanban_tasks").delete().eq("id",e);if(a)throw a;v(a=>a.filter(a=>a.id!==e))}catch(e){console.error("Erro ao deletar tarefa:",e)}},eO=e=>{M(e),Z(!0)},eK=e=>{K(e)},eV=e=>{R(e),M(void 0),Z(!0)};return q?(0,l.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),(0,l.jsx)("p",{className:"mt-4 text-gray-600 dark:text-gray-400",children:"Carregando..."})]})}):(0,l.jsxs)("div",{className:"space-y-6 pb-8",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:(null==C?void 0:C.name)||"Kanban"}),(0,l.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:(null==C?void 0:C.description)||"Gerencie tarefas e projetos com drag & drop"}),d&&_.length>1&&(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsx)("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Quadro"}),(0,l.jsx)("select",{value:D||"",onChange:e=>I(e.target.value),className:"mt-1 w-full max-w-sm px-3 py-2 border rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white",children:_.map(e=>(0,l.jsx)("option",{value:e.id,children:e.name},e.id))})]})]}),(0,l.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,l.jsx)(V,{onNotificationClick:e=>{let a=b.find(a=>a.id===e);a&&K(a)}}),(0,l.jsxs)(c.z,{className:"bg-primary hover:bg-[#1260b5]",onClick:()=>{var e;return eV(null===(e=f[0])||void 0===e?void 0:e.id)},disabled:0===f.length,children:[(0,l.jsx)(y.Z,{className:"w-4 h-4 mr-2"}),"Nova Tarefa"]})]})]}),(null==C?void 0:C.id)&&(0,l.jsx)(en,{boardId:C.id,area:(null==C?void 0:C.name)||"Kanban",columns:ey}),(0,l.jsxs)("div",{className:"flex gap-3 items-center",children:[(0,l.jsxs)("div",{className:"flex-1 relative",children:[(0,l.jsx)(j.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,l.jsx)(u.II,{type:"text",placeholder:"Buscar tarefas por t\xedtulo, descri\xe7\xe3o ou tags...",value:B,onChange:e=>U(e.target.value),className:"pl-10"})]}),(0,l.jsx)(F,{onFiltersChange:G,availableTags:eA})]}),0===_.length?(0,l.jsx)(o.Zb,{children:(0,l.jsx)(o.aY,{className:"p-12 text-center",children:(0,l.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:m?"Nenhum quadro foi encontrado para sua \xe1rea. Verifique se seu cadastro tem \xe1rea preenchida (department/area_of_expertise) e se o admin executou a seed de boards por \xe1rea.":"Nenhum quadro encontrado."})})}):0===f.length?(0,l.jsx)(o.Zb,{children:(0,l.jsx)(o.aY,{className:"p-12 text-center",children:(0,l.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Nenhuma coluna encontrada para este quadro. Confirme se a seed de boards por \xe1rea foi aplicada no Supabase."})})}):(0,l.jsxs)(i.LB,{sensors:eE,collisionDetection:i.ey,onDragStart:e=>{let a=e.active.id;x(a);let t=b.find(e=>e.id===a);(null==t?void 0:t.column_id)&&h({taskId:a,fromColumnId:ej(f,t.column_id)||t.column_id})},onDragOver:e=>{let{active:a,over:t}=e;if(!t)return;let l=a.id,r=b.find(e=>e.id===l);if(!r)return;let s=eN(f,b,t);if(s&&r.column_id!==s)v(e=>e.map(e=>e.id===l?{...e,column_id:s}:e));else{let e=t.id,a=b.find(a=>a.id===e);if(!a||r.column_id!==a.column_id)return;v(a=>{let t=a.filter(e=>e.column_id===r.column_id),s=t.findIndex(e=>e.id===l),i=t.findIndex(a=>a.id===e);if(s!==i){let e=(0,n.Rp)(t,s,i);return[...a.filter(e=>e.column_id!==r.column_id),...e]}return a})}},onDragEnd:eP,children:[(0,l.jsx)("div",{className:"flex gap-4 overflow-x-auto pb-4",children:f.map(e=>{let a=eZ.filter(a=>a.column_id===e.id);return(0,l.jsxs)("div",{className:"flex flex-col flex-shrink-0 w-[340px]",children:[(0,l.jsx)(eS,{column:e,taskCount:a.length,onEdit:eM,onDelete:eF,canDelete:"super_admin"===Y&&!(null==C?void 0:C.area_key)}),(0,l.jsx)(n.Fo,{items:a.map(e=>e.id),strategy:n.qw,children:(0,l.jsxs)(eC,{column:e,children:[a.map(e=>(0,l.jsx)(ek,{task:e,onDelete:eR,onEdit:eO,onView:eK},e.id)),(0,l.jsxs)(c.z,{variant:"ghost",className:"w-full justify-start text-gray-600 dark:text-gray-400",onClick:()=>eV(e.id),children:[(0,l.jsx)(y.Z,{className:"w-4 h-4 mr-2"}),"Adicionar tarefa"]})]})})]},e.id)})}),(0,l.jsx)(i.y9,{children:g&&b.find(e=>e.id===g)?(0,l.jsx)("div",{className:"rotate-3",children:(0,l.jsx)(ek,{task:b.find(e=>e.id===g),onDelete:()=>{},onEdit:()=>{},onView:()=>{}})}):null})]}),(0,l.jsx)(eD,{isOpen:A,onClose:()=>{Z(!1),M(void 0)},onSave:eL,task:P,columnId:L}),O&&(0,l.jsx)(T,{task:O,isOpen:!!O,onClose:()=>K(null),onUpdate:()=>{D&&eT(D)}}),ee&&et&&(0,l.jsx)(ex,{isOpen:ee,onClose:()=>{ea(!1),el(null),es({}),D&&eT(D)},onConfirm:eu,cardTitle:(null===(e=b.find(e=>e.id===et.taskId))||void 0===e?void 0:e.title)||"Card",fromPhase:{id:et.fromColumnId,title:et.fromColumnTitle,color:et.fromColumnColor},toPhase:{id:et.toStageKey,title:et.toColumnTitle,color:et.toColumnColor},area:String((null==C?void 0:C.area_key)||""),existingData:er,fieldsOverride:function(e){let a=ep(e),t=eb[a]||eb.outros,l=function(e){let a=String(e||"").trim();if(!a)return null;switch(a){case"webdesigner":return"Web Designer";case"social_media":return"Social Media";case"trafego_pago":return"Tr\xe1fego";case"video_maker":return"Video Maker";case"designer_grafico":return"Designer";case"head_marketing":return"Head Marketing";case"comercial":return"Comercial";case"rh":return"RH";case"financeiro_pagar":case"financeiro_receber":return"Financeiro";default:return null}}(e.areaKey),r=l&&em[l]||[];return function(e){let a=new Set,t=[];for(let l of e)(null==l?void 0:l.id)&&(a.has(l.id)||(a.add(l.id),t.push(l)));return t}(["demanda","escopo","planejamento","producao"].includes(a)?[...t,...r]:t)}({areaKey:null==C?void 0:C.area_key,stageKey:et.toStageKey})})]})}},17168:function(e,a,t){t.d(a,{SP:function(){return d},dr:function(){return o},mQ:function(){return n},nU:function(){return c}});var l=t(57437),r=t(2265),s=t(93448);let i=r.createContext(void 0);function n(e){var a;let{defaultValue:t,value:n,onValueChange:o,children:d,className:c}=e;if(void 0===n&&void 0===t)throw Error("Tabs requires either `value` (controlled) or `defaultValue` (uncontrolled).");let u=null!==(a=null!=n?n:t)&&void 0!==a?a:"",[m,g]=r.useState(u);return r.useEffect(()=>{void 0!==n&&g(n)},[n]),(0,l.jsx)(i.Provider,{value:{activeTab:m,setActiveTab:e=>{void 0===n&&g(e),null==o||o(e)}},children:(0,l.jsx)("div",{className:(0,s.cn)("",c),children:d})})}function o(e){let{children:a,className:t}=e;return(0,l.jsx)("div",{className:(0,s.cn)("inline-flex h-10 items-center justify-center rounded-lg bg-gray-100 dark:bg-gray-800 p-1 text-gray-600 dark:text-gray-400",t),children:a})}function d(e){let{value:a,children:t,className:n}=e,o=r.useContext(i);if(!o)throw Error("TabsTrigger must be used within Tabs");let{activeTab:d,setActiveTab:c}=o,u=d===a;return(0,l.jsx)("button",{type:"button",onClick:()=>c(a),className:(0,s.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1.5 text-sm font-medium ring-offset-white transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-400 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",u?"bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700",n),children:t})}function c(e){let{value:a,children:t,className:n}=e,o=r.useContext(i);if(!o)throw Error("TabsContent must be used within Tabs");let{activeTab:d}=o;return d!==a?null:(0,l.jsx)("div",{className:(0,s.cn)("mt-2 ring-offset-white focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-400 focus-visible:ring-offset-2",n),children:t})}},72768:function(e,a,t){t.d(a,{EP:function(){return r},Ey:function(){return i},RV:function(){return s}});var l=t(64319);function r(e){var a,t;return(0,l.kT)({department:null!==(a=e.department)&&void 0!==a?a:null,area_of_expertise:null!==(t=e.area_of_expertise)&&void 0!==t?t:null,areas:Array.isArray(e.areas)?e.areas:null})}function s(e){var a;return e&&(null===(a=l.iN[e])||void 0===a?void 0:a.label)||"Colaborador"}function i(e){if(!e)return"colaborador";switch(e){case"designer_grafico":return"designer";case"social_media":return"social_media";case"head_marketing":return"head_marketing";case"trafego_pago":return"trafego";case"video_maker":return"video_maker";case"webdesigner":return"web_designer";case"copywriting":return"copywriting";case"comercial":return"comercial";case"juridico":return"juridico";case"contratos":return"contratos";case"operacao":return"operacao";case"notificacoes":return"notificacoes";case"financeiro_pagar":case"financeiro_receber":return"financeiro";case"rh":return"rh";default:return String(e)}}}}]);