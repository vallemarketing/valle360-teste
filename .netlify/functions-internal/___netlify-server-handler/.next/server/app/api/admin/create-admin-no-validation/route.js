"use strict";(()=>{var e={};e.id=25104,e.ids=[25104],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},18341:(e,a,r)=>{r.r(a),r.d(a,{originalPathname:()=>_,patchFetch:()=>g,requestAsyncStorage:()=>p,routeModule:()=>m,serverHooks:()=>c,staticGenerationAsyncStorage:()=>l});var s={};r.r(s),r.d(s,{POST:()=>d});var i=r(49303),t=r(88716),o=r(60670),n=r(87070),u=r(54128);async function d(e){try{if("1"!==process.env.ENABLE_SETUP_ROUTES)return n.NextResponse.json({error:"Not Found"},{status:404});let{email:a,password:r,role:s="super_admin",full_name:i}=await e.json();if(!a||!r)return n.NextResponse.json({error:"email e password s\xe3o obrigat\xf3rios"},{status:400});let t=(0,u.eI)("https://ikjgsqtykkhqimypacro.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlramdzcXR5a2tocWlteXBhY3JvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMyMTE4OTksImV4cCI6MjA3ODc4Nzg5OX0.vgVCpFIt-5ajFhcXg65dqrEw915pqW8fGZ8xgJxrnxI",{auth:{autoRefreshToken:!1,persistSession:!1,detectSessionInUrl:!1},db:{schema:"public"},global:{headers:{"X-Supabase-Admin":"true"}}});try{let{data:e,error:o}=await t.auth.admin.createUser({email:a,password:r,email_confirm:!0,user_metadata:{role:s,full_name:i||a.split("@")[0],user_type:"super_admin"===s?"super_admin":"admin"}});if(o){if(o.message.includes("weak")||o.message.includes("easy to guess")){let e=`Temp!${Date.now()}@Strong#${Math.random().toString(36).slice(2)}`,{data:o,error:u}=await t.auth.admin.createUser({email:a,password:e,email_confirm:!0,user_metadata:{role:s,full_name:i||a.split("@")[0],user_type:"super_admin"===s?"super_admin":"admin"}});if(u)throw Error(`Erro ao criar usu\xe1rio: ${u.message}`);let d=o.user.id;await t.from("users").upsert({id:d,email:a,full_name:i||a.split("@")[0],name:i||a.split("@")[0],role:s,user_type:"super_admin"===s?"super_admin":"admin",account_status:"active",is_active:!0,email_verified:!0,created_at:new Date().toISOString()}),await t.from("user_profiles").upsert({id:d,user_id:d,email:a,full_name:i||a.split("@")[0],user_type:"super_admin"===s?"super_admin":"admin",role:s,is_active:!0});try{await t.auth.admin.updateUserById(d,{password:r})}catch(e){console.warn("N\xe3o foi poss\xedvel atualizar para a senha desejada:",e)}return n.NextResponse.json({success:!0,message:`${s} criado com sucesso!`,credentials:{email:a,password:e,note:"Usu\xe1rio criado. Se n\xe3o conseguir logar com sua senha, use a senha tempor\xe1ria acima e depois troque no dashboard.",loginUrl:"super_admin"===s?"/admin/login":"/login"},user:o.user})}throw Error(o.message)}let u=e.user.id;return await t.from("users").upsert({id:u,email:a,full_name:i||a.split("@")[0],name:i||a.split("@")[0],role:s,user_type:"super_admin"===s?"super_admin":"admin",account_status:"active",is_active:!0,email_verified:!0,created_at:new Date().toISOString()}),await t.from("user_profiles").upsert({id:u,user_id:u,email:a,full_name:i||a.split("@")[0],user_type:"super_admin"===s?"super_admin":"admin",role:s,is_active:!0}),n.NextResponse.json({success:!0,message:`${s} criado com sucesso!`,credentials:{email:a,password:r,loginUrl:"super_admin"===s?"/admin/login":"/login"},user:e.user})}catch(e){return console.error("Erro ao criar usu\xe1rio:",e),n.NextResponse.json({error:e.message||"Erro ao criar usu\xe1rio",suggestion:"A valida\xe7\xe3o de senha forte est\xe1 ativa no projeto Supabase. Considere desabilit\xe1-la no Dashboard ou usar uma senha mais forte."},{status:400})}}catch(e){return console.error("Erro geral:",e),n.NextResponse.json({error:e.message||"Erro interno"},{status:500})}}let m=new i.AppRouteRouteModule({definition:{kind:t.x.APP_ROUTE,page:"/api/admin/create-admin-no-validation/route",pathname:"/api/admin/create-admin-no-validation",filename:"route",bundlePath:"app/api/admin/create-admin-no-validation/route"},resolvedPagePath:"C:\\Users\\User\\Downloads\\valle-360-main\\valle-360-main\\src\\app\\api\\admin\\create-admin-no-validation\\route.ts",nextConfigOutput:"standalone",userland:s}),{requestAsyncStorage:p,staticGenerationAsyncStorage:l,serverHooks:c}=m,_="/api/admin/create-admin-no-validation/route";function g(){return(0,o.patchFetch)({serverHooks:c,staticGenerationAsyncStorage:l})}}};var a=require("../../../../webpack-runtime.js");a.C(e);var r=e=>a(a.s=e),s=a.X(0,[89276,55972,54128],()=>r(18341));module.exports=s})();