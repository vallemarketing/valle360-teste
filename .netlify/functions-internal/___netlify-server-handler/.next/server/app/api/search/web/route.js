"use strict";(()=>{var e={};e.id=51755,e.ids=[51755],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},71665:(e,a,r)=>{r.r(a),r.d(a,{originalPathname:()=>y,patchFetch:()=>b,requestAsyncStorage:()=>m,routeModule:()=>h,serverHooks:()=>x,staticGenerationAsyncStorage:()=>w});var t={};r.r(t),r.d(t,{POST:()=>d,dynamic:()=>p});var s=r(49303),n=r(88716),o=r(60670),i=r(87070),c=r(20344),u=r(71615),l=r(52019);let p="force-dynamic";async function d(e){try{let a;let r=(0,u.cookies)(),t=(0,c.createRouteHandlerClient)({cookies:()=>r}),{data:{user:s},error:n}=await t.auth.getUser();if(n||!s)return i.NextResponse.json({error:"N\xe3o autorizado"},{status:401});let{type:o,query:p,options:d}=await e.json();if(!o||!p)return i.NextResponse.json({error:"type e query s\xe3o obrigat\xf3rios"},{status:400});switch(o){case"general":a=await l.T.search({query:p,searchDepth:d?.searchDepth||"basic",maxResults:d?.maxResults||10,includeAnswer:!0});break;case"news":a=await l.T.searchNews(p,d?.maxResults||10);break;case"company":a=await l.T.searchCompany(p);break;case"competitors":a=await l.T.searchCompetitors(p,d?.location,d?.excludeCompany);break;case"trends":a=await l.T.searchTrends(p);break;case"social":a=await l.T.searchSocialMedia(p);break;case"reputation":a=await l.T.searchReputation(p);break;default:return i.NextResponse.json({error:"Tipo de pesquisa inv\xe1lido"},{status:400})}try{await t.from("search_logs").insert({user_id:s.id,search_type:o,query:p,results_count:a.results.length,response_time:a.responseTime})}catch{}return i.NextResponse.json({success:!0,...a})}catch(e){return console.error("Erro na pesquisa web:",e),i.NextResponse.json({error:"Erro na pesquisa",details:e.message},{status:500})}}let h=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/search/web/route",pathname:"/api/search/web",filename:"route",bundlePath:"app/api/search/web/route"},resolvedPagePath:"C:\\Users\\User\\Downloads\\valle-360-main\\valle-360-main\\src\\app\\api\\search\\web\\route.ts",nextConfigOutput:"standalone",userland:t}),{requestAsyncStorage:m,staticGenerationAsyncStorage:w,serverHooks:x}=h,y="/api/search/web/route";function b(){return(0,o.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:w})}},52019:(e,a,r)=>{r.d(a,{T:()=>s});class t{constructor(){this.apiKey=process.env.TAVILY_API_KEY||""}async request(e,a){if(!this.apiKey)throw Error("TAVILY_API_KEY n\xe3o configurada");let r=await fetch(`https://api.tavily.com${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({api_key:this.apiKey,...a})});if(!r.ok){let e=await r.text();throw Error(`Erro Tavily: ${r.status} - ${e}`)}return r.json()}async search(e){let a=Date.now(),r=await this.request("/search",{query:e.query,search_depth:e.searchDepth||"basic",include_answer:e.includeAnswer??!0,include_raw_content:e.includeRawContent??!1,max_results:e.maxResults||10,include_domains:e.includeDomains,exclude_domains:e.excludeDomains,topic:e.topic||"general"});return{query:e.query,answer:r.answer,results:r.results.map(e=>({title:e.title,url:e.url,content:e.content,rawContent:e.raw_content,score:e.score,publishedDate:e.published_date})),responseTime:Date.now()-a}}async extract(e){return(await this.request("/extract",{urls:e.urls})).results.map(e=>({url:e.url,rawContent:e.raw_content,error:e.error}))}async searchNews(e,a=10){return this.search({query:e,topic:"news",searchDepth:"advanced",maxResults:a,includeAnswer:!0})}async searchCompany(e){return this.search({query:`${e} empresa informa\xe7\xf5es contato site`,searchDepth:"advanced",maxResults:10,includeAnswer:!0})}async searchCompetitors(e,a,r){let t=`principais empresas ${e}`;return a&&(t+=` em ${a}`),r&&(t+=` exceto ${r}`),this.search({query:t,searchDepth:"advanced",maxResults:15,includeAnswer:!0})}async searchTrends(e){return this.search({query:`tend\xeancias ${e} 2024 2025 mercado brasil`,topic:"news",searchDepth:"advanced",maxResults:10,includeAnswer:!0})}async searchSocialMedia(e){return this.search({query:`${e} instagram facebook linkedin twitter site:instagram.com OR site:facebook.com OR site:linkedin.com`,searchDepth:"advanced",maxResults:10,includeDomains:["instagram.com","facebook.com","linkedin.com","twitter.com"]})}async searchReputation(e){return this.search({query:`${e} avalia\xe7\xe3o review reclama\xe7\xe3o opini\xe3o`,searchDepth:"advanced",maxResults:15,includeAnswer:!0,includeDomains:["reclameaqui.com.br","google.com/maps","trustpilot.com"]})}}let s=new t}};var a=require("../../../../webpack-runtime.js");a.C(e);var r=e=>a(a.s=e),t=a.X(0,[89276,55972,54128,20958],()=>r(71665));module.exports=t})();