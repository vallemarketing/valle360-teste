"use strict";(()=>{var e={};e.id=28368,e.ids=[28368],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},62321:(e,s,r)=>{r.r(s),r.d(s,{originalPathname:()=>h,patchFetch:()=>g,requestAsyncStorage:()=>l,routeModule:()=>u,serverHooks:()=>I,staticGenerationAsyncStorage:()=>m});var t={};r.r(t),r.d(t,{POST:()=>d,dynamic:()=>c});var a=r(49303),i=r(88716),o=r(60670),n=r(87070),p=r(1926);let c="force-dynamic";async function d(e){try{let s=e.headers.get("authorization");if(!s||!s.startsWith("Bearer "))return n.NextResponse.json({error:"Unauthorized - Missing or invalid authorization header"},{status:401});let r=s.replace("Bearer ",""),t=process.env.ADS_INTEGRATION_API_KEY;if(!t||r!==t)return n.NextResponse.json({error:"Unauthorized - Invalid API key"},{status:401});let{client_id:a,period_start:i,period_end:o,roas:c,cpc:d,cpm:u,ctr:l,investment:m,conversions:I,leads:h,impressions:g,clicks:v,raw_data:f}=await e.json();if(!a||!i||!o)return n.NextResponse.json({error:"Missing required fields: client_id, period_start, period_end"},{status:400});let{data:x,error:_}=await p.O.from("traffic_metrics").insert({client_id:a,platform:"meta_ads",period_start:i,period_end:o,roas:c||0,cpc:d||0,cpm:u||0,ctr:l||0,investment:m||0,conversions:I||0,leads:h||0,impressions:g||0,clicks:v||0,raw_data:f||{},import_source:"api"}).select().single();if(_)return console.error("Error inserting Meta Ads data:",_),n.NextResponse.json({error:"Failed to insert metrics",details:_.message},{status:500});return n.NextResponse.json({success:!0,message:"Meta Ads metrics imported successfully",data:x},{status:201})}catch(e){return console.error("Error processing Meta Ads webhook:",e),n.NextResponse.json({error:"Internal server error",details:e.message},{status:500})}}let u=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/ads/meta/route",pathname:"/api/ads/meta",filename:"route",bundlePath:"app/api/ads/meta/route"},resolvedPagePath:"C:\\Users\\User\\Downloads\\valle-360-main\\valle-360-main\\src\\app\\api\\ads\\meta\\route.ts",nextConfigOutput:"standalone",userland:t}),{requestAsyncStorage:l,staticGenerationAsyncStorage:m,serverHooks:I}=u,h="/api/ads/meta/route";function g(){return(0,o.patchFetch)({serverHooks:I,staticGenerationAsyncStorage:m})}},1926:(e,s,r)=>{r.d(s,{O:()=>o});var t=r(54128);let a="https://ikjgsqtykkhqimypacro.supabase.co",i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlramdzcXR5a2tocWlteXBhY3JvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMyMTE4OTksImV4cCI6MjA3ODc4Nzg5OX0.vgVCpFIt-5ajFhcXg65dqrEw915pqW8fGZ8xgJxrnxI";a&&i||console.error("âŒ ERRO CR\xcdTICO: Vari\xe1veis de ambiente NEXT_PUBLIC_SUPABASE_URL ou NEXT_PUBLIC_SUPABASE_ANON_KEY n\xe3o encontradas!");let o=(0,t.eI)(a||"https://setup-missing.supabase.co",i||"setup-missing",{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}})}};var s=require("../../../../webpack-runtime.js");s.C(e);var r=e=>s(s.s=e),t=s.X(0,[89276,55972,54128],()=>r(62321));module.exports=t})();