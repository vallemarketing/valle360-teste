(()=>{var e={};e.id=77418,e.ids=[77418],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},13285:(e,r,s)=>{"use strict";s.r(r),s.d(r,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>d,routeModule:()=>h,tree:()=>c}),s(43908),s(9457),s(49991),s(35866);var t=s(23191),a=s(88716),l=s(37922),i=s.n(l),n=s(95231),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);s.d(r,o);let c=["",{children:["admin",{children:["predictions",{children:["churn",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,43908)),"C:\\Users\\User\\Downloads\\valle-360-main\\valle-360-main\\src\\app\\admin\\predictions\\churn\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,9457)),"C:\\Users\\User\\Downloads\\valle-360-main\\valle-360-main\\src\\app\\admin\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,49991)),"C:\\Users\\User\\Downloads\\valle-360-main\\valle-360-main\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\Users\\User\\Downloads\\valle-360-main\\valle-360-main\\src\\app\\admin\\predictions\\churn\\page.tsx"],x="/admin/predictions/churn/page",m={require:s,loadChunk:()=>Promise.resolve()},h=new t.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/admin/predictions/churn/page",pathname:"/admin/predictions/churn",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},32889:(e,r,s)=>{Promise.resolve().then(s.bind(s,76248))},86333:(e,r,s)=>{"use strict";s.d(r,{Z:()=>t});let t=(0,s(62881).Z)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},76248:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>m});var t=s(10326),a=s(17577),l=s(86333),i=s(37358),n=s(71821),o=s(29163),c=s(90434),d=s(90201),x=s(35047);function m(){let[e,r]=(0,a.useState)([]),[s,m]=(0,a.useState)(null),[h,p]=(0,a.useState)(!0),[u,y]=(0,a.useState)("all"),[b,g]=(0,a.useState)(null),[v,j]=(0,a.useState)(!1),N=(0,x.useRouter)(),f=async()=>{try{let e="all"===u?"/api/admin/predictions/churn":`/api/admin/predictions/churn?riskLevel=${u}`,s=await fetch(e),t=await s.json();t.success&&(r(t.predictions),m(t.stats))}catch(e){console.error("Error fetching churn predictions:",e)}finally{p(!1)}},_=e=>{switch(e){case"critical":return"#ef4444";case"high":return"#f97316";case"medium":return"#eab308";default:return"#10b981"}},C=e=>{switch(e){case"critical":return"bg-red-500 text-white";case"high":return"bg-orange-500 text-white";case"medium":return"bg-yellow-500 text-white";default:return"bg-green-500 text-white"}};return h?t.jsx("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),t.jsx("p",{style:{color:"var(--text-secondary)"},children:"Carregando predi\xe7\xf5es..."})]})}):(0,t.jsxs)("div",{className:"min-h-screen p-8",style:{backgroundColor:"var(--bg-primary)"},children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsxs)(c.default,{href:"/admin/predictions",className:"flex items-center text-sm mb-4 hover:underline",style:{color:"var(--primary-500)"},children:[t.jsx(l.Z,{className:"w-4 h-4 mr-1"})," Voltar ao Dashboard"]}),t.jsx("h1",{className:"text-3xl font-bold mb-2",style:{color:"var(--text-primary)"},children:"⚠️ Predi\xe7\xf5es de Churn de Clientes"}),t.jsx("p",{style:{color:"var(--text-secondary)"},children:"Identifique clientes em risco e tome a\xe7\xf5es preventivas"})]}),s&&(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[(0,t.jsxs)("div",{className:"p-6 rounded-xl border",style:{backgroundColor:"var(--bg-secondary)",borderColor:"var(--border-light)"},children:[t.jsx("p",{className:"text-sm mb-1",style:{color:"var(--text-tertiary)"},children:"Total Analisado"}),t.jsx("p",{className:"text-3xl font-bold",style:{color:"var(--text-primary)"},children:s.total})]}),(0,t.jsxs)("div",{className:"p-6 rounded-xl border",style:{backgroundColor:"var(--bg-secondary)",borderColor:"var(--border-light)"},children:[t.jsx("p",{className:"text-sm mb-1",style:{color:"var(--text-tertiary)"},children:"Risco Alto"}),t.jsx("p",{className:"text-3xl font-bold text-orange-500",children:s.high_risk})]}),(0,t.jsxs)("div",{className:"p-6 rounded-xl border",style:{backgroundColor:"var(--bg-secondary)",borderColor:"var(--border-light)"},children:[t.jsx("p",{className:"text-sm mb-1",style:{color:"var(--text-tertiary)"},children:"Risco Cr\xedtico"}),t.jsx("p",{className:"text-3xl font-bold text-red-500",children:s.critical_risk})]}),(0,t.jsxs)("div",{className:"p-6 rounded-xl border",style:{backgroundColor:"var(--bg-secondary)",borderColor:"var(--border-light)"},children:[t.jsx("p",{className:"text-sm mb-1",style:{color:"var(--text-tertiary)"},children:"Receita em Risco"}),(0,t.jsxs)("p",{className:"text-2xl font-bold text-red-500",children:["R$ ",(s.total_revenue_at_risk/1e3).toFixed(0),"k"]})]})]}),(0,t.jsxs)("div",{className:"flex gap-4 mb-6",children:[(0,t.jsxs)("button",{onClick:()=>y("all"),className:`px-4 py-2 rounded-lg text-sm font-medium ${"all"===u?"bg-blue-500 text-white":"bg-gray-200 dark:bg-gray-700"}`,children:["Todos (",s?.total||0,")"]}),(0,t.jsxs)("button",{onClick:()=>y("high"),className:`px-4 py-2 rounded-lg text-sm font-medium ${"high"===u?"bg-orange-500 text-white":"bg-gray-200 dark:bg-gray-700"}`,children:["Alto Risco (",s?.high_risk||0,")"]}),(0,t.jsxs)("button",{onClick:()=>y("critical"),className:`px-4 py-2 rounded-lg text-sm font-medium ${"critical"===u?"bg-red-500 text-white":"bg-gray-200 dark:bg-gray-700"}`,children:["Cr\xedtico (",s?.critical_risk||0,")"]})]}),t.jsx("div",{className:"space-y-4",children:0===e.length?t.jsx("div",{className:"text-center py-12",children:t.jsx("p",{style:{color:"var(--text-secondary)"},children:"Nenhuma predi\xe7\xe3o encontrada"})}):e.map(e=>(0,t.jsxs)("div",{className:"p-6 rounded-xl border",style:{backgroundColor:"var(--bg-secondary)",borderColor:"var(--border-light)"},children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,t.jsxs)("div",{className:"flex-1",children:[t.jsx("h3",{className:"text-xl font-bold mb-1",style:{color:"var(--text-primary)"},children:e.clients?.company_name||"Cliente"}),(0,t.jsxs)("p",{className:"text-sm",style:{color:"var(--text-secondary)"},children:[e.clients?.contact_name," • ",e.clients?.contact_email]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("div",{className:"text-right mr-4",children:[(0,t.jsxs)("p",{className:"text-3xl font-bold",style:{color:_(e.risk_level)},children:[e.churn_probability,"%"]}),t.jsx("p",{className:"text-xs",style:{color:"var(--text-tertiary)"},children:"probabilidade"})]}),t.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold ${C(e.risk_level)}`,children:e.risk_level.toUpperCase()})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4 p-4 rounded-lg",style:{backgroundColor:"var(--bg-primary)"},children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx(i.Z,{className:"w-5 h-5",style:{color:"var(--text-tertiary)"}}),(0,t.jsxs)("div",{children:[t.jsx("p",{className:"text-xs",style:{color:"var(--text-tertiary)"},children:"Dias at\xe9 churn"}),t.jsx("p",{className:"font-bold",style:{color:"var(--text-primary)"},children:e.days_until_churn||"N/A"})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx(n.Z,{className:"w-5 h-5",style:{color:"var(--text-tertiary)"}}),(0,t.jsxs)("div",{children:[t.jsx("p",{className:"text-xs",style:{color:"var(--text-tertiary)"},children:"Valor mensal"}),(0,t.jsxs)("p",{className:"font-bold",style:{color:"var(--text-primary)"},children:["R$ ",e.clients?.monthly_value||0]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx(o.Z,{className:"w-5 h-5",style:{color:"var(--text-tertiary)"}}),(0,t.jsxs)("div",{children:[t.jsx("p",{className:"text-xs",style:{color:"var(--text-tertiary)"},children:"Confian\xe7a"}),(0,t.jsxs)("p",{className:"font-bold",style:{color:"var(--text-primary)"},children:[e.confidence_level,"%"]})]})]})]}),e.warning_signals&&e.warning_signals.length>0&&(0,t.jsxs)("div",{className:"mb-4",children:[t.jsx("h4",{className:"text-sm font-bold mb-2",style:{color:"var(--text-primary)"},children:"⚠️ Sinais de Alerta:"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:e.warning_signals.map((e,r)=>t.jsx("span",{className:"px-3 py-1 rounded-full text-xs",style:{backgroundColor:"var(--bg-primary)",color:"var(--text-secondary)"},children:e},r))})]}),e.recommended_actions&&e.recommended_actions.length>0&&(0,t.jsxs)("div",{className:"mb-4",children:[t.jsx("h4",{className:"text-sm font-bold mb-2",style:{color:"var(--text-primary)"},children:"\uD83D\uDCA1 A\xe7\xf5es Recomendadas:"}),t.jsx("ul",{className:"space-y-1",children:e.recommended_actions.map((e,r)=>(0,t.jsxs)("li",{className:"text-sm flex items-start",children:[t.jsx("span",{className:"mr-2",style:{color:"var(--primary-500)"},children:"•"}),t.jsx("span",{style:{color:"var(--text-secondary)"},children:e})]},r))})]}),(0,t.jsxs)("div",{className:"flex gap-3 mt-4",children:[t.jsx("button",{onClick:()=>{g(e),j(!0)},className:"px-4 py-2 rounded-lg text-sm font-medium hover:opacity-80",style:{backgroundColor:"var(--primary-500)",color:"white"},children:"Iniciar Reten\xe7\xe3o"}),t.jsx("button",{onClick:()=>{N.push(`/admin/clientes?id=${e.client_id}`)},className:"px-4 py-2 rounded-lg text-sm font-medium border hover:bg-gray-50 dark:hover:bg-gray-800",style:{backgroundColor:"transparent",borderColor:"var(--border-light)",color:"var(--text-primary)"},children:"Ver Hist\xf3rico"})]})]},e.id))}),t.jsx(d.h,{clientId:b?.client_id||null,churnData:b,isOpen:v,onClose:()=>{j(!1),g(null),f()}})]})}},43908:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>t});let t=(0,s(68570).createProxy)(String.raw`C:\Users\User\Downloads\valle-360-main\valle-360-main\src\app\admin\predictions\churn\page.tsx#default`)}};var r=require("../../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[89276,54267,51789,78515,46226,28870,39215,16819,72418,86148,61288,36499,18832,14574,92237,67884],()=>s(13285));module.exports=t})();