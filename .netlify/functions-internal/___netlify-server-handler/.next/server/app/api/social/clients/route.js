"use strict";(()=>{var e={};e.id=83891,e.ids=[83891],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},30827:(e,a,t)=>{t.r(a),t.d(a,{originalPathname:()=>x,patchFetch:()=>S,requestAsyncStorage:()=>y,routeModule:()=>_,serverHooks:()=>g,staticGenerationAsyncStorage:()=>f});var r={};t.r(r),t.d(r,{GET:()=>m,dynamic:()=>p});var s=t(49303),n=t(88716),i=t(60670),o=t(87070),c=t(20344),u=t(71615),l=t(52955),d=t(90176);let p="force-dynamic";async function m(e){try{let e=(0,u.cookies)(),a=(0,c.createRouteHandlerClient)({cookies:()=>e}),t=await (0,l.U)({supabase:a});if(!t.allowed)return o.NextResponse.json({error:t.reason||"Acesso negado"},{status:403});let r=(0,d.t)(),{data:s,error:n}=await r.from("clients").select("id, company_name, nome_fantasia, razao_social, cidade, estado").order("company_name",{ascending:!0}).limit(2e3);if(n)return o.NextResponse.json({error:n.message},{status:500});let i=(s||[]).map(e=>{let a=e?.company_name||e?.nome_fantasia||e?.razao_social||"Cliente",t=e?.cidade||e?.city||null,r=e?.estado||e?.state||null;return{id:String(e.id),name:String(a),city:t,state:r}});return o.NextResponse.json({success:!0,clients:i})}catch(e){return o.NextResponse.json({error:e?.message||"Erro interno"},{status:500})}}let _=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/social/clients/route",pathname:"/api/social/clients",filename:"route",bundlePath:"app/api/social/clients/route"},resolvedPagePath:"C:\\Users\\User\\Downloads\\valle-360-main\\valle-360-main\\src\\app\\api\\social\\clients\\route.ts",nextConfigOutput:"standalone",userland:r}),{requestAsyncStorage:y,staticGenerationAsyncStorage:f,serverHooks:g}=_,x="/api/social/clients/route";function S(){return(0,i.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:f})}},90176:(e,a,t)=>{t.d(a,{t:()=>s});var r=t(54128);function s(){let e="https://ikjgsqtykkhqimypacro.supabase.co",a=process.env.SUPABASE_SERVICE_ROLE_KEY;if(!e||!a)throw Error("Supabase admin n\xe3o configurado (NEXT_PUBLIC_SUPABASE_URL / SUPABASE_SERVICE_ROLE_KEY).");return(0,r.eI)(e,a,{auth:{persistSession:!1,autoRefreshToken:!1,detectSessionInUrl:!1}})}},52955:(e,a,t)=>{t.d(a,{U:()=>i});var r=t(57157);async function s(e,a,t){try{let{data:r,error:s}=await e.rpc(a,t);if(s)return{ok:!1,error:s};return{ok:!0,data:r}}catch(e){return{ok:!1,error:e}}}function n(e){return Array.from(new Set(e))}async function i(e){let a=e.supabase,{data:t}=await a.auth.getUser(),i=t.user?.id;if(!i)return{userId:"",isSuperAdmin:!1,isAdmin:!1,allowed:!1,reason:"N\xe3o autenticado",areaKeys:[]};let o=await s(a,"is_admin"),c=!!o.ok&&!!o.data,u=await s(a,"is_super_admin"),l=!!u.ok&&!!u.data;if(c||l)return{userId:i,isSuperAdmin:l,isAdmin:c,allowed:!0,areaKeys:[]};let d=await s(a,"employee_area_keys");if(d.ok&&Array.isArray(d.data)){let e=(d.data||[]).map(e=>String(e)),a=e.includes("social_media")||e.includes("head_marketing");return{userId:i,isSuperAdmin:l,isAdmin:c,allowed:a,reason:a?void 0:"Acesso restrito: necess\xe1rio Social Media ou Head Marketing",areaKeys:n(e)}}let{data:p}=await a.from("employees").select("department, area_of_expertise, areas, is_active").eq("user_id",i).maybeSingle(),m=[];p?.department&&m.push(String(p.department)),p?.area_of_expertise&&m.push(String(p.area_of_expertise)),Array.isArray(p?.areas)&&m.push(...p.areas.map(e=>String(e)));let _=n(m.map(e=>(0,r.IY)(e)).filter(Boolean).map(e=>e)),y=_.includes("social_media")||_.includes("head_marketing");return{userId:i,isSuperAdmin:l,isAdmin:c,allowed:y,reason:y?void 0:"Acesso restrito: necess\xe1rio Social Media ou Head Marketing",areaKeys:_}}}};var a=require("../../../../webpack-runtime.js");a.C(e);var t=e=>a(a.s=e),r=a.X(0,[89276,55972,54128,20958,57157],()=>t(30827));module.exports=r})();