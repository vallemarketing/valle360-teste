(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[765],{85681:function(e,t,a){Promise.resolve().then(a.bind(a,96171))},30401:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(79205).Z)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},92934:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(79205).Z)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},99388:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(79205).Z)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},48736:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(79205).Z)("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},89345:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(79205).Z)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]])},76865:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(79205).Z)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},99376:function(e,t,a){"use strict";var s=a(35475);a.o(s,"useParams")&&a.d(t,{useParams:function(){return s.useParams}}),a.o(s,"usePathname")&&a.d(t,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}}),a.o(s,"useSearchParams")&&a.d(t,{useSearchParams:function(){return s.useSearchParams}})},96171:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return g}});var s=a(57437),r=a(2265),n=a(26892),c=a(76865),i=a(92934),l=a(99388),o=a(48736),d=a(31047),m=a(30401),x=a(89345),u=a(93448),p=a(81667),h=a(66916),y=a(14438),f=a(99376);function g(){let e=(0,f.useParams)().token,[t,a]=(0,r.useState)(null),[g,b]=(0,r.useState)(!0),[j,N]=(0,r.useState)(null),[v,w]=(0,r.useState)(!1),[k,P]=(0,r.useState)(""),[S,E]=(0,r.useState)(!1),[Z,_]=(0,r.useState)(null);(0,r.useEffect)(()=>{e&&R()},[e]);let R=async()=>{try{let t=await fetch("/api/proposals/accept",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({magic_link_token:e,action:"view"})}),s=await t.json();if(!t.ok)throw Error(s.error||"Erro ao carregar proposta");a(s.proposal)}catch(e){N(e.message)}finally{b(!1)}},C=async()=>{w(!0);try{let t=await fetch("/api/proposals/accept",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({magic_link_token:e,action:"accept"})}),a=await t.json();if(!t.ok)throw Error(a.error||"Erro ao aceitar proposta");_("accepted"),y.Am.success("Proposta aceita com sucesso!")}catch(e){y.Am.error(e.message)}finally{w(!1)}},M=async()=>{w(!0);try{let t=await fetch("/api/proposals/accept",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({magic_link_token:e,action:"reject",rejection_reason:k})}),a=await t.json();if(!t.ok)throw Error(a.error||"Erro ao rejeitar proposta");_("rejected"),E(!1),y.Am.success("Proposta rejeitada")}catch(e){y.Am.error(e.message)}finally{w(!1)}};if(g)return(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Carregando proposta..."})]})});if(j)return(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-red-50 to-amber-50 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl p-8 max-w-md text-center",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)(c.Z,{className:"w-8 h-8 text-red-500"})}),(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Ops!"}),(0,s.jsx)("p",{className:"text-gray-600",children:j})]})});if(Z)return(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 flex items-center justify-center p-4",children:(0,s.jsxs)(n.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl shadow-xl p-8 max-w-md text-center",children:[(0,s.jsx)("div",{className:(0,u.cn)("w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-6","accepted"===Z?"bg-green-100":"bg-gray-100"),children:"accepted"===Z?(0,s.jsx)(i.Z,{className:"w-10 h-10 text-green-500"}):(0,s.jsx)(l.Z,{className:"w-10 h-10 text-gray-500"})}),(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"accepted"===Z?"Proposta Aceita!":"Proposta Recusada"}),(0,s.jsx)("p",{className:"text-gray-600 mb-6",children:"accepted"===Z?"Em breve voc\xea receber\xe1 o contrato para assinatura. Obrigado pela confian\xe7a!":"Agradecemos seu tempo. Se tiver d\xfavidas, entre em contato conosco."}),"accepted"===Z&&(0,s.jsx)("div",{className:"p-4 bg-green-50 rounded-xl",children:(0,s.jsxs)("p",{className:"text-sm text-green-700",children:[(0,s.jsx)("strong",{children:"Pr\xf3ximo passo:"})," Nosso time jur\xeddico ir\xe1 preparar o contrato e enviar para voc\xea."]})})]})});if(!t)return null;let O=new Date(t.valid_until)<new Date,B=["accepted","rejected","expired"].includes(t.status);return(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 py-8 px-4",children:[(0,s.jsxs)("div",{className:"max-w-3xl mx-auto",children:[(0,s.jsxs)(n.E.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-center mb-8",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-500 rounded-2xl flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)(o.Z,{className:"w-8 h-8 text-white"})}),(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Proposta Comercial"}),(0,s.jsxs)("p",{className:"text-gray-600",children:["Ol\xe1, ",t.client_name,"!"]})]}),(O||B)&&(0,s.jsxs)(n.E.div,{initial:{opacity:0},animate:{opacity:1},className:(0,u.cn)("p-4 rounded-xl mb-6 text-center","accepted"===t.status?"bg-green-100 text-green-700":"rejected"===t.status?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"),children:["accepted"===t.status&&"✓ Esta proposta foi aceita","rejected"===t.status&&"✗ Esta proposta foi rejeitada","expired"===t.status&&"⚠ Esta proposta expirou",O&&"sent"===t.status&&"⚠ Esta proposta expirou"]}),(0,s.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-2xl shadow-xl overflow-hidden",children:[(0,s.jsxs)("div",{className:"p-4 bg-gray-50 border-b flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[(0,s.jsx)(d.Z,{className:"w-4 h-4"}),(0,s.jsxs)("span",{className:"text-sm",children:["V\xe1lida at\xe9 ",(0,p.WU)(new Date(t.valid_until),"dd 'de' MMMM 'de' yyyy",{locale:h.F})]})]}),!O&&!B&&(0,s.jsx)("span",{className:"text-xs px-2 py-1 bg-green-100 text-green-700 rounded-full",children:"V\xe1lida"})]}),(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Servi\xe7os Inclusos"}),(0,s.jsx)("div",{className:"space-y-4",children:t.services.map((e,t)=>(0,s.jsxs)(n.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.2+.1*t},className:"p-4 border rounded-xl",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-800",children:e.name}),e.description&&(0,s.jsx)("p",{className:"text-sm text-gray-500",children:e.description})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("p",{className:"font-bold text-gray-800",children:(e.price*e.quantity).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}),e.quantity>1&&(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:[e.quantity,"x ",e.price.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})]})]})]}),e.features&&e.features.length>0&&(0,s.jsx)("div",{className:"mt-2 space-y-1",children:e.features.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,s.jsx)(m.Z,{className:"w-4 h-4 text-green-500"}),e]},t))})]},t))}),(0,s.jsxs)("div",{className:"mt-6 pt-6 border-t space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between text-gray-600",children:[(0,s.jsx)("span",{children:"Subtotal"}),(0,s.jsx)("span",{children:t.subtotal.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})})]}),t.discount_percent>0&&(0,s.jsxs)("div",{className:"flex items-center justify-between text-green-600",children:[(0,s.jsxs)("span",{children:["Desconto (",t.discount_percent,"%)"]}),(0,s.jsxs)("span",{children:["-",t.discount_value.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between text-xl font-bold text-gray-800 pt-2 border-t",children:[(0,s.jsx)("span",{children:"Total"}),(0,s.jsx)("span",{children:t.total.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})})]})]}),t.payment_terms&&(0,s.jsxs)("div",{className:"mt-6 p-4 bg-blue-50 rounded-xl",children:[(0,s.jsx)("h3",{className:"font-semibold text-blue-800 mb-2",children:"Condi\xe7\xf5es de Pagamento"}),(0,s.jsx)("p",{className:"text-sm text-blue-700",children:t.payment_terms})]}),t.notes&&(0,s.jsxs)("div",{className:"mt-4 p-4 bg-gray-50 rounded-xl",children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-800 mb-2",children:"Observa\xe7\xf5es"}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:t.notes})]})]}),!O&&!B&&(0,s.jsxs)("div",{className:"p-6 bg-gray-50 border-t",children:[(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsx)("button",{onClick:()=>E(!0),disabled:v,className:"flex-1 px-6 py-3 border-2 border-gray-300 text-gray-700 rounded-xl font-semibold hover:bg-gray-100 transition-colors disabled:opacity-50",children:"Recusar"}),(0,s.jsx)("button",{onClick:C,disabled:v,className:"flex-1 px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-xl font-semibold hover:from-green-600 hover:to-emerald-600 transition-colors disabled:opacity-50 flex items-center justify-center gap-2",children:v?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Processando..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m.Z,{className:"w-5 h-5"}),"Aceitar Proposta"]})})]}),(0,s.jsx)("p",{className:"text-xs text-center text-gray-500 mt-4",children:"Ao aceitar, voc\xea concorda com os termos apresentados. O contrato ser\xe1 enviado para assinatura."})]})]}),(0,s.jsxs)("div",{className:"text-center mt-8 text-gray-500 text-sm",children:[(0,s.jsx)("p",{children:"D\xfavidas? Entre em contato conosco."}),(0,s.jsx)("div",{className:"flex items-center justify-center gap-4 mt-2",children:(0,s.jsxs)("a",{href:"mailto:contato@valle360.com",className:"flex items-center gap-1 hover:text-blue-600",children:[(0,s.jsx)(x.Z,{className:"w-4 h-4"}),"contato@valle360.com"]})})]})]}),S&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,s.jsxs)(n.E.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl shadow-2xl w-full max-w-md p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Recusar Proposta"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:"Poderia nos informar o motivo? Isso nos ajuda a melhorar."}),(0,s.jsx)("textarea",{value:k,onChange:e=>P(e.target.value),rows:4,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 mb-4",placeholder:"Motivo da recusa (opcional)"}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)("button",{onClick:()=>E(!1),className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancelar"}),(0,s.jsx)("button",{onClick:M,disabled:v,className:"flex-1 px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 disabled:opacity-50",children:v?"Processando...":"Confirmar Recusa"})]})]})})]})}},93448:function(e,t,a){"use strict";a.d(t,{cn:function(){return n},x:function(){return c}});var s=a(61994),r=a(53335);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.m6)((0,s.W)(t))}function c(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}}},function(e){e.O(0,[2882,6137,4438,3828,1667,2971,2117,1744],function(){return e(e.s=85681)}),_N_E=e.O()}]);