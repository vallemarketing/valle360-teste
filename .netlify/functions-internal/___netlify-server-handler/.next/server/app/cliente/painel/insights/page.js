(()=>{var e={};e.id=67627,e.ids=[67627],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},85322:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>c,routeModule:()=>h,tree:()=>d}),a(25026),a(16193),a(49991),a(35866);var s=a(23191),r=a(88716),l=a(37922),i=a.n(l),n=a(95231),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);a.d(t,o);let d=["",{children:["cliente",{children:["painel",{children:["insights",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,25026)),"C:\\Users\\User\\Downloads\\valle-360-main\\valle-360-main\\src\\app\\cliente\\painel\\insights\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,16193)),"C:\\Users\\User\\Downloads\\valle-360-main\\valle-360-main\\src\\app\\cliente\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,49991)),"C:\\Users\\User\\Downloads\\valle-360-main\\valle-360-main\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,35866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\User\\Downloads\\valle-360-main\\valle-360-main\\src\\app\\cliente\\painel\\insights\\page.tsx"],x="/cliente/painel/insights/page",m={require:a,loadChunk:()=>Promise.resolve()},h=new s.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/cliente/painel/insights/page",pathname:"/cliente/painel/insights",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},60778:(e,t,a)=>{Promise.resolve().then(a.bind(a,71914))},86333:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(62881).Z)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},7027:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(62881).Z)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]])},77506:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(62881).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},687:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(62881).Z)("thumbs-down",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]])},3634:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(62881).Z)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]])},71914:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>v});var s=a(10326),r=a(28870),l=a(90434),i=a(17577),n=a(14802),o=a(17069),d=a(50949),c=a(3634),x=a(86333),m=a(1572),h=a(77506),p=a(7027),b=a(30361),g=a(39183),u=a(687),y=a(51223);let f={oportunidade:{icon:n.Z,color:"text-emerald-600",bgColor:"bg-emerald-500",label:"Oportunidade"},melhoria:{icon:o.Z,color:"text-[#1672d6]",bgColor:"bg-[#1672d6]",label:"Melhoria"},alerta:{icon:d.Z,color:"text-primary",bgColor:"bg-primary",label:"Alerta"},tendencia:{icon:c.Z,color:"text-purple-600",bgColor:"bg-purple-500",label:"Tend\xeancia"}},j={alta:{color:"bg-red-500/10 text-red-600",label:"Alta"},media:{color:"bg-yellow-500/10 text-yellow-600",label:"M\xe9dia"},baixa:{color:"bg-gray-500/10 text-gray-600",label:"Baixa"}},w={novo:{color:"bg-[#1672d6]/10 text-[#1672d6]",label:"Novo"},em_analise:{color:"bg-yellow-500/10 text-yellow-600",label:"Em An\xe1lise"},implementado:{color:"bg-emerald-500/10 text-emerald-600",label:"Implementado"},ignorado:{color:"bg-gray-500/10 text-gray-600",label:"Ignorado"}};function v(){let[e,t]=(0,i.useState)("all"),[a,n]=(0,i.useState)(!0),[o,c]=(0,i.useState)(!1),[v,N]=(0,i.useState)(null),[k,Z]=(0,i.useState)(null),[C,_]=(0,i.useState)([]),[z,A]=(0,i.useState)(null),P=async()=>{n(!0),N(null);try{let e=await fetch("/api/client/insights"),t=await e.json().catch(()=>null);if(!e.ok)throw Error(t?.error||"Falha ao carregar insights");if(t?.warning==="missing_table_client_ai_insights"){Z(String(t?.instruction||"Banco ainda n\xe3o preparado para Insights IA.")),_([]);return}_(Array.isArray(t?.insights)?t.insights:[])}catch(e){N(String(e?.message||"Erro ao carregar"))}finally{n(!1)}},E=(0,i.useMemo)(()=>C.filter(t=>"all"===e||t.status===e),[C,e]),M=(0,i.useMemo)(()=>({total:C.length,implementados:C.filter(e=>"implementado"===e.status).length,alta:C.filter(e=>"alta"===e.priority&&"novo"===e.status).length}),[C]),S=(0,i.useMemo)(()=>{let e=C.find(e=>"novo"===e.status&&"alta"===e.priority)||C[0];if(!e)return null;let t=C.filter(e=>"novo"===e.status).length;return{count:C.length,countNew:t,urgentTitle:e.title}},[C]),q=async()=>{c(!0),Z(null),N(null);try{let e=await fetch("/api/client/insights",{method:"POST"}),t=await e.json().catch(()=>null);if(!e.ok)throw Error(t?.error||"Falha ao gerar insights");t?.skipped?Z(`J\xe1 existem insights gerados hoje (${t.existingCount}).`):Z(`Insights gerados com sucesso: ${Number(t?.created||0)}.`),await P()}catch(e){N(String(e?.message||"Erro ao gerar"))}finally{c(!1)}},I=async(e,t)=>{A(e),N(null);try{let a=await fetch("/api/client/insights",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,status:t})}),s=await a.json().catch(()=>null);if(!a.ok)throw Error(s?.error||"Falha ao atualizar status");_(a=>a.map(a=>a.id===e?{...a,status:t}:a))}catch(e){N(String(e?.message||"Erro ao atualizar"))}finally{A(null)}};return(0,s.jsxs)("div",{className:"p-4 lg:p-6 space-y-6 max-w-7xl mx-auto",children:[(0,s.jsxs)(r.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(l.default,{href:"/cliente/painel",className:"p-2 rounded-lg bg-[#001533]/5 hover:bg-[#001533]/10 transition-colors",children:s.jsx(x.Z,{className:"size-5 text-[#001533] dark:text-white"})}),s.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-emerald-500 to-emerald-600",children:s.jsx(m.Z,{className:"size-5 text-white"})}),s.jsx("h1",{className:"text-3xl font-bold text-[#001533] dark:text-white",children:"Insights IA"})]}),s.jsx("p",{className:"text-[#001533]/60 dark:text-white/60 ml-12",children:"Recomenda\xe7\xf5es personalizadas da Val para seu neg\xf3cio (com fontes)"})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>void P(),disabled:a||o,className:(0,y.cn)("px-4 py-3 rounded-xl font-semibold transition-colors","border-2 border-[#001533]/10 dark:border-white/10","text-[#001533] dark:text-white hover:bg-[#001533]/5 dark:hover:bg-white/5","disabled:opacity-50 disabled:cursor-not-allowed"),children:"Atualizar"}),s.jsx("button",{onClick:()=>void q(),disabled:a||o,className:(0,y.cn)("px-4 py-3 rounded-xl font-semibold transition-colors","bg-[#1672d6] text-white hover:bg-[#1260b5]","disabled:opacity-50 disabled:cursor-not-allowed"),children:o?(0,s.jsxs)("span",{className:"inline-flex items-center gap-2",children:[s.jsx(h.Z,{className:"size-4 animate-spin"})," Gerando…"]}):"Gerar insights (hoje)"})]})]}),(k||v)&&(0,s.jsxs)("div",{className:(0,y.cn)("rounded-xl border p-4 text-sm flex items-start gap-2",v?"border-red-200 bg-red-50 text-red-700":"border-[#001533]/10 bg-[#001533]/5 text-[#001533]"),children:[s.jsx(d.Z,{className:"size-4 mt-0.5"}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"font-medium",children:v?"Aten\xe7\xe3o":"Info"}),s.jsx("p",{className:"mt-1 opacity-80",children:v||k})]})]}),(0,s.jsxs)(r.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:(0,y.cn)("grid grid-cols-3 gap-4",a&&"opacity-70"),children:[(0,s.jsxs)("div",{className:"rounded-xl border-2 border-[#001533]/10 dark:border-white/10 bg-white dark:bg-[#001533]/50 p-4 text-center",children:[s.jsx("p",{className:"text-3xl font-bold text-[#001533] dark:text-white",children:M.total}),s.jsx("p",{className:"text-sm text-[#001533]/60 dark:text-white/60",children:"Total de Insights"})]}),(0,s.jsxs)("div",{className:"rounded-xl border-2 border-[#001533]/10 dark:border-white/10 bg-white dark:bg-[#001533]/50 p-4 text-center",children:[s.jsx("p",{className:"text-3xl font-bold text-emerald-600",children:M.implementados}),s.jsx("p",{className:"text-sm text-[#001533]/60 dark:text-white/60",children:"Implementados"})]}),(0,s.jsxs)("div",{className:"rounded-xl border-2 border-[#001533]/10 dark:border-white/10 bg-white dark:bg-[#001533]/50 p-4 text-center",children:[s.jsx("p",{className:"text-3xl font-bold text-[#1672d6]",children:M.alta}),s.jsx("p",{className:"text-sm text-[#001533]/60 dark:text-white/60",children:"Alta prioridade (novos)"})]})]}),(0,s.jsxs)(r.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"flex gap-2 overflow-x-auto pb-2",children:[(0,s.jsxs)("button",{onClick:()=>t("all"),className:(0,y.cn)("px-4 py-2 rounded-lg font-medium whitespace-nowrap transition-colors","all"===e?"bg-[#1672d6] text-white":"bg-[#001533]/5 dark:bg-white/5 text-[#001533] dark:text-white hover:bg-[#001533]/10 dark:hover:bg-white/10"),children:["Todos (",C.length,")"]}),Object.entries(w).map(([a,r])=>{let l=C.filter(e=>e.status===a).length;return(0,s.jsxs)("button",{onClick:()=>t(a),className:(0,y.cn)("px-4 py-2 rounded-lg font-medium whitespace-nowrap transition-colors",e===a?"bg-[#1672d6] text-white":"bg-[#001533]/5 dark:bg-white/5 text-[#001533] dark:text-white hover:bg-[#001533]/10 dark:hover:bg-white/10"),children:[r.label," (",l,")"]},a)})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[E.map((e,t)=>{let a=f[e.type],l=j[e.priority],i=w[e.status],n=a.icon,o=z===e.id,d=Array.isArray(e.sources)?e.sources.filter(Boolean):[];return s.jsx(r.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2+.03*t},className:(0,y.cn)("rounded-2xl border-2 bg-white dark:bg-[#001533]/50 overflow-hidden","alta"===e.priority?"border-red-500/30":"border-[#001533]/10 dark:border-white/10"),children:(0,s.jsxs)("div",{className:"p-6",children:[s.jsx("div",{className:"flex flex-col md:flex-row md:items-start justify-between gap-4",children:(0,s.jsxs)("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:(0,y.cn)("p-3 rounded-xl",a.bgColor),children:s.jsx(n,{className:"size-6 text-white"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-2 mb-2",children:[s.jsx("span",{className:(0,y.cn)("px-2 py-0.5 rounded-full text-xs font-bold",i.color),children:i.label}),(0,s.jsxs)("span",{className:(0,y.cn)("px-2 py-0.5 rounded-full text-xs font-bold",l.color),children:["Prioridade ",l.label]}),s.jsx("span",{className:(0,y.cn)("px-2 py-0.5 rounded-full text-xs font-bold",a.color,"bg-current/10"),children:a.label})]}),s.jsx("h3",{className:"text-lg font-bold text-[#001533] dark:text-white mb-2",children:e.title}),s.jsx("p",{className:"text-[#001533]/70 dark:text-white/70",children:e.description})]})]})}),(0,s.jsxs)("div",{className:"mt-4 pt-4 border-t border-[#001533]/10 dark:border-white/10 grid md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-xs font-semibold text-[#001533]/60 dark:text-white/60 uppercase mb-1",children:"Impacto Estimado"}),s.jsx("p",{className:"font-bold text-[#1672d6]",children:e.impact||"—"})]}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-xs font-semibold text-[#001533]/60 dark:text-white/60 uppercase mb-1",children:"A\xe7\xe3o Recomendada"}),s.jsx("p",{className:"text-[#001533] dark:text-white",children:e.action||"—"})]})]}),d.length>0&&(0,s.jsxs)("div",{className:"mt-4 pt-4 border-t border-[#001533]/10 dark:border-white/10",children:[(0,s.jsxs)("p",{className:"text-xs font-semibold text-[#001533]/60 dark:text-white/60 uppercase mb-2",children:["Fontes ",e.provider?`(${e.provider})`:""]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:d.slice(0,8).map(e=>(0,s.jsxs)("a",{href:e,target:"_blank",rel:"noreferrer",className:"flex items-center justify-between gap-2 rounded-xl border border-[#001533]/10 dark:border-white/10 bg-white/60 dark:bg-[#001533]/30 px-3 py-2 hover:border-[#1672d6]/30 transition-colors",children:[s.jsx("span",{className:"text-xs text-[#1672d6] underline break-all",children:function(e){try{return new URL(e).hostname}catch{return e}}(e)}),s.jsx(p.Z,{className:"size-4 text-[#001533]/40 dark:text-white/40"})]},e))})]}),"novo"===e.status&&(0,s.jsxs)("div",{className:"mt-4 flex flex-col md:flex-row gap-3",children:[(0,s.jsxs)("button",{onClick:()=>void I(e.id,"implementado"),disabled:o,className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 rounded-xl bg-[#1672d6] text-white font-semibold hover:bg-[#1672d6]/90 transition-colors disabled:opacity-50",children:[o?s.jsx(h.Z,{className:"size-5 animate-spin"}):s.jsx(b.Z,{className:"size-5"}),"Implementar"]}),(0,s.jsxs)("button",{onClick:()=>void I(e.id,"em_analise"),disabled:o,className:"flex items-center justify-center gap-2 px-4 py-3 rounded-xl border-2 border-[#001533]/10 text-[#001533] dark:text-white hover:bg-[#001533]/5 transition-colors disabled:opacity-50",children:[s.jsx(g.Z,{className:"size-5"}),"Em an\xe1lise"]}),(0,s.jsxs)("button",{onClick:()=>void I(e.id,"ignorado"),disabled:o,className:"flex items-center justify-center gap-2 px-4 py-3 rounded-xl border-2 border-[#001533]/10 text-[#001533] dark:text-white hover:bg-[#001533]/5 transition-colors disabled:opacity-50",children:[s.jsx(u.Z,{className:"size-5"}),"Ignorar"]})]})]})},e.id)}),!a&&0===E.length&&(0,s.jsxs)("div",{className:"text-center py-12",children:[s.jsx(m.Z,{className:"size-12 text-[#001533]/20 dark:text-white/20 mx-auto mb-4"}),s.jsx("p",{className:"text-[#001533]/60 dark:text-white/60",children:"Nenhum insight encontrado."}),s.jsx("button",{onClick:()=>void q(),className:"mt-4 px-4 py-3 rounded-xl bg-[#1672d6] text-white font-semibold hover:bg-[#1260b5] transition-colors",children:"Gerar insights (hoje)"})]})]}),s.jsx(r.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"rounded-2xl bg-gradient-to-r from-[#001533] to-[#1672d6] p-6",children:(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"p-3 rounded-xl bg-white/20",children:s.jsx(m.Z,{className:"size-8 text-white"})}),(0,s.jsxs)("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-bold text-white",children:"\uD83D\uDC9C Resumo da Val"}),s.jsx("p",{className:"text-white/80 mt-1",children:S?`Hoje eu tenho ${S.count} insights para voc\xea (${S.countNew} novos). O mais importante agora: "${S.urgentTitle}". Quer que eu detalhe e transforme isso em um plano de a\xe7\xe3o?`:"Gere seus insights do dia e eu te ajudo a transformar em um plano de a\xe7\xe3o."})]}),s.jsx(l.default,{href:"/cliente/ia",className:"px-6 py-3 rounded-xl bg-white text-[#001533] font-semibold hover:bg-white/90 transition-colors whitespace-nowrap",children:"Conversar"})]})})]})}},25026:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>s});let s=(0,a(68570).createProxy)(String.raw`C:\Users\User\Downloads\valle-360-main\valle-360-main\src\app\cliente\painel\insights\page.tsx#default`)}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[89276,54267,51789,78515,46226,28870,39215,16819,72418,62198,18832,14574,79925],()=>a(85322));module.exports=s})();