(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3343],{23949:function(e,t,s){Promise.resolve().then(s.bind(s,98499))},76858:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(79205).Z)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},92934:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(79205).Z)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},91723:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(79205).Z)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},89345:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(79205).Z)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]])},2961:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(79205).Z)("radar",[["path",{d:"M19.07 4.93A10 10 0 0 0 6.99 3.34",key:"z3du51"}],["path",{d:"M4 6h.01",key:"oypzma"}],["path",{d:"M2.29 9.62A10 10 0 1 0 21.31 8.35",key:"qzzz0"}],["path",{d:"M16.24 7.76A6 6 0 1 0 8.23 16.67",key:"1yjesh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M17.99 11.66A6 6 0 0 1 15.77 16.67",key:"1u2y91"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"m13.41 10.59 5.66-5.66",key:"mhq4k0"}]])},3085:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(79205).Z)("trending-down",[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]])},11239:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(79205).Z)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]])},98499:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return g}});var r=s(57437),a=s(2265),n=s(95452),i=s(2961),c=s(91723),l=s(92934),d=s(89345);let o=(0,s(79205).Z)("heart-pulse",[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}],["path",{d:"M3.22 13H9.5l.5-1 2 4.5 2-7 1.5 3.5h5.27",key:"auskq0"}]]);var m=s(3085),x=s(11239),h=s(76858),p=s(14438),u=s(26892);function g(){let[e,t]=(0,a.useState)([]),[s,g]=(0,a.useState)([]),[y,b]=(0,a.useState)([]),[f,j]=(0,a.useState)(!0),v=(0,n.createClientComponentClient)();(0,a.useEffect)(()=>{N()},[]);let N=async()=>{j(!0);try{let{data:e,error:s}=await v.from("view_upsell_opportunities").select("*").limit(10);if(s)throw s;let{data:r,error:a}=await v.from("view_expiring_contracts").select("*").order("days_remaining",{ascending:!0});if(a)throw a;let{data:n,error:i}=await v.from("view_client_health").select("*").in("churn_risk",["high","medium"]).order("health_score",{ascending:!0}).limit(5);if(i)throw i;t(e||[]),g(r||[]),b(n||[])}catch(e){console.error("Erro ao carregar radar:",e),p.Am.error("Erro ao carregar dados do radar de vendas")}finally{j(!1)}},w=async e=>{p.Am.promise(new Promise(e=>setTimeout(e,1500)),{loading:"Gerando proposta de ".concat(e.service_name," para ").concat(e.client_name,"..."),success:"Proposta enviada para o cliente com sucesso!",error:"Erro ao enviar proposta"})},_=async e=>{p.Am.promise(new Promise(e=>setTimeout(e,1500)),{loading:"Preparando renova\xe7\xe3o para ".concat(e.client_name,"..."),success:"Link de renova\xe7\xe3o enviado!",error:"Erro ao processar renova\xe7\xe3o"})},k=async e=>{p.Am.success("Iniciando contato de reten\xe7\xe3o com ".concat(e.client_name))};return f?(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}):(0,r.jsxs)("div",{className:"p-8 space-y-8 bg-gray-50 min-h-screen",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[(0,r.jsx)(i.Z,{className:"w-8 h-8 text-purple-600"}),"Radar de Vendas"]}),(0,r.jsx)("p",{className:"text-gray-600 mt-2",children:"Intelig\xeancia preditiva para identificar oportunidades e riscos."})]}),(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsxs)("div",{className:"bg-white px-4 py-2 rounded-lg shadow-sm border border-gray-200 text-center",children:[(0,r.jsx)("p",{className:"text-xs text-gray-500 font-medium uppercase",children:"Potencial em Aberto"}),(0,r.jsxs)("p",{className:"text-xl font-bold text-green-600",children:["R$ ",e.reduce((e,t)=>e+t.potential_revenue,0).toLocaleString("pt-BR")]})]}),(0,r.jsxs)("div",{className:"bg-white px-4 py-2 rounded-lg shadow-sm border border-gray-200 text-center",children:[(0,r.jsx)("p",{className:"text-xs text-gray-500 font-medium uppercase",children:"Contratos em Risco"}),(0,r.jsx)("p",{className:"text-xl font-bold text-primary",children:s.length+y.length})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,r.jsxs)("div",{className:"lg:col-span-1 space-y-8",children:[(0,r.jsxs)("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-amber-100",children:[(0,r.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2 mb-4",children:[(0,r.jsx)(c.Z,{className:"w-5 h-5 text-primary"}),"Renova\xe7\xf5es Pr\xf3ximas"]}),0===s.length?(0,r.jsxs)("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-xl",children:[(0,r.jsx)(l.Z,{className:"w-12 h-12 mx-auto mb-2 text-green-400"}),(0,r.jsx)("p",{children:"Nenhum contrato vencendo em breve."})]}):(0,r.jsx)("div",{className:"space-y-4",children:s.map(e=>(0,r.jsxs)(u.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"p-4 rounded-xl border-l-4 ".concat("critical"===e.urgency_level?"bg-red-50 border-red-500":"bg-amber-50 border-amber-400"),children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-bold text-gray-900",children:e.client_name}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:e.client_email})]}),(0,r.jsxs)("span",{className:"text-xs font-bold px-2 py-1 rounded-full ".concat("critical"===e.urgency_level?"bg-red-100 text-red-700":"bg-amber-100 text-amber-700"),children:[e.days_remaining," dias"]})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center mt-3",children:[(0,r.jsxs)("p",{className:"font-semibold text-gray-900",children:["R$ ",e.contract_value.toLocaleString("pt-BR")]}),(0,r.jsxs)("button",{onClick:()=>_(e),className:"text-sm px-3 py-1.5 bg-white shadow-sm rounded-lg font-medium text-gray-700 hover:bg-gray-50 transition-colors flex items-center gap-1",children:[(0,r.jsx)(d.Z,{className:"w-3 h-3"}),"Propor Renova\xe7\xe3o"]})]})]},e.contract_id))})]}),(0,r.jsxs)("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-red-100",children:[(0,r.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2 mb-4",children:[(0,r.jsx)(o,{className:"w-5 h-5 text-red-500"}),"Risco de Churn (Aten\xe7\xe3o)"]}),0===y.length?(0,r.jsxs)("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-xl",children:[(0,r.jsx)(l.Z,{className:"w-12 h-12 mx-auto mb-2 text-green-400"}),(0,r.jsx)("p",{children:"Carteira saud\xe1vel! Nenhum cliente em risco alto."})]}):(0,r.jsx)("div",{className:"space-y-4",children:y.map(e=>(0,r.jsxs)("div",{className:"p-4 rounded-xl bg-red-50 border border-red-100",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-bold text-gray-900",children:e.client_name}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,r.jsx)("div",{className:"w-24 h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,r.jsx)("div",{className:"h-full ".concat(e.health_score<40?"bg-red-500":"bg-primary"),style:{width:"".concat(e.health_score,"%")}})}),(0,r.jsxs)("span",{className:"text-xs font-bold text-red-700",children:[e.health_score,"/100"]})]})]}),"decreasing"===e.trend&&(0,r.jsx)(m.Z,{className:"w-4 h-4 text-red-500"})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center mt-3",children:[(0,r.jsxs)("span",{className:"text-xs text-red-600 font-medium bg-red-100 px-2 py-1 rounded",children:["Risco ","high"===e.churn_risk?"Alto":"M\xe9dio"]}),(0,r.jsx)("button",{onClick:()=>k(e),className:"text-sm px-3 py-1.5 bg-white shadow-sm rounded-lg font-medium text-red-700 hover:bg-red-50 transition-colors",children:"Plano de Reten\xe7\xe3o"})]})]},e.contract_id))})]})]}),(0,r.jsx)("div",{className:"lg:col-span-2",children:(0,r.jsxs)("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-purple-100 h-full",children:[(0,r.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2 mb-6",children:[(0,r.jsx)(x.Z,{className:"w-5 h-5 text-purple-500"}),"Sugest\xf5es de Upsell & Cross-sell"]}),0===e.length?(0,r.jsx)("div",{className:"text-center py-12 text-gray-500",children:(0,r.jsx)("p",{children:"Sem oportunidades identificadas no momento."})}):(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.map((e,t)=>(0,r.jsxs)(u.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},className:"group relative p-5 rounded-xl border border-gray-200 hover:border-purple-300 hover:shadow-md transition-all bg-white flex flex-col justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,r.jsx)("div",{className:"px-2 py-1 bg-purple-50 rounded text-xs font-medium text-purple-700 mb-2 inline-block",children:e.category||"Servi\xe7o"}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Probabilidade"}),(0,r.jsxs)("p",{className:"font-bold text-green-600",children:[e.probability_score,"%"]})]})]}),(0,r.jsx)("h3",{className:"font-bold text-gray-900 text-lg mb-1",children:e.service_name}),(0,r.jsxs)("p",{className:"text-sm text-gray-500 mb-4",children:["Para: ",(0,r.jsx)("span",{className:"font-medium text-gray-900",children:e.client_name})]})]}),(0,r.jsxs)("div",{className:"flex items-end justify-between mt-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Potencial Extra"}),(0,r.jsxs)("p",{className:"text-xl font-bold text-gray-900",children:["+ R$ ",e.potential_revenue.toLocaleString("pt-BR")]})]}),(0,r.jsxs)("button",{onClick:()=>w(e),className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-medium text-sm transition-colors flex items-center gap-2",children:["Ofertar Agora",(0,r.jsx)(h.Z,{className:"w-4 h-4"})]})]})]},"".concat(e.client_email,"-").concat(e.service_id)))})]})})]})]})}}},function(e){e.O(0,[2882,4609,2724,4438,5452,2971,2117,1744],function(){return e(e.s=23949)}),_N_E=e.O()}]);